import{r as b,j as e,a as j,$ as U}from"./app-CGCcTJnQ.js";import{E as q}from"./ErpLayout-Dd3SuRvB.js";import{S as A}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{w as P}from"./sweetalert2-react-content.es-B4eG8y5j.js";import{u as X,c as D,f as L,g as H,d as S,h as z}from"./index.esm-DQ4HJBQI.js";import{M as f}from"./Modal-BLOzEIBk.js";import{F as a,C as l}from"./Form-CztmhhS9.js";import{R as C,I as n}from"./Footer-CRm-FYLZ.js";import{I as Y,B as w,C as K}from"./Image-C1oIC0_0.js";import{S as W}from"./Spinner-BBA3nWv-.js";import{B as Q}from"./ButtonGroup-CGPVR6rS.js";import{C as E}from"./Card-BYpRWYjG.js";import{T as Z}from"./Table-DdKforGC.js";/* empty css                      */import"./hoist-non-react-statics.cjs-C-Qo8PK8.js";import"./CloseButton-DfHhhRN2.js";const ee=D().shape({title:S().max(255,"Title must not exceed 255 characters"),subtitle:S().max(255,"Subtitle must not exceed 255 characters"),image:H().required("Desktop image is required"),start_at:L().nullable(),end_at:L().nullable().min(z("start_at"),"End date must be after start date")});function te({showModal:u,setShowModal:g,formData:r,handleInputChange:k,handleFileChange:h,handleSubmit:B,isSubmitting:s,sliderId:y}){const t=X({initialValues:{id:"",slider_id:y,title:"",subtitle:"",description:"",image:null,mobile_image:null,video_url:"",button_text:"",button_url:"",secondary_button_text:"",secondary_button_url:"",order:0,is_active:!0,content_position:JSON.stringify({x:"center",y:"center"},null,2),text_color:"#ffffff",overlay_color:"#000000",overlay_opacity:30,start_at:"",end_at:"",custom_fields:null},validationSchema:ee,enableReinitialize:!0,onSubmit:d=>{const T={...d,content_position:JSON.parse(d.content_position),custom_fields:d.custom_fields?JSON.parse(d.custom_fields):null};B(T)}});return b.useEffect(()=>{r&&t.setValues({...r,content_position:r.content_position?JSON.stringify(r.content_position,null,2):JSON.stringify({x:"center",y:"center"},null,2),custom_fields:r.custom_fields?JSON.stringify(r.custom_fields,null,2):null,is_active:r.is_active!==void 0?r.is_active:!0})},[r]),e.jsx(f,{centered:!0,show:u,onHide:()=>{s||(g(!1),t.resetForm())},backdrop:s?"static":!0,keyboard:!s,size:"lg",children:e.jsxs(a,{onSubmit:t.handleSubmit,noValidate:!0,children:[e.jsx(f.Header,{closeButton:!s,children:e.jsx(f.Title,{children:r.id?"Edit Slide Item":"Create Slide Item"})}),e.jsxs(f.Body,{children:[e.jsxs(C,{className:"g-3 mb-3",children:[e.jsx(l,{md:12,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Title"}),e.jsxs(n,{children:[e.jsx(n.Text,{children:e.jsx("i",{className:"bi bi-text-paragraph"})}),e.jsx(a.Control,{type:"text",name:"title",value:t.values.title,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.title&&!!t.errors.title,disabled:s}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.title})]})]})}),e.jsx(l,{md:12,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Subtitle"}),e.jsxs(n,{children:[e.jsx(n.Text,{children:e.jsx("i",{className:"bi bi-text-center"})}),e.jsx(a.Control,{type:"text",name:"subtitle",value:t.values.subtitle,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.subtitle&&!!t.errors.subtitle,disabled:s}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.subtitle})]})]})}),e.jsx(l,{md:12,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Description"}),e.jsx(a.Control,{as:"textarea",rows:3,name:"description",value:t.values.description,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.description&&!!t.errors.description,disabled:s}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.description})]})}),e.jsx(l,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsxs(a.Label,{children:["Desktop Image ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(a.Control,{type:"file",name:"image",accept:"image/*",onChange:d=>{t.setFieldValue("image",d.target.files[0]),h(d,"image")},onBlur:t.handleBlur,isInvalid:t.touched.image&&!!t.errors.image,disabled:s}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.image}),t.values.image&&typeof t.values.image=="string"&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:t.values.image,alt:"Current Image",className:"img-thumbnail",width:100})})]})}),e.jsx(l,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Mobile Image"}),e.jsx(a.Control,{type:"file",name:"mobile_image",accept:"image/*",onChange:d=>{t.setFieldValue("mobile_image",d.target.files[0]),h(d,"mobile_image")},onBlur:t.handleBlur,isInvalid:t.touched.mobile_image&&!!t.errors.mobile_image,disabled:s}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.mobile_image}),(t.values.mobile_image||(r==null?void 0:r.mobile_image_url))&&e.jsx("div",{className:"mt-2",children:e.jsx(Y,{src:typeof t.values.mobile_image=="string"?t.values.mobile_image:t.values.mobile_image?URL.createObjectURL(t.values.mobile_image):r==null?void 0:r.mobile_image_url,alt:"Mobile Preview",thumbnail:!0,style:{maxHeight:"150px"}})})]})}),e.jsx(l,{md:12,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Video URL"}),e.jsxs(n,{children:[e.jsx(n.Text,{children:e.jsx("i",{className:"bi bi-play-btn"})}),e.jsx(a.Control,{type:"url",name:"video_url",value:t.values.video_url,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.video_url&&!!t.errors.video_url,disabled:s,placeholder:"https://example.com/video.mp4"}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.video_url})]})]})})]}),e.jsxs(C,{className:"g-3 mb-3",children:[e.jsx(l,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Primary Button Text"}),e.jsxs(n,{children:[e.jsx(n.Text,{children:e.jsx("i",{className:"bi bi-button-play"})}),e.jsx(a.Control,{type:"text",name:"button_text",value:t.values.button_text,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.button_text&&!!t.errors.button_text,disabled:s}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.button_text})]})]})}),e.jsx(l,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Primary Button URL"}),e.jsxs(n,{children:[e.jsx(n.Text,{children:e.jsx("i",{className:"bi bi-link-45deg"})}),e.jsx(a.Control,{type:"url",name:"button_url",value:t.values.button_url,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.button_url&&!!t.errors.button_url,disabled:s,placeholder:"https://example.com"}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.button_url})]})]})}),e.jsx(l,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Secondary Button Text"}),e.jsxs(n,{children:[e.jsx(n.Text,{children:e.jsx("i",{className:"bi bi-button-play"})}),e.jsx(a.Control,{type:"text",name:"secondary_button_text",value:t.values.secondary_button_text,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.secondary_button_text&&!!t.errors.secondary_button_text,disabled:s}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.secondary_button_text})]})]})}),e.jsx(l,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Secondary Button URL"}),e.jsxs(n,{children:[e.jsx(n.Text,{children:e.jsx("i",{className:"bi bi-link-45deg"})}),e.jsx(a.Control,{type:"url",name:"secondary_button_url",value:t.values.secondary_button_url,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.secondary_button_url&&!!t.errors.secondary_button_url,disabled:s,placeholder:"https://example.com"}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.secondary_button_url})]})]})})]}),e.jsxs(C,{className:"g-3 mb-3",children:[e.jsx(l,{md:4,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Order"}),e.jsxs(n,{children:[e.jsx(n.Text,{children:e.jsx("i",{className:"bi bi-sort-numeric-down"})}),e.jsx(a.Control,{type:"number",name:"order",min:"0",value:t.values.order,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.order&&!!t.errors.order,disabled:s}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.order})]})]})}),e.jsx(l,{md:4,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Text Color"}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx(a.Control,{type:"color",name:"text_color",value:t.values.text_color,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.text_color&&!!t.errors.text_color,style:{width:"60px",height:"38px",padding:"3px"},disabled:s}),e.jsx(a.Control,{type:"text",name:"text_color",value:t.values.text_color,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.text_color&&!!t.errors.text_color,disabled:s})]}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.text_color})]})}),e.jsx(l,{md:4,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Overlay Opacity"}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx(a.Range,{name:"overlay_opacity",min:"0",max:"100",value:t.values.overlay_opacity,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.overlay_opacity&&!!t.errors.overlay_opacity,disabled:s}),e.jsxs("span",{className:"text-muted",children:[t.values.overlay_opacity,"%"]})]}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.overlay_opacity})]})}),e.jsx(l,{md:12,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Content Position (JSON)"}),e.jsx(a.Control,{as:"textarea",rows:2,name:"content_position",value:t.values.content_position,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.content_position&&!!t.errors.content_position,placeholder:'{"x": "center", "y": "center"}'}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.content_position})]})}),e.jsx(l,{md:12,children:e.jsx(a.Group,{className:"mb-3",children:e.jsx(a.Check,{type:"switch",id:"is_active",name:"is_active",label:"Active",checked:t.values.is_active,onChange:t.handleChange,disabled:s})})})]}),e.jsxs(C,{className:"g-3",children:[e.jsx(l,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Start Date/Time"}),e.jsx(a.Control,{type:"datetime-local",name:"start_at",value:t.values.start_at,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.start_at&&!!t.errors.start_at,disabled:s}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.start_at})]})}),e.jsx(l,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"End Date/Time"}),e.jsx(a.Control,{type:"datetime-local",name:"end_at",value:t.values.end_at,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.end_at&&!!t.errors.end_at,min:t.values.start_at,disabled:s}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.end_at})]})}),e.jsx(l,{md:12,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Custom Fields (JSON)"}),e.jsx(a.Control,{as:"textarea",rows:3,name:"custom_fields",value:t.values.custom_fields||"",onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.custom_fields&&!!t.errors.custom_fields,placeholder:"Any additional custom data in JSON format"}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.custom_fields})]})})]})]}),e.jsxs(f.Footer,{children:[e.jsx(w,{variant:"outline-danger",onClick:()=>{g(!1),t.resetForm()},disabled:s,children:"Cancel"}),e.jsx(w,{variant:"outline-light",type:"submit",disabled:s||!t.isValid,children:s?e.jsxs(e.Fragment,{children:[e.jsx(W,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),e.jsx("span",{className:"ms-2",children:r.id?"Updating...":"Creating..."})]}):r.id?"Update":"Create"})]})]})})}j.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";j.defaults.withCredentials=!0;j.defaults.xsrfCookieName="XSRF-TOKEN";j.defaults.xsrfHeaderName="X-XSRF-TOKEN";const c=P(A),G=()=>({id:"",slider_id:"",title:"",subtitle:"",description:"",link:"",link_text:"",image:null,is_active:!1,order:0});function _e({slider:u}){const[g,r]=b.useState(!1),[k,h]=b.useState(G()),[B,s]=b.useState(!1),y=b.useCallback(()=>{$.fn.DataTable.isDataTable("#sliderItemsTable")&&$("#sliderItemsTable").DataTable().ajax.reload(null,!1)},[]),t=b.useCallback(()=>{$.fn.DataTable.isDataTable("#sliderItemsTable")&&$("#sliderItemsTable").DataTable().destroy(),$("#sliderItemsTable").DataTable({processing:!0,serverSide:!0,ajax:{url:route("slider-item.index",{slider:u.id}),type:"GET",headers:{"X-Requested-With":"XMLHttpRequest"}},columns:[{data:"DT_RowIndex",name:"DT_RowIndex",title:"#",orderable:!1,searchable:!1,width:"5%"},{data:"image_preview",name:"image_preview",title:"Image"},{data:"title",name:"title",title:"Title"},{data:"subtitle",name:"subtitle",title:"Sub Title"},{data:"description",name:"description",title:"Description"},{data:"status_badge",name:"status_badge",title:"Status"},{data:"order",name:"order",title:"Order"},{data:"action",name:"action",title:"Actions",className:"text-end",orderable:!1,searchable:!1,width:"5%"}],drawCallback:()=>{$(".view-item-btn").off("click").on("click",function(){window.location.href=route("slider-item.show",$(this).data("id"))}),$(".edit-item-btn").off("click").on("click",function(){const o=$(this).data("id");R(o)}),$(".delete-item-btn").off("click").on("click",function(){const o=$(this).data("id");M(o)})}})},[u.id]),d=o=>{const{name:i,value:v,type:x,checked:p}=o.target;h(N=>({...N,[i]:x==="checkbox"?p:v}))},T=o=>{h(i=>({...i,image:o.target.files[0]}))},O=()=>{h({...G(),slider_id:u.id}),r(!0)},R=async o=>{try{const i=await j.get(route("slider-item.edit",o));h({...i.data,is_active:!!i.data.is_active,slider_id:u.id}),r(!0)}catch(i){console.error("Error:",i),c.fire("Error","Failed to load slider item data.","error")}},M=async o=>{var v;if((await c.fire({title:"Delete Slider Item?",text:"This cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{(await j.delete(route("slider-item.destroy",o))).data.success?(y(),c.fire("Deleted!","Slider item has been deleted.","success")):c.fire("Error!","Error deleting slider item!","error")}catch(x){let p="Delete failed.";((v=x.response)==null?void 0:v.status)===403&&(p="You don't have permission to delete this item."),c.fire("Error!",p,"error")}},J=async o=>{var x,p,N,F;const i=!!o.id;if((await c.fire({title:i?"Update slider item?":"Create slider item?",text:i?"Are you sure you want to update this slider item?":"Are you sure you want to create a new slider item?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:i?"Yes, update it!":"Yes, create it!"})).isConfirmed){s(!0),c.fire({icon:"info",title:"Processing...",text:"Please wait...",allowOutsideClick:!1,showConfirmButton:!1,didOpen:()=>c.showLoading()});try{const m=new FormData;Object.entries(o).forEach(([V,I])=>{I!=null&&m.append(V,I)}),i&&m.append("_method","put");const _=i?route("slider-item.update",o.id):route("slider-item.store");await j.post(_,m,{headers:{"Content-Type":"multipart/form-data"}}),r(!1),y(),c.fire("Success",`Slider item ${i?"updated":"created"} successfully.`,"success")}catch(m){console.error("Error saving slider item",m);let _="Failed to save slider item.";(p=(x=m.response)==null?void 0:x.data)!=null&&p.message?_=m.response.data.message:((N=m.response)==null?void 0:N.status)===422?_="Validation error. Please check your input.":((F=m.response)==null?void 0:F.status)===403&&(_="You don't have permission to perform this action."),c.fire("Error",_,"error")}finally{s(!1)}}};return b.useEffect(()=>(t(),()=>{$.fn.DataTable.isDataTable("#sliderItemsTable")&&$("#sliderItemsTable").DataTable().destroy()}),[t]),e.jsxs(q,{children:[e.jsx(U,{title:`${u.name} - Slides`}),e.jsxs(K,{children:[e.jsxs(C,{className:"g-3",children:[e.jsxs(l,{md:12,className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h2",{className:"mb-0 text-capitalize",children:[u.name," Slides"]}),e.jsx(Q,{className:"gap-2",children:e.jsxs(w,{variant:"outline-primary",className:"rounded",onClick:O,children:[e.jsx("i",{className:"bi bi-plus-circle"})," ","Add Slide Item"]})})]}),e.jsx(l,{md:12,children:e.jsx("hr",{className:"dashed-hr"})}),e.jsx(l,{md:12,children:e.jsx(E,{children:e.jsx(E.Body,{children:e.jsx(Z,{bordered:!0,striped:!0,hover:!0,responsive:!0,id:"sliderItemsTable",className:"w-100"})})})})]}),e.jsx(te,{showModal:g,setShowModal:r,formData:k,handleInputChange:d,handleFileChange:T,handleSubmit:J,isSubmitting:B,sliderId:u.id})]})]})}export{_e as default};
