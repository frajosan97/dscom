import{r as l,j as e,$ as I,Y as A}from"./app-CxIzz1Hm.js";import{B as U,a as M,b as _,c as b,d as z,e as L}from"./index-CMQojAPB.js";import{S as Y}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{y as f,R as w,I as i,D as o}from"./Footer-1rOk33u-.js";import{E as G}from"./ErpLayout-CKY1G0eu.js";import{x as V}from"./axios-CbP2VCmx.js";import{F as O,a as W,b as Z}from"./index-DEpCKpyh.js";import{C as q,B as C}from"./Image-B2kFzfRD.js";import{C as c,F as h}from"./Form-C32FoLO3.js";import{B as T}from"./ButtonGroup-BeeULg22.js";import{C as N}from"./Card-BGz8PFHq.js";import{T as H}from"./Table-EbxAEte5.js";import"./iconBase-8l29Fq_8.js";import"./CloseButton-DTBn4gN-.js";/* empty css                      */function ue(){const[x,y]=l.useState(""),[d,B]=l.useState("all"),[u,S]=l.useState("all"),[m,F]=l.useState("all"),p=l.useRef(!1),n=l.useRef(null),j=l.useCallback(()=>{if(p.current)return;$.fn.DataTable.isDataTable("#customerTable")&&$("#customerTable").DataTable().destroy();const r=$("#customerTable").DataTable({processing:!0,serverSide:!0,ajax:{url:route("customers.index"),type:"GET",data:function(t){t.search=x,t.status=d!=="all"?d:"",t.type=u!=="all"?u:"",t.balance=m!=="all"?m:""}},columns:[{data:"DT_RowIndex",title:"#",className:"text-center",width:"3%",orderable:!1,searchable:!1},{data:"name",title:"Name",className:"text-start fw-semibold"},{data:"email",title:"Email",className:"text-start"},{data:"phone",title:"Phone",className:"text-start"},{data:"role",title:"Type",className:"text-center",width:"10%",render:function(t){let s="bg-primary",a="Regular";return t==="wholesale"?(s="bg-info",a="Wholesale"):t==="corporate"?(s="bg-success",a="Corporate"):t==="vip"&&(s="bg-warning text-dark",a="VIP"),`<span class="badge ${s}">${a}</span>`}},{data:"status",title:"Status",className:"text-center",width:"8%",render:t=>{let s="bg-success",a="Active";return t==="inactive"?(s="bg-secondary",a="Inactive"):t==="pending"?(s="bg-warning text-dark",a="Pending"):t==="blocked"&&(s="bg-danger",a="Blocked"),`<span class="badge ${s}">${a}</span>`}},{data:"balance",title:"Balance",className:"text-end",width:"10%",render:function(t){const s=parseFloat(t)||0,a=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(s));return s<0?`<span class="text-danger fw-bold">-${a}</span>`:s>0?`<span class="text-success fw-bold">${a}</span>`:`<span class="text-muted">${a}</span>`}},{data:"id",title:"Actions",className:"text-center",width:"12%",orderable:!1,searchable:!1,render:function(t,s,a){return`
                            <div class="btn-group" role="group">
                                <button type="button" class="btn btn-sm btn-outline-info view-btn" data-id="${t}">
                                    <i class="bi bi-eye"></i>
                                </button>
                                <button type="button" class="btn btn-sm btn-outline-primary edit-btn" data-id="${t}">
                                    <i class="bi bi-pencil"></i>
                                </button>
                                <button type="button" class="btn btn-sm btn-outline-danger delete-btn" data-id="${t}">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        `}}],drawCallback:function(){$(".edit-btn").off("click").on("click",function(){const t=$(this).data("id");D(t)}),$(".view-btn").off("click").on("click",function(){const t=$(this).data("id");E(t)}),$(".delete-btn").off("click").on("click",function(){const t=$(this).data("id");P(t)})},initComplete:function(){p.current=!0},language:{emptyTable:'<div class="text-center py-5"><i class="bi bi-people display-4 text-muted"></i><p class="mt-2">No customers found</p></div>',zeroRecords:'<div class="text-center py-5"><i class="bi bi-search display-4 text-muted"></i><p class="mt-2">No matching customers found</p></div>'},responsive:!0,order:[[1,"asc"]],pageLength:10,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]]});return n.current=r,r},[x,d,u,m]);l.useEffect(()=>{p.current&&n.current&&n.current.ajax.reload()},[x,d,u,m]),l.useEffect(()=>(j(),()=>{$.fn.DataTable.isDataTable("#customerTable")&&($("#customerTable").DataTable().destroy(),p.current=!1)}),[j]);const D=r=>{window.location.href=route("customers.edit",r)},E=r=>{window.location.href=route("customers.show",r)},P=async r=>{var t,s;try{if(!(await Y.fire({title:"Are you sure?",text:"You won't be able to revert this! This will permanently delete the customer and their associated data.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",reverseButtons:!0})).isConfirmed)return;const v=await V.delete(route("customers.destroy",r));v.data.success&&(f.success(v.data.message),n.current&&n.current.ajax.reload())}catch(a){f.error(((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.message)||"An error occurred while deleting the customer")}},g=r=>{if(n.current){const t=n.current.ajax.params(),s=new URL(route("customers.export"));Object.keys(t).forEach(a=>{a!=="draw"&&a!=="_"&&a!=="start"&&a!=="length"&&s.searchParams.append(a,t[a])}),s.searchParams.append("type",r),window.open(s.toString(),"_blank")}},R=()=>{if(n.current){const r=n.current.ajax.params(),t=new URL(route("customers.print"));Object.keys(r).forEach(s=>{s!=="draw"&&s!=="_"&&s!=="start"&&s!=="length"&&t.searchParams.append(s,r[s])}),window.open(t.toString(),"_blank")}},k=()=>{n.current&&(n.current.ajax.reload(),f.success("Customer list refreshed!"))};return e.jsxs(G,{children:[e.jsx(I,{title:"Customer Management"}),e.jsxs(q,{fluid:!0,children:[e.jsxs(w,{className:"mb-4 align-items-center",children:[e.jsxs(c,{md:6,children:[e.jsxs("h3",{className:"fw-bold text-primary mb-2",children:[e.jsx(U,{className:"me-2"}),"Customer Management"]}),e.jsx("p",{className:"text-muted mb-0",children:"View, manage, and maintain all customer accounts."})]}),e.jsx(c,{md:6,className:"text-md-end",children:e.jsx(T,{className:"mb-2 mb-md-0",children:e.jsxs(C,{variant:"outline-primary",as:A,href:route("customers.create"),className:"d-flex align-items-center",children:[e.jsx(M,{className:"me-1"}),"Add Customer"]})})})]}),e.jsxs(w,{className:"mb-4",children:[e.jsx(c,{md:6,lg:3,children:e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx(_,{})}),e.jsx(h.Control,{type:"text",placeholder:"Search customers...",value:x,onChange:r=>y(r.target.value)})]})}),e.jsx(c,{md:6,lg:2,children:e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx(b,{})}),e.jsxs(h.Select,{value:d,onChange:r=>B(r.target.value),children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"blocked",children:"Blocked"})]})]})}),e.jsx(c,{md:6,lg:2,children:e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx(b,{})}),e.jsxs(h.Select,{value:u,onChange:r=>S(r.target.value),children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"regular",children:"Regular"}),e.jsx("option",{value:"wholesale",children:"Wholesale"}),e.jsx("option",{value:"corporate",children:"Corporate"}),e.jsx("option",{value:"vip",children:"VIP"})]})]})}),e.jsx(c,{md:6,lg:2,children:e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx(b,{})}),e.jsxs(h.Select,{value:m,onChange:r=>F(r.target.value),children:[e.jsx("option",{value:"all",children:"All Balances"}),e.jsx("option",{value:"positive",children:"Credit (+)"}),e.jsx("option",{value:"negative",children:"Debit (-)"}),e.jsx("option",{value:"zero",children:"Zero Balance"})]})]})}),e.jsx(c,{md:12,lg:3,className:"text-lg-end mt-2 mt-lg-0",children:e.jsxs(T,{className:"d-flex gap-2",children:[e.jsxs(C,{variant:"outline-info",onClick:k,className:"d-flex align-items-center rounded",children:[e.jsx(z,{className:"me-1"}),"Refresh"]}),e.jsxs(o,{children:[e.jsxs(o.Toggle,{variant:"outline-secondary",className:"d-flex align-items-center",children:[e.jsx(L,{className:"me-1"}),"Export"]}),e.jsxs(o.Menu,{children:[e.jsxs(o.Item,{onClick:()=>g("excel"),children:[e.jsx(O,{className:"me-2 text-success"})," ","Excel"]}),e.jsxs(o.Item,{onClick:()=>g("pdf"),children:[e.jsx(W,{className:"me-2 text-danger"})," ","PDF"]}),e.jsxs(o.Item,{onClick:R,children:[e.jsx(Z,{className:"me-2 text-secondary"})," ","Print"]})]})]})]})})]}),e.jsx(N,{children:e.jsx(N.Body,{className:"p-0",children:e.jsx("div",{className:"table-responsive",children:e.jsx(H,{bordered:!0,hover:!0,responsive:!0,id:"customerTable",className:"align-middle mb-0"})})})})]})]})}export{ue as default};
