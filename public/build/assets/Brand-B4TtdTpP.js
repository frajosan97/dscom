import{j as e,r as d,$ as F}from"./app-V9r-X-AE.js";import{R as y,I as i,y as j}from"./Footer-DzCvt54Q.js";import{F as R}from"./index-OP9lOklB.js";import{E as M}from"./ErpLayout-nhBgb16w.js";import{S as k}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{x as N}from"./axios-ieEUQTu7.js";import{c as D,f as G,e as I,b as o,u as E}from"./index.esm-DxGMX1Iw.js";import{u as U}from"./useErrorToast-BDwh9umO.js";import{M as p}from"./Modal-qrCrV0uy.js";import{F as a,C as m}from"./Form-BBQmeiIu.js";import{I as z,B as f}from"./Image-Dv6K2MWK.js";import{S as q}from"./Spinner-B1mIUH-A.js";import{C as S}from"./Card-DEhYGpAN.js";import{B as O}from"./ButtonGroup-DhA5YJ4Y.js";import{T as P}from"./Table-DzA7Bq8n.js";import"./CloseButton-CxHVE5YY.js";import"./iconBase-DG-LLbDw.js";/* empty css                      */import"./hoist-non-react-statics.cjs-C-Qo8PK8.js";function A({show:_,onSuccess:c,onHide:h,brand:s}){const{showErrorToast:b}=U(),n=!!s,C=D().shape({name:o().required("Brand name is required").max(255,"Brand name must not exceed 255 characters"),description:o().nullable(),meta_title:o().nullable(),meta_description:o().nullable(),website_url:o().url("Must be a valid URL").nullable(),facebook_url:o().url("Must be a valid URL").nullable(),instagram_url:o().url("Must be a valid URL").nullable(),twitter_url:o().url("Must be a valid URL").nullable(),is_active:I(),is_featured:I(),order:G().integer("Must be an integer")}),t=E({enableReinitialize:!0,initialValues:{name:(s==null?void 0:s.name)||"",description:(s==null?void 0:s.description)||"",meta_title:(s==null?void 0:s.meta_title)||"",meta_description:(s==null?void 0:s.meta_description)||"",logo:null,website_url:(s==null?void 0:s.website_url)||"",facebook_url:(s==null?void 0:s.facebook_url)||"",instagram_url:(s==null?void 0:s.instagram_url)||"",twitter_url:(s==null?void 0:s.twitter_url)||"",is_active:(s==null?void 0:s.is_active)??!0,is_featured:(s==null?void 0:s.is_featured)??!1,order:(s==null?void 0:s.order)||0,_method:n?"PUT":"POST"},validationSchema:C,onSubmit:async(r,{setSubmitting:x,setErrors:u})=>{try{const l=new FormData;Object.entries(r).forEach(([L,w])=>{w!=null&&l.append(L,w)});const g=n?route("brand.update",s.id):route("brand.store"),T=await N.post(g,l,{headers:{"Content-Type":"multipart/form-data"}});T.data.success===!0&&(j.success(T.data.message),c(),h())}catch(l){b(l)}finally{x(!1)}}}),v=r=>{t.setFieldValue("logo",r.target.files[0])},B=()=>{t.setFieldValue("logo",null)};return e.jsxs(p,{show:_,onHide:h,size:"lg",centered:!0,backdrop:"static",children:[e.jsx(p.Header,{closeButton:!0,children:e.jsx(p.Title,{children:n?"Edit Brand":"Create New Brand"})}),e.jsxs(a,{onSubmit:t.handleSubmit,children:[e.jsx(p.Body,{children:e.jsxs(y,{children:[e.jsxs(m,{md:8,children:[e.jsxs(a.Group,{className:"mb-3",controlId:"name",children:[e.jsxs(a.Label,{children:["Brand Name"," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx("i",{className:"bi bi-tag"})}),e.jsx(a.Control,{type:"text",name:"name",value:t.values.name,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.name&&!!t.errors.name,disabled:t.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.name})]})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"description",children:[e.jsx(a.Label,{children:"Description"}),e.jsx(a.Control,{as:"textarea",rows:3,name:"description",value:t.values.description,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.description&&!!t.errors.description,disabled:t.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.description})]}),e.jsxs(y,{children:[e.jsx(m,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"website_url",children:[e.jsx(a.Label,{children:"Website URL"}),e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx("i",{className:"bi bi-globe"})}),e.jsx(a.Control,{type:"url",name:"website_url",value:t.values.website_url,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.website_url&&!!t.errors.website_url,disabled:t.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.website_url})]})]})}),e.jsx(m,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"order",children:[e.jsx(a.Label,{children:"Order"}),e.jsx(a.Control,{type:"number",name:"order",value:t.values.order,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.order&&!!t.errors.order,disabled:t.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.order})]})})]}),e.jsxs(y,{children:[e.jsx(m,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"facebook_url",children:[e.jsx(a.Label,{children:"Facebook URL"}),e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx("i",{className:"bi bi-facebook"})}),e.jsx(a.Control,{type:"url",name:"facebook_url",value:t.values.facebook_url,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.facebook_url&&!!t.errors.facebook_url,disabled:t.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.facebook_url})]})]})}),e.jsx(m,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"instagram_url",children:[e.jsx(a.Label,{children:"Instagram URL"}),e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx("i",{className:"bi bi-instagram"})}),e.jsx(a.Control,{type:"url",name:"instagram_url",value:t.values.instagram_url,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.instagram_url&&!!t.errors.instagram_url,disabled:t.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.instagram_url})]})]})})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"twitter_url",children:[e.jsx(a.Label,{children:"Twitter URL"}),e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx("i",{className:"bi bi-twitter"})}),e.jsx(a.Control,{type:"url",name:"twitter_url",value:t.values.twitter_url,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.twitter_url&&!!t.errors.twitter_url,disabled:t.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.twitter_url})]})]})]}),e.jsxs(m,{md:4,children:[e.jsxs(a.Group,{className:"mb-3",controlId:"logo",children:[e.jsx(a.Label,{children:"Brand Logo"}),e.jsx(a.Control,{type:"file",accept:"image/*",onChange:v,disabled:t.isSubmitting}),(t.values.logo||(s==null?void 0:s.logo_url))&&e.jsxs("div",{className:"mt-3 text-center",children:[e.jsx(z,{src:typeof t.values.logo=="string"?t.values.logo:t.values.logo?URL.createObjectURL(t.values.logo):s==null?void 0:s.logo_url,alt:"Logo Preview",fluid:!0,thumbnail:!0,style:{maxHeight:"150px"}}),e.jsx(f,{variant:"link",size:"sm",className:"text-danger mt-2",onClick:B,disabled:t.isSubmitting,children:"Remove Logo"})]})]}),e.jsx(a.Group,{className:"mb-3",controlId:"is_active",children:e.jsx(a.Check,{type:"switch",id:"is_active",name:"is_active",label:"Active",checked:t.values.is_active,onChange:t.handleChange,disabled:t.isSubmitting})}),e.jsx(a.Group,{className:"mb-3",controlId:"is_featured",children:e.jsx(a.Check,{type:"switch",id:"is_featured",name:"is_featured",label:"Featured",checked:t.values.is_featured,onChange:t.handleChange,disabled:t.isSubmitting})}),e.jsxs(a.Group,{className:"mb-3",controlId:"meta_title",children:[e.jsx(a.Label,{children:"Meta Title"}),e.jsx(a.Control,{type:"text",name:"meta_title",value:t.values.meta_title,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.meta_title&&!!t.errors.meta_title,disabled:t.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.meta_title})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"meta_description",children:[e.jsx(a.Label,{children:"Meta Description"}),e.jsx(a.Control,{as:"textarea",rows:3,name:"meta_description",value:t.values.meta_description,onChange:t.handleChange,onBlur:t.handleBlur,isInvalid:t.touched.meta_description&&!!t.errors.meta_description,disabled:t.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:t.errors.meta_description})]})]})]})}),e.jsxs(p.Footer,{children:[e.jsx(f,{variant:"secondary",onClick:h,disabled:t.isSubmitting,children:"Cancel"}),e.jsx(f,{variant:"primary",type:"submit",disabled:t.isSubmitting,children:t.isSubmitting?e.jsxs(e.Fragment,{children:[e.jsx(q,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),n?"Updating...":"Creating..."]}):`${n?"Update":"Create"} Brand`})]})]})]})}function ce(){const[_,c]=d.useState(!1),[h,s]=d.useState(null),b=d.useCallback(()=>{$.fn.DataTable.isDataTable("#brandsTable")&&$("#brandsTable").DataTable().destroy(),$("#brandsTable").DataTable({processing:!0,serverSide:!0,ajax:{url:route("brand.index"),type:"GET",headers:{"X-Requested-With":"XMLHttpRequest"}},columns:[{data:"logo",name:"logo",title:"Logo"},{data:"name",name:"name",title:"Brand Name"},{data:"slug",name:"slug",title:"Slug"},{data:"status_badge",name:"status_badge",title:"Status"},{data:"featured_badge",name:"featured_badge",title:"Featured"},{data:"action",name:"action",title:"Actions",orderable:!1,searchable:!1,width:"10%"}],order:[[0,"desc"]],drawCallback:()=>{$(".edit-btn").off("click").on("click",function(){const r=$(this).data("id");v(r)}),$(".delete-btn").off("click").on("click",function(){const r=$(this).data("id");B(r)})}})},[]);d.useEffect(()=>{b()},[b]);const n=d.useCallback(()=>{s(null),c(!0)},[]),C=d.useCallback(()=>{c(!1),s(null)},[]),t=d.useCallback(r=>{j.success(r),$("#brandsTable").DataTable().ajax.reload(null,!1),c(!1)},[]),v=async r=>{var x,u;try{const l=await N.get(route("brand.edit",r));l.data.success===!0?(s(l.data.brand),c(!0)):j.error(l.data.message)}catch(l){j.error(((u=(x=l.response)==null?void 0:x.data)==null?void 0:u.message)||"An error occurred")}},B=async r=>{var u;if((await k.fire({title:"Delete Brand?",text:"This cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await N.delete(route("brand.destroy",r)),$("#brandsTable").DataTable().ajax.reload(null,!1),k.fire("Deleted!","Brand has been deleted.","success")}catch(l){let g="Delete failed.";((u=l.response)==null?void 0:u.status)===403&&(g="You don't have permission to delete this brand."),k.fire("Error!",g,"error")}};return e.jsxs(M,{children:[e.jsx(F,{title:"Brands"}),e.jsxs(S,{className:"border-0 rounded-0 shadow-sm",children:[e.jsxs(S.Header,{className:"d-flex justify-content-between align-items-center bg-transparent",children:[e.jsx("h6",{className:"mb-0 fw-semibold",children:"Brands Management"}),e.jsx(O,{children:e.jsxs(f,{variant:"outline-secondary",size:"sm",className:"rounded-1 d-flex align-items-center",onClick:n,children:[e.jsx(R,{className:"me-1"}),"New Brand"]})})]}),e.jsx(S.Body,{className:"px-0",children:e.jsx(P,{bordered:!0,striped:!0,hover:!0,responsive:!0,id:"brandsTable",className:"w-100"})})]}),e.jsx(A,{show:_,onHide:C,brand:h,onSuccess:t})]})}export{ce as default};
