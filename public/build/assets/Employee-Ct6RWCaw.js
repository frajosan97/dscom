import{v as R,r as o,m as F,j as e,$ as _}from"./app-Dbf3h8vH.js";import{g as z,h as O,i as K}from"./index-DptpzwTr.js";import{E as V}from"./ErpLayout-3UAfEC8K.js";import{R as H,I as J,y as B}from"./Footer-BrnbheST.js";import{x as L}from"./axios-DNHxlns_.js";import{c as W,a as f}from"./index.esm-CV1EtPjf.js";import{u as Q}from"./useData-CwLsMuws.js";import{F as a,C as n}from"./Form-CoztAQ2q.js";import{C as T}from"./Card-BRq3Nmlv.js";import{B as Z}from"./ButtonGroup-DDvgUvx3.js";import{B as A}from"./Image-D1nToII8.js";import{T as X}from"./Table-CjjJdV2-.js";import{T as Y}from"./Tabs-pF0ViaOw.js";import{T as S}from"./Tab-CpCcWqUn.js";import"./iconBase-CYuej6dD.js";/* empty css                      */import"./CloseButton-Do14r1LH.js";const ee=W().shape({name:f().required("Name is required").min(2,"Name must be at least 2 characters"),email:f().email("Invalid email format").nullable(),phone:f().required("Phone number is required").matches(/^[0-9+\-\s()]{10,}$/,"Invalid phone number format"),qualification:f().nullable(),designation:f().nullable(),role:f().required("Role is required"),address:f().nullable(),description:f().nullable(),status:f().oneOf(["Enable","Disable"],"Invalid status")});function q({employee:s=null,onSuccess:h}){const{roles:g}=Q(),{data:l,setData:v,errors:w}=R({name:(s==null?void 0:s.name)||"",email:(s==null?void 0:s.email)||"",phone:(s==null?void 0:s.phone)||"",username:(s==null?void 0:s.username)||"",password:"",consfirm_password:"",gender:(s==null?void 0:s.gender)||"Male",age:(s==null?void 0:s.age)||"",qualification:(s==null?void 0:s.qualification)||"",designation:(s==null?void 0:s.designation)||"",salaryType:(s==null?void 0:s.salaryType)||"",salary:(s==null?void 0:s.salary)||"",bloodGroup:(s==null?void 0:s.bloodGroup)||"",role:(s==null?void 0:s.role)||"",endingDate:(s==null?void 0:s.endingDate)||"16/08/2026",openingBalance:(s==null?void 0:s.openingBalance)||"0",address:(s==null?void 0:s.address)||"",description:(s==null?void 0:s.description)||"",status:(s==null?void 0:s.status)||"Enable",profileImage:null,idCard:null,document:null,_method:s?"PUT":"POST"}),[x,u]=o.useState(!1),[C,N]=o.useState({}),[y,P]=o.useState({}),r=o.useCallback(c=>{const{name:j}=c.target;P(b=>({...b,[j]:!0}))},[]),t=o.useCallback(c=>{const{name:j,value:b,type:E,files:p}=c.target;let I=b;["age","salary","openingBalance"].includes(j)&&(I=b===""?"":Number(b)),v(j,E==="file"?p[0]:I),C[j]&&N(D=>({...D,[j]:""}))},[v,C]),k=o.useCallback(async()=>{try{return await ee.validate(l,{abortEarly:!1}),N({}),!0}catch(c){const j={};return c.inner.forEach(b=>{j[b.path]=b.message}),N(j),!1}},[l]);o.useEffect(()=>{Object.keys(y).length>0&&k()},[l,y,k]);const M=async c=>{var b,E;if(c.preventDefault(),P(Object.keys(l).reduce((p,I)=>({...p,[I]:!0}),{})),!await k()){B.error("Please fix the validation errors");return}u(!0);try{const p=new FormData;Object.keys(l).forEach(G=>{l[G]!==null&&l[G]!==void 0&&p.append(G,l[G])});const I=s?route("employee.update",s.id):route("employee.store"),D=await L.post(I,p,{headers:{"Content-Type":"multipart/form-data"}});D.data.success&&(B.success(D.data.message),F.visit(route("employee.index")))}catch(p){B.error(((E=(b=p.response)==null?void 0:b.data)==null?void 0:E.message)||"An error occurred while creating the employee"),console.error("Employee creation error:",p)}finally{u(!1)}},U=o.useCallback(()=>{h?h():F.visit(route("employee.index"))},[h]),i={size:"sm",className:"rounded-0"},m=c=>C[c]||w[c],d=c=>y[c]&&!!m(c);return e.jsx(a,{id:"userForm",onSubmit:M,encType:"multipart/form-data",children:e.jsxs(T,{className:"border-0 rounded-0 shadow-sm",children:[e.jsxs(T.Header,{className:"d-flex justify-content-between align-items-center bg-transparent",children:[e.jsx("h6",{className:"mb-0 fw-semibold",children:s?"Update Employee":"New Employee"}),e.jsxs(Z,{className:"gap-2",children:[e.jsx(A,{variant:"outline-secondary",size:"sm",className:"rounded-0",onClick:U,disabled:x,children:"Cancel"}),e.jsx(A,{variant:"primary",size:"sm",className:"rounded-0",type:"submit",disabled:x,children:x?"Processing...":"Save"})]})]}),e.jsx(T.Body,{children:e.jsxs(H,{children:[e.jsx(n,{md:12,children:e.jsx("h6",{className:"mb-2 fw-semibold bg-light p-1 text-muted",children:"Personal Information"})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"name",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Name*"}),e.jsx(a.Control,{...i,type:"text",name:"name",value:l.name,onChange:t,onBlur:r,placeholder:"John Doe",required:!0,isInvalid:d("name")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:m("name")})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"email",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Email"}),e.jsx(a.Control,{...i,type:"email",name:"email",value:l.email,onChange:t,onBlur:r,placeholder:"john.doe@example.com",isInvalid:d("email")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:m("email")})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"phone",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Phone*"}),e.jsx(a.Control,{...i,type:"tel",name:"phone",value:l.phone,onChange:t,onBlur:r,placeholder:"+1-555-0123",required:!0,isInvalid:d("phone")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:m("phone")})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"username",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Username"}),e.jsx(a.Control,{...i,type:"text",name:"username",value:l.username,onChange:t,onBlur:r,placeholder:"johndoe123",isInvalid:d("username")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:m("username")})]})}),l.username&&e.jsxs(e.Fragment,{children:[e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"password",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Password"}),e.jsx(a.Control,{...i,type:"password",name:"password",value:l.password,onChange:t,onBlur:r,placeholder:"••••••",isInvalid:d("password")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:m("password")})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"consfirm_password",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Confirm Password"}),e.jsx(a.Control,{...i,type:"password",name:"consfirm_password",value:l.consfirm_password,onChange:t,onBlur:r,placeholder:"••••••",isInvalid:d("consfirm_password")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:m("consfirm_password")})]})})]}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"gender",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Gender"}),e.jsxs(a.Select,{...i,name:"gender",value:l.gender,onChange:t,onBlur:r,isInvalid:d("gender"),children:[e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"})]})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"age",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Age"}),e.jsx(a.Control,{...i,type:"number",name:"age",value:l.age,onChange:t,onBlur:r,placeholder:"30",min:"18",max:"70",isInvalid:d("age")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:m("age")})]})}),e.jsx(n,{md:12,className:"mt-3",children:e.jsx("h6",{className:"mb-2 fw-semibold bg-light p-1 text-muted",children:"Professional Information"})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"qualification",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Qualification"}),e.jsx(a.Control,{...i,type:"text",name:"qualification",value:l.qualification,onChange:t,onBlur:r,placeholder:"Bachelor's Degree"})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"designation",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Designation"}),e.jsx(a.Control,{...i,type:"text",name:"designation",value:l.designation,onChange:t,onBlur:r,placeholder:"Software Engineer"})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"salaryType",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Salary Type"}),e.jsxs(a.Select,{...i,name:"salaryType",value:l.salaryType,onChange:t,onBlur:r,isInvalid:d("salaryType"),children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"Monthly",children:"Monthly"}),e.jsx("option",{value:"Weekly",children:"Weekly"}),e.jsx("option",{value:"Daily",children:"Daily"})]})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"salary",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Salary"}),e.jsx(a.Control,{...i,type:"number",name:"salary",value:l.salary,onChange:t,onBlur:r,placeholder:"50000",step:"0.01",min:"0",isInvalid:d("salary")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:m("salary")})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"bloodGroup",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Blood Group"}),e.jsxs(a.Select,{...i,name:"bloodGroup",value:l.bloodGroup,onChange:t,onBlur:r,isInvalid:d("bloodGroup"),children:[e.jsx("option",{value:"",children:"Select Blood Group"}),e.jsx("option",{value:"A+",children:"A+"}),e.jsx("option",{value:"A-",children:"A-"}),e.jsx("option",{value:"B+",children:"B+"}),e.jsx("option",{value:"B-",children:"B-"}),e.jsx("option",{value:"AB+",children:"AB+"}),e.jsx("option",{value:"AB-",children:"AB-"}),e.jsx("option",{value:"O+",children:"O+"}),e.jsx("option",{value:"O-",children:"O-"})]})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"role",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Role*"}),e.jsxs(a.Select,{...i,name:"role",value:l.role,onChange:t,onBlur:r,required:!0,isInvalid:d("role"),children:[e.jsx("option",{value:"",children:"Select Role"}),g==null?void 0:g.map(c=>e.jsx("option",{value:c.name,className:"text-capitalize",children:c.name},c.name))]}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:m("role")})]})}),e.jsx(n,{md:12,className:"mt-3",children:e.jsx("h6",{className:"mb-2 fw-semibold bg-light p-1 text-muted",children:"Additional Information"})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"endingDate",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Ending Date"}),e.jsx(a.Control,{...i,type:"date",name:"endingDate",value:l.endingDate,onChange:t,onBlur:r,isInvalid:d("endingDate")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:m("endingDate")})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"openingBalance",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Opening Balance"}),e.jsx(a.Control,{...i,type:"number",name:"openingBalance",value:l.openingBalance,onChange:t,onBlur:r,placeholder:"0.00",step:"0.01",min:"0",isInvalid:d("openingBalance")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:m("openingBalance")})]})}),e.jsx(n,{md:4,className:"mb-2",children:e.jsxs(a.Group,{controlId:"address",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Address"}),e.jsx(a.Control,{...i,as:"textarea",rows:1,name:"address",value:l.address,onChange:t,onBlur:r,placeholder:"123 Main St, City, State, ZIP Code"})]})}),e.jsx(n,{md:4,className:"mb-2",children:e.jsxs(a.Group,{controlId:"description",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Description"}),e.jsx(a.Control,{...i,as:"textarea",rows:1,name:"description",value:l.description,onChange:t,onBlur:r,placeholder:"Additional information about the employee"})]})}),e.jsx(n,{md:12,className:"mt-3",children:e.jsx("h6",{className:"mb-2 fw-semibold bg-light p-1 text-muted",children:"Status & Documents"})}),e.jsx(n,{md:3,className:"mb-2",children:e.jsxs(a.Group,{controlId:"profileImage",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Profile Image"}),e.jsx(a.Control,{...i,type:"file",name:"profileImage",onChange:t,onBlur:r,accept:"image/jpeg,image/png,image/gif",isInvalid:d("profileImage")}),e.jsx(a.Text,{className:"text-muted small",children:"Max 5MB (JPEG, PNG, GIF)"}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:m("profileImage")})]})}),e.jsx(n,{md:3,className:"mb-2",children:e.jsxs(a.Group,{controlId:"idCard",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"ID Card"}),e.jsx(a.Control,{...i,type:"file",name:"idCard",onChange:t,onBlur:r,isInvalid:d("idCard")}),e.jsx(a.Text,{className:"text-muted small",children:"Max 10MB"}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:m("idCard")})]})}),e.jsx(n,{md:3,className:"mb-2",children:e.jsxs(a.Group,{controlId:"document",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Document"}),e.jsx(a.Control,{...i,type:"file",name:"document",onChange:t,onBlur:r,isInvalid:d("document")}),e.jsx(a.Text,{className:"text-muted small",children:"Max 10MB"}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:m("document")})]})}),e.jsxs(n,{md:3,className:"mb-2",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Status"}),e.jsxs(J,{...i,children:[e.jsx(a.Check,{inline:!0,type:"radio",label:"Enable",name:"status",id:"enable",value:"Enable",checked:l.status==="Enable",onChange:t,onBlur:r,className:"small"}),e.jsx(a.Check,{inline:!0,type:"radio",label:"Disable",name:"status",id:"disable",value:"Disable",checked:l.status==="Disable",onChange:t,onBlur:r,className:"small"})]})]})]})})]})})}function ae({onEdit:s}){const h=o.useRef(!1),g=o.useRef(null),l=o.useCallback(()=>{if(h.current)return;$.fn.DataTable.isDataTable("#employeeTable")&&$("#employeeTable").DataTable().destroy();const x=$("#employeeTable").DataTable({processing:!0,serverSide:!0,ajax:{url:route("employee.index"),type:"GET"},columns:[{data:"DT_RowIndex",name:"DT_RowIndex",title:"No",className:"text-center",width:"1%",orderable:!1,searchable:!1},{data:"photo",title:"Photo",className:"text-center",width:"5%"},{data:"name",title:"Name",className:"text-start",width:"15%"},{data:"phone",title:"Phone",className:"text-start",width:"15%"},{data:"role",title:"Role",className:"text-start",width:"15%"},{data:"ending_date",title:"Ending Date",className:"text-start",width:"15%"},{data:"download_assets",title:"Download Assets",className:"text-start",width:"15%"},{data:"status",title:"Status",className:"text-center",width:"10%"},{data:"action",title:"Actions",className:"text-center",width:"10%",orderable:!1,searchable:!1}],drawCallback:function(){$(".edit-btn").off("click").on("click",function(){const u=$(this).data("id");v(u)}),$(".delete-btn").off("click").on("click",function(){const u=$(this).data("id");w(u)})},initComplete:function(){h.current=!0}});return g.current=x,x});o.useEffect(()=>(l(),()=>{$.fn.DataTable.isDataTable("#employeeTable")&&($("#employeeTable").DataTable().destroy(),h.current=!1)}),[l]);const v=async x=>{try{const u=await L.get(route("employee.edit",x));u.data.success===!0&&s(u.data.employee)}catch{B.error("An error occurred while fetching the employee data.")}},w=async x=>{try{(await L.get(route("employee.destroy",x))).data.success===!0&&B.success("Employee deleted successfully")}catch{B.error("An error occurred while fetching the employee data.")}};return e.jsxs(T,{className:"border-0 rounded-0 shadow-sm",children:[e.jsx(T.Header,{className:"d-flex justify-content-between align-items-center bg-transparent",children:e.jsx("h6",{className:"mb-0 fw-semibold",children:"Employee Management"})}),e.jsx(T.Body,{className:"px-0",children:e.jsx(X,{size:"sm",bordered:!0,hover:!0,striped:!0,responsive:!0,id:"employeeTable"})})]})}function ge(){const[s,h]=o.useState("users"),[g,l]=o.useState(null),[v,w]=o.useState(!1),x=o.useCallback(N=>{h(N),N!=="user-update"&&(w(!1),l(null))},[]),u=o.useCallback(N=>{h("user-update"),w(!0),l(N)},[]),C=o.useCallback(()=>{h("users"),F.reload()},[]);return e.jsxs(V,{children:[e.jsx(_,{title:"User Management"}),e.jsxs(Y,{activeKey:s,onSelect:x,className:"users-tabs mb-3",id:"user-management-tabs",children:[e.jsx(S,{eventKey:"users",title:e.jsxs(e.Fragment,{children:[e.jsx(z,{size:16,className:"me-1"})," Users"]}),children:e.jsx(ae,{onEdit:u,onSuccess:C})}),e.jsx(S,{eventKey:"new-user",title:e.jsxs(e.Fragment,{children:[e.jsx(O,{size:16,className:"me-1"})," New User"]}),children:e.jsx(q,{onSuccess:C})}),v&&e.jsx(S,{eventKey:"user-update",title:e.jsxs(e.Fragment,{children:[e.jsx(K,{size:16,className:"me-1"})," User Update"]}),disabled:!v,children:g?e.jsx(q,{employee:g,onSuccess:C,onCancel:()=>h("users")}):e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{children:"Please select a user to edit"})})})]})]})}export{ge as default};
