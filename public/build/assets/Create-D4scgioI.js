import{v as O,r as x,j as e,$ as R,m as z}from"./app-BiuRToP-.js";import{B as l,R as S,N as c,y as _}from"./Footer-BFQJwEZ5.js";import{x as M}from"./axios-MrMjc1qv.js";import{B as U,P as q,I as V,M as Y,a as H,b as J,S as G,c as Q,F as B}from"./Media-Bg_JnBBD.js";import{E as W}from"./ErpLayout-D0g2LxLo.js";import{u as X}from"./useData-Zpyw-B5W.js";import{S as Z}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{C as ee,B as se}from"./Image---NnaHc0.js";import{F as I,C as j}from"./Form-BA0l1WBA.js";import{C as u}from"./Card-CQupX1hM.js";import{T as d}from"./Tab-qgvBwMya.js";import{I as ae,C as te,B as re,a as T}from"./info-circle-DjB46Kf7.js";import{T as ie}from"./trash-AL2goIw4.js";import"./CloseButton-B--YT67x.js";import"./index-BDPxczRQ.js";import"./iconBase-DPOgRSCr.js";import"./Alert-B6L71HX_.js";import"./Spinner-DbU-VvBa.js";import"./react-select.esm-COl-_cWg.js";import"./hoist-non-react-statics.cjs-C-Qo8PK8.js";import"./floating-ui.dom-DvtPwI1-.js";/* empty css                      */function $e({attributes:ne=[]}){const{categories:P,brands:E,taxes:K}=X(),{data:s,setData:r,errors:p}=O({branch_id:"",name:"",slug:"",short_description:"",description:"",meta_title:"",meta_description:"",category_id:"",brand_id:"",price:0,agent_price:0,wholesaler_price:0,compare_price:0,cost_per_item:0,tax_id:"",tax_amount:0,sku:"",barcode:"",quantity:0,low_stock_threshold:0,stock_status:"in_stock",track_inventory:!1,allow_backorders:!1,is_digital:!1,requires_shipping:!0,weight:0,weight_unit:"kg",length:0,width:0,height:0,dimension_unit:"cm",is_featured:!1,is_active:!0,is_bestseller:!1,is_new:!1,new_until:"",has_variants:!1,tags:[],specifications:{},custom_fields:{},related_products:[],images:[],variants:[],selected_attributes:[],selected_attribute_values:[]}),[$,D]=x.useState([]),[ce,oe]=x.useState(""),[le,de]=x.useState(""),[v,f]=x.useState(!1),[C,F]=x.useState("basic"),L=async t=>{var o,h,m,y;t.preventDefault(),f(!0);try{if(!(await Z.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, create it!"})).isConfirmed){f(!1);return}const i=new FormData;Object.keys(s).forEach(a=>{a==="images"||a==="variants"||a==="selected_attributes"||a==="selected_attribute_values"||a==="related_products"||(a==="specifications"?i.append(a,JSON.stringify(s[a])):i.append(a,s[a]===null?"":s[a]))}),s.images.forEach((a,n)=>{i.append(`images[${n}]`,a)}),s.variants.forEach((a,n)=>{Object.keys(a).forEach(b=>{i.append(`variants[${n}][${b}]`,a[b]===null?"":a[b])})}),s.selected_attributes.forEach((a,n)=>{i.append(`attributes[${n}][id]`,a.value),i.append(`attributes[${n}][name]`,a.label)}),s.selected_attribute_values.forEach((a,n)=>{i.append(`attribute_values[${n}][id]`,a.value),i.append(`attribute_values[${n}][value]`,a.label)}),s.related_products.forEach((a,n)=>{i.append(`related_products[${n}]`,a.id||a)}),(await M.post(route("product.store"),i,{headers:{"Content-Type":"multipart/form-data"}})).status===200&&(_.success("Product created successfully"),f(!1),z.reload())}catch(g){if(f(!1),(h=(o=g.response)==null?void 0:o.data)!=null&&h.errors){const i=g.response.data.errors;Object.values(i).forEach(w=>{w.forEach(a=>{_.error(a)})})}else _.error(((y=(m=g.response)==null?void 0:m.data)==null?void 0:y.error)||"An error occurred while creating the product")}},k=t=>{D(t),r("tags",t.map(o=>o.value))},N=()=>{if(!s.is_active)return e.jsx(l,{bg:"secondary",children:"Inactive"});const t=[];return s.is_featured&&t.push(e.jsx(l,{bg:"info",className:"me-1",children:"Featured"},"featured")),s.is_bestseller&&t.push(e.jsx(l,{bg:"warning",className:"me-1",children:"Bestseller"},"bestseller")),s.is_new&&t.push(e.jsx(l,{bg:"success",className:"me-1",children:"New"},"new")),s.compare_price>s.price&&t.push(e.jsx(l,{bg:"danger",className:"me-1",children:"Sale"},"sale")),t.length?t:e.jsx(l,{bg:"primary",children:"Active"})},A=()=>!s.images||s.images.length===0?e.jsxs("div",{className:"border rounded p-4 text-center",children:[e.jsx(T,{size:48,className:"text-muted mb-2"}),e.jsx("p",{className:"text-muted",children:"No images uploaded"}),e.jsx(B,{onChange:t=>r("images",[...s.images,...t]),accept:"image/*",multiple:!0})]}):e.jsxs(S,{className:"g-2",children:[s.images.map((t,o)=>e.jsx(j,{xs:6,md:3,children:e.jsxs(u,{className:"h-100",children:[e.jsx(u.Img,{variant:"top",src:URL.createObjectURL(t),style:{height:"120px",objectFit:"cover"}}),e.jsx(u.Body,{className:"p-2",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx(I.Check,{type:"radio",name:"defaultImage",label:"Default",checked:t.is_default,onChange:()=>r("images",s.images.map((h,m)=>({...h,is_default:m===o})))}),e.jsx(se,{variant:"outline-danger",size:"sm",onClick:()=>r("images",s.images.filter((h,m)=>m!==o)),children:e.jsx(ie,{size:14})})]})})]})},o)),e.jsx(j,{md:12,children:e.jsx("div",{className:"border p-2",children:e.jsx(B,{onChange:t=>r("images",[...s.images,...t]),accept:"image/*",multiple:!0,buttonText:"Add Images",buttonVariant:"outline-primary",buttonSize:"sm"})})})]});return e.jsxs(W,{children:[e.jsx(R,{title:"Create New Product"}),e.jsxs(ee,{fluid:!0,className:"py-4",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h2",{className:"mb-0 d-inline-block",children:"Create New Product"}),e.jsxs("div",{children:[N(),e.jsx(l,{bg:s.is_digital?"info":"primary",className:"ms-2",children:s.is_digital?"Digital":"Physical"})]})]}),e.jsx("hr",{className:"dashed-hr mb-3"}),e.jsx(I,{onSubmit:L,children:e.jsxs(S,{className:"g-4",children:[e.jsx(j,{lg:8,children:e.jsxs(u,{className:"mb-4",children:[e.jsx(u.Header,{className:"bg-white",children:e.jsx(d.Container,{activeKey:C,onSelect:F,children:e.jsxs(c,{variant:"tabs",className:"mb-0",children:[e.jsx(c.Item,{children:e.jsxs(c.Link,{eventKey:"basic",children:[e.jsx(ae,{className:"me-1"})," Basic Info"]})}),e.jsx(c.Item,{children:e.jsxs(c.Link,{eventKey:"pricing",children:[e.jsx(te,{className:"me-1"})," Pricing"]})}),e.jsx(c.Item,{children:e.jsxs(c.Link,{eventKey:"inventory",children:[e.jsx(re,{className:"me-1"})," Inventory"]})}),e.jsx(c.Item,{children:e.jsxs(c.Link,{eventKey:"media",children:[e.jsx(T,{className:"me-1"})," Media"]})})]})})}),e.jsx(u.Body,{children:e.jsx(d.Container,{activeKey:C,children:e.jsxs(d.Content,{children:[e.jsx(d.Pane,{eventKey:"basic",children:e.jsx(U,{data:s,setData:r,errors:p,categories:P,brands:E})}),e.jsx(d.Pane,{eventKey:"pricing",children:e.jsx(q,{data:s,setData:r,errors:p,taxes:K})}),e.jsx(d.Pane,{eventKey:"inventory",children:e.jsx(V,{data:s,setData:r,errors:p})}),e.jsx(d.Pane,{eventKey:"media",children:e.jsx(Y,{renderImages:A})})]})})})]})}),e.jsxs(j,{lg:4,children:[e.jsx(H,{data:s,setData:r,processing:v,renderStatusBadge:N,isCreate:!0}),e.jsx(J,{data:s,setData:r}),e.jsx(G,{data:s,setData:r,errors:p}),e.jsx(Q,{data:s,setData:r,errors:p,selectedTags:$,handleTagChange:k,processing:v})]})]})})]})]})}export{$e as default};
