import{r as c,R as v,u as De,j as e,$ as Qe,Y as Ve}from"./app-CxIzz1Hm.js";import{y as Ee,p as Xe,z as Je,A as Ze,B as $e,C as Le,D as et,E as tt,G as st,H as se,o as Ie,I as xe,J as Fe,K as rt,b as at,L as nt}from"./index-DEpCKpyh.js";import{P as w,I as f,R as M,y,D as re}from"./Footer-1rOk33u-.js";import{p as it}from"./PrintReceipt-RkRJME9w.js";import{a as F}from"./helpers-gygXJL7Y.js";import{C as R}from"./Card-BGz8PFHq.js";import{B as ot}from"./Badge-BA1TPNb1.js";import{T as ct}from"./Table-EbxAEte5.js";import{c as C,C as b,F as lt}from"./Form-C32FoLO3.js";import{B as N}from"./Image-B2kFzfRD.js";import{P as dt}from"./PaymentMethods-D4LtDDFv.js";import{E as ut}from"./ErpLayout-CKY1G0eu.js";import{x as ae}from"./axios-CbP2VCmx.js";import{S as Re}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{u as mt}from"./useData-DPZ4tnDZ.js";/* empty css                      */import{L as ne}from"./ListGroup-DPDZfZqd.js";import{S as ht}from"./Spinner-BumNi9g0.js";import{A as xt}from"./Alert-MwJf8Lk_.js";import{B as ft}from"./ButtonGroup-BeeULg22.js";import"./iconBase-8l29Fq_8.js";import"./CloseButton-DTBn4gN-.js";import"./Tabs-BUKj54RS.js";import"./Tab-CrW5KUTK.js";function fe(){return fe=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(s[r]=a[r])}return s},fe.apply(this,arguments)}function pt(s,o){if(s==null)return{};var a=jt(s,o),r,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(s);for(i=0;i<l.length;i++)r=l[i],!(o.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(s,r)&&(a[r]=s[r])}return a}function jt(s,o){if(s==null)return{};var a={},r=Object.keys(s),i,l;for(l=0;l<r.length;l++)i=r[l],!(o.indexOf(i)>=0)&&(a[i]=s[i]);return a}var ge=c.forwardRef(function(s,o){var a=s.color,r=a===void 0?"currentColor":a,i=s.size,l=i===void 0?24:i,j=pt(s,["color","size"]);return v.createElement("svg",fe({ref:o,xmlns:"http://www.w3.org/2000/svg",width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},j),v.createElement("line",{x1:"4",y1:"9",x2:"20",y2:"9"}),v.createElement("line",{x1:"4",y1:"15",x2:"20",y2:"15"}),v.createElement("line",{x1:"10",y1:"3",x2:"8",y2:"21"}),v.createElement("line",{x1:"16",y1:"3",x2:"14",y2:"21"}))});ge.propTypes={color:w.string,size:w.oneOfType([w.string,w.number])};ge.displayName="Hash";function pe(){return pe=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(s[r]=a[r])}return s},pe.apply(this,arguments)}function gt(s,o){if(s==null)return{};var a=yt(s,o),r,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(s);for(i=0;i<l.length;i++)r=l[i],!(o.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(s,r)&&(a[r]=s[r])}return a}function yt(s,o){if(s==null)return{};var a={},r=Object.keys(s),i,l;for(l=0;l<r.length;l++)i=r[l],!(o.indexOf(i)>=0)&&(a[i]=s[i]);return a}var ye=c.forwardRef(function(s,o){var a=s.color,r=a===void 0?"currentColor":a,i=s.size,l=i===void 0?24:i,j=gt(s,["color","size"]);return v.createElement("svg",pe({ref:o,xmlns:"http://www.w3.org/2000/svg",width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},j),v.createElement("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),v.createElement("polyline",{points:"17 21 17 13 7 13 7 21"}),v.createElement("polyline",{points:"7 3 7 8 15 8"}))});ye.propTypes={color:w.string,size:w.oneOfType([w.string,w.number])};ye.displayName="Save";function je(){return je=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(s[r]=a[r])}return s},je.apply(this,arguments)}function bt(s,o){if(s==null)return{};var a=vt(s,o),r,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(s);for(i=0;i<l.length;i++)r=l[i],!(o.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(s,r)&&(a[r]=s[r])}return a}function vt(s,o){if(s==null)return{};var a={},r=Object.keys(s),i,l;for(l=0;l<r.length;l++)i=r[l],!(o.indexOf(i)>=0)&&(a[i]=s[i]);return a}var be=c.forwardRef(function(s,o){var a=s.color,r=a===void 0?"currentColor":a,i=s.size,l=i===void 0?24:i,j=bt(s,["color","size"]);return v.createElement("svg",je({ref:o,xmlns:"http://www.w3.org/2000/svg",width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},j),v.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),v.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))});be.propTypes={color:w.string,size:w.oneOfType([w.string,w.number])};be.displayName="X";const wt=({paymentData:s={},totalPaid:o})=>{const{cartItems:a,removeFromCart:r,updateQuantity:i,cartTotal:l,itemCount:j}=De(),W=d=>Array.isArray(d)?d:d&&Array.isArray(d.transactions)?d.transactions:[],z=c.useMemo(()=>Object.entries(s).filter(([,d])=>Array.isArray(d)||Array.isArray(d==null?void 0:d.transactions)).map(([d,g])=>{const V=W(g).reduce((U,_)=>U+(Number(_.amount)||0),0);return{method:d,total:V}}),[s]),H=c.useMemo(()=>z.reduce((d,g)=>d+g.total,0),[z]),D=typeof o=="number"?o:H,Y=Math.max(l-D,0),Q=D>l?D-l:0,S=(d,g)=>{g>=1&&i(d,g)};return e.jsxs(R,{className:"border-0 rounded-0 shadow-sm",children:[e.jsxs(R.Header,{className:"bg-white fw-bold d-flex justify-content-between align-items-center py-3",children:[e.jsx("span",{children:"Sale Summary"}),e.jsxs(ot,{bg:"primary",pill:!0,children:[e.jsx(Ee,{className:"me-1"}),j]})]}),e.jsx(R.Body,{className:"p-0",style:{maxHeight:"400px",overflowY:"auto"},children:a.length===0?e.jsxs("div",{className:"text-center py-5",children:[e.jsx(Ee,{size:48,className:"text-muted mb-3"}),e.jsx("h4",{children:"Your cart is empty"}),e.jsx("p",{className:"text-muted mb-4",children:"Looks like you haven't added any items yet"})]}):e.jsxs(ct,{responsive:!0,hover:!0,className:"mb-0",children:[e.jsx("thead",{className:"bg-light",children:e.jsxs("tr",{children:[e.jsx("th",{className:"ps-3",children:"Product"}),e.jsx("th",{children:"Price"}),e.jsx("th",{children:"Qty"}),e.jsx("th",{children:"Total"}),e.jsx("th",{className:"pe-3",children:"Action"})]})}),e.jsx("tbody",{children:a.map(d=>e.jsxs("tr",{children:[e.jsx("td",{className:"align-middle ps-3",children:d.name||`Product ${d.id}`}),e.jsx("td",{className:"align-middle text-end",children:F(d.price)}),e.jsx("td",{className:"align-middle",children:e.jsx(C,{type:"number",min:"1",className:"text-center",style:{width:"70px"},value:d.quantity,onChange:g=>S(d.id,parseInt(g.target.value)||1)})}),e.jsx("td",{className:"align-middle text-end fw-semibold",children:F(d.price*d.quantity)}),e.jsx("td",{className:"align-middle text-end pe-3",children:e.jsx(N,{variant:"outline-danger",size:"sm",onClick:()=>r(d.id),title:"Remove item",children:e.jsx(Xe,{})})})]},d.id))})]})}),e.jsxs(R.Footer,{className:"bg-white p-3",children:[e.jsx("div",{className:"mb-3",children:e.jsxs(f,{children:[e.jsxs(f.Text,{className:"fw-bold bg-light",style:{width:"160px"},children:[e.jsx(Je,{className:"me-1"}),"Total Billed"]}),e.jsx(C,{value:F(l),className:"text-end fw-bold bg-light",disabled:!0})]})}),e.jsx(M,{className:"g-2 mb-3",children:z.map(({method:d,total:g})=>e.jsx(b,{md:12,children:e.jsxs(f,{children:[e.jsxs(f.Text,{className:"fw-bold bg-light text-capitalize",style:{width:"160px"},children:[e.jsx(Ze,{className:"me-1"}),d]}),e.jsx(C,{value:F(g),className:"text-end fw-bold bg-light",disabled:!0})]})},d))}),e.jsx("hr",{}),e.jsx("div",{className:"mb-2",children:e.jsxs(f,{children:[e.jsxs(f.Text,{className:"fw-bold bg-light",style:{width:"160px"},children:[e.jsx($e,{className:"me-1"}),"Total Paid"]}),e.jsx(C,{value:F(D),className:"text-end fw-bold bg-light",disabled:!0})]})}),e.jsx("div",{className:"mb-2",children:e.jsxs(f,{children:[e.jsxs(f.Text,{className:`fw-bold ${Y>0?"text-warning":"text-success"} bg-light`,style:{width:"160px"},children:[e.jsx(Le,{className:"me-1"}),"Balance Due"]}),e.jsx(C,{value:F(Y),className:`text-end fw-bold ${Y>0?"text-warning":"text-success"}`,disabled:!0})]})}),Q>0&&e.jsx("div",{className:"mb-2",children:e.jsxs(f,{children:[e.jsxs(f.Text,{className:"fw-bold text-info bg-light",style:{width:"160px"},children:[e.jsx(Le,{className:"me-1"}),"Change"]}),e.jsx(C,{value:F(Q),className:"text-end fw-bold text-info",disabled:!0})]})})]})]})},Qt=({sale:s=null})=>{var Pe,Te,Oe,Be;const{cartItems:o,clearCart:a,cartTotal:r,setCartItems:i,addToCart:l}=De(),[j,W]=c.useState(!1),[z,H]=c.useState(((Pe=s==null?void 0:s.customer)==null?void 0:Pe.name)||((Te=s==null?void 0:s.customer)==null?void 0:Te.full_name)||""),[D,Y]=c.useState([]),[Q,S]=c.useState(!1),[d,g]=c.useState((s==null?void 0:s.customer_id)||null),[A,V]=c.useState(s!=null&&s.date?new Date(s.date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0]),U=c.useRef(null),[_,G]=c.useState(""),[I,ze]=c.useState("barcode"),[ve,K]=c.useState(!1),[Nt,we]=c.useState([]),[X,O]=c.useState([]),[Ne,B]=c.useState(!1),ie=c.useRef(null),[oe,$]=c.useState(""),[E,Ce]=c.useState(!0),[ce,Ae]=c.useState(null),k=c.useRef(null),{products:P,paymentMethods:le}=mt(),[q,J]=c.useState({}),Se=c.useCallback(()=>{if(s!=null&&s.order_number)return s.order_number;const t=Date.now(),u=Math.floor(Math.random()*1e3);return`ORD-${t}-${u}`},[s]),de=c.useMemo(()=>({id:(s==null?void 0:s.id)||null,order_number:Se(),date:(s==null?void 0:s.date)||A,customer_id:(s==null?void 0:s.customer_id)||d}),[s,A,d,Se]);c.useEffect(()=>{if(!(s!=null&&s.payments)||!le.length)return;const t=le.reduce((u,n)=>{const m=n.name.toLowerCase(),h=s.payments.filter(x=>{var p;return((p=x.payment_method_name)==null?void 0:p.toLowerCase())===m});return h.length>0&&(u[m]=h.map(x=>x.metadata||{})),u},{});J(t)},[s,le]),c.useEffect(()=>{var t;if(((t=s==null?void 0:s.items)==null?void 0:t.length)>0){const u=s.items.map(n=>({id:n.product_id,name:n.product_name,price:n.unit_price||n.price,image:"",quantity:n.quantity,product_item_id:n.product_item_id,sku:n.sku}));i(u)}},[s,i]),c.useEffect(()=>{k.current&&!s&&k.current.focus()},[s]),c.useEffect(()=>{const t=u=>{U.current&&!U.current.contains(u.target)&&ie.current&&!ie.current.contains(u.target)&&(S(!1),B(!1))};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]),c.useEffect(()=>{if(!P||P.length===0)return;if(!_.trim()){we(P);return}const t=_.toLowerCase().trim();let u=[];switch(I){case"barcode":u=P.filter(n=>{var m,h;return((m=n.barcode)==null?void 0:m.toLowerCase().includes(t))||((h=n.product_items)==null?void 0:h.some(x=>{var p;return(p=x.barcode)==null?void 0:p.toLowerCase().includes(t)}))});break;case"sku":u=P.filter(n=>{var m,h;return((m=n.sku)==null?void 0:m.toLowerCase().includes(t))||((h=n.product_items)==null?void 0:h.some(x=>{var p;return(p=x.sku)==null?void 0:p.toLowerCase().includes(t)}))});break;case"category":u=P.filter(n=>{var m,h,x;return((h=(m=n.category)==null?void 0:m.name)==null?void 0:h.toLowerCase().includes(t))||((x=n.product_items)==null?void 0:x.some(p=>{var T,L;return(L=(T=p.category)==null?void 0:T.name)==null?void 0:L.toLowerCase().includes(t)}))});break;case"name":default:u=P.filter(n=>{var m,h,x;return((m=n.name)==null?void 0:m.toLowerCase().includes(t))||((h=n.description)==null?void 0:h.toLowerCase().includes(t))||((x=n.product_items)==null?void 0:x.some(p=>{var T,L;return((T=p.name)==null?void 0:T.toLowerCase().includes(t))||((L=p.description)==null?void 0:L.toLowerCase().includes(t))}))});break}we(u)},[P,_,I]);const Z=c.useCallback(t=>{if(o.find(n=>n.id===t.id||t.product_item_id&&n.product_item_id===t.product_item_id)){const n=o.map(m=>m.id===t.id||t.product_item_id&&m.product_item_id===t.product_item_id?{...m,quantity:m.quantity+1}:m);i(n),y.info(`Increased quantity of ${t.name}`)}else{const n={id:t.id,name:t.name,price:t.price||t.selling_price||0,image:t.image||t.image_url||"",quantity:1,product_item_id:t.product_item_id||null,sku:t.sku||t.code,barcode:t.barcode,stock:t.stock_quantity||t.quantity||0};l(n),y.success(`Added ${t.name} to cart`)}G(""),$(""),B(!1),k.current&&E&&k.current.focus()},[o,i,l,E]),qe=c.useCallback(async t=>{var u,n;if(H(t),t.length<=2){S(!1);return}try{const{data:m}=await ae.get(route("api.customer.search"),{params:{value:t}});m.success?(Y(m.customers||[]),S(!0)):(y.error(m.message),S(!1))}catch(m){y.error(((n=(u=m.response)==null?void 0:u.data)==null?void 0:n.message)||"An error occurred"),S(!1)}},[]),ue=c.useCallback(async t=>{var u;if(!t.trim()){O([]);return}K(!0);try{const n=P.filter(h=>{var x;return h.barcode===t||((x=h.product_items)==null?void 0:x.some(p=>p.barcode===t))});if(n.length>0){O(n),B(!0),n.length===1&&(Z(n[0]),$("")),K(!1);return}const{data:m}=await ae.get(route("api.products.search"),{params:{query:t,search_type:"barcode"}});m.success&&((u=m.products)==null?void 0:u.length)>0?(O(m.products),B(!0),m.products.length===1&&(Z(m.products[0]),$(""))):(y.info(`No product found with barcode: ${t}`),O([]))}catch(n){console.error("Barcode search error:",n),y.error("Failed to search product")}finally{K(!1)}},[P,Z]),Me=c.useCallback(t=>{const u=t.target.value;$(u),ce&&clearTimeout(ce);const n=setTimeout(()=>{u.trim().length>=3&&ue(u)},300);Ae(n)},[ce,ue]),me=c.useCallback(async t=>{if(!t.trim()){O([]),B(!1);return}K(!0);try{const{data:u}=await ae.get(route("api.products.search"),{params:{query:t,search_type:I}});u.success?(O(u.products||[]),B(!0)):(y.error(u.message),O([]))}catch(u){console.error("Product search error:",u),O([])}finally{K(!1)}},[I]),We=c.useCallback(t=>{g(t.id),H(t.name||t.full_name||""),S(!1)},[]),He=c.useCallback(t=>{V(t.target.value)},[]),Ye=c.useCallback(()=>{Re.fire({title:"Are you sure?",text:"This will reset all changes and clear the cart.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, reset!",cancelButtonText:"Cancel"}).then(t=>{t.isConfirmed&&(a(),V(new Date().toISOString().split("T")[0]),g(null),H(""),G(""),$(""),S(!1),B(!1),J({}),y.success("Sale form has been reset"),k.current&&E&&k.current.focus())})},[a,E]),_e=c.useCallback(()=>d?r<=0?(y.error("Cart is empty. Please add products before submitting."),!1):(Object.values(q).flat().reduce((u,n)=>u+(parseFloat(n.amount)||0),0)<r&&y.warning("Total payments are less than cart total."),!0):(y.error("Please select a customer before submitting."),!1),[d,r,q]),ke=c.useCallback(async(t,u=!1)=>{var n,m,h,x,p;if(t.preventDefault(),!!_e()){W(!0);try{if(!(await Re.fire({title:"Confirm submission",text:s?"Do you want to update this sale?":"Do you want to save this sale?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:s?"Yes, update it!":"Yes, save it!",cancelButtonText:"Cancel"})).isConfirmed){W(!1);return}const L={...de,date:A,customer_id:d,cartItems:o.map(te=>({product_id:te.id,product_item_id:te.product_item_id,quantity:te.quantity,unit_price:te.price})),paymentData:q},Ke=s?route("sales.update",{sale:s.id}):route("sales.store"),ee=await ae({method:s?"PUT":"POST",url:Ke,data:L,headers:{"Content-Type":"application/json"}});ee.data.success&&(y.success(ee.data.message),u&&((n=ee.data.data)!=null&&n.order)&&it(ee.data.data.order),s||(a(),G(""),$(""),k.current&&E&&k.current.focus()))}catch(T){const L=((h=(m=T.response)==null?void 0:m.data)==null?void 0:h.message)||((p=(x=T.response)==null?void 0:x.data)==null?void 0:p.errors)||"An error occurred while saving the sale";y.error(L),console.error("Sale submission error:",T)}finally{W(!1)}}},[de,o,r,q,s,d,A,_e,a,E]),Ue=t=>{qe(t.target.value)},Ge=()=>s!=null&&s.order_number?s.order_number:de.order_number||"Auto-generated",he=[{value:"barcode",label:"Barcode",icon:e.jsx(se,{className:"me-1"})},{value:"name",label:"Name",icon:e.jsx(nt,{className:"me-1"})},{value:"sku",label:"SKU",icon:e.jsx(ge,{size:14,className:"me-1"})},{value:"category",label:"Category",icon:e.jsx(Fe,{className:"me-1"})}];return e.jsxs(ut,{children:[e.jsx(Qe,{title:s?"Edit Sale":"Create New Sale"}),e.jsx(lt,{onSubmit:t=>ke(t,!1),children:e.jsxs(M,{className:"g-2",children:[e.jsxs(b,{md:8,children:[e.jsxs(M,{className:"g-2 mb-3",children:[e.jsx(b,{md:3,children:e.jsxs(f,{children:[e.jsx(f.Text,{className:"rounded-0",children:e.jsx(et,{})}),e.jsx(C,{type:"date",value:A,onChange:He,className:"rounded-0",required:!0})]})}),e.jsx(b,{md:3,children:e.jsxs(f,{children:[e.jsx(f.Text,{className:"rounded-0",children:e.jsx($e,{})}),e.jsx(C,{type:"text",value:Ge(),placeholder:"Order Number",className:"rounded-0",disabled:!0,readOnly:!0})]})}),e.jsx(b,{md:6,ref:U,children:e.jsxs(f,{children:[e.jsx(f.Text,{className:"rounded-0",children:e.jsx(tt,{})}),e.jsx(C,{type:"search",placeholder:"Customer Name or Phone...",className:"rounded-0",value:z,onChange:Ue,onFocus:()=>z.length>2&&S(!0),required:!0}),e.jsx(N,{variant:"outline-secondary",className:"rounded-0",type:"button",as:Ve,href:route("customers.create"),children:e.jsx(st,{})}),Q&&D.length>0&&e.jsx(ne,{className:"position-absolute rounded-0 w-100",style:{zIndex:1050,top:"100%",maxHeight:"300px",overflowY:"auto"},children:D.map(t=>e.jsx(ne.Item,{action:!0,onClick:()=>We(t),className:"rounded-0 border-top-0",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("strong",{children:t.name||t.full_name}),e.jsxs("div",{className:"small text-muted",children:[t.email&&`${t.email} â€¢ `,t.phone]})]}),t.id===d&&e.jsx("span",{className:"badge bg-success",children:"Selected"})]})},t.id))})]})}),e.jsx(b,{xs:12,ref:ie,children:e.jsx(R,{className:"rounded-0 border",children:e.jsxs(R.Body,{className:"p-3",children:[e.jsxs(M,{className:"align-items-center g-2",children:[e.jsx(b,{xs:"auto",children:e.jsxs(N,{variant:E?"primary":"outline-primary",className:"rounded-0",onClick:()=>Ce(!0),title:"Barcode Scanner Mode",children:[e.jsx(se,{className:"me-1"}),"Scan"]})}),e.jsx(b,{xs:"auto",children:e.jsxs(N,{variant:E?"outline-primary":"primary",className:"rounded-0",onClick:()=>Ce(!1),title:"Manual Search Mode",children:[e.jsx(Ie,{className:"me-1"}),"Search"]})}),e.jsx(b,{children:E?e.jsxs(f,{children:[e.jsx(f.Text,{className:"rounded-0",children:e.jsx(se,{})}),e.jsx(C,{ref:k,type:"text",placeholder:"Scan barcode or enter barcode number...",className:"rounded-0",value:oe,onChange:Me,onKeyPress:t=>{t.key==="Enter"&&(t.preventDefault(),ue(oe))}}),oe&&e.jsx(N,{variant:"outline-secondary",className:"rounded-0",onClick:()=>{$(""),k.current.focus()},children:e.jsx(xe,{})})]}):e.jsxs(f,{children:[e.jsxs(re,{children:[e.jsxs(re.Toggle,{variant:"outline-secondary",className:"rounded-0",id:"search-type-dropdown",children:[(Oe=he.find(t=>t.value===I))==null?void 0:Oe.icon,(Be=he.find(t=>t.value===I))==null?void 0:Be.label]}),e.jsx(re.Menu,{className:"rounded-0",children:he.map(t=>e.jsxs(re.Item,{onClick:()=>ze(t.value),active:I===t.value,children:[t.icon,t.label]},t.value))})]}),e.jsx(C,{type:"search",placeholder:`Search by ${I}...`,className:"rounded-0",value:_,onChange:t=>{G(t.target.value),me(t.target.value)},onKeyPress:t=>{t.key==="Enter"&&(t.preventDefault(),me(_))}}),e.jsx(N,{variant:"outline-primary",className:"rounded-0",onClick:()=>me(_),disabled:ve||!_.trim(),children:ve?e.jsx(ht,{animation:"border",size:"sm"}):e.jsx(Ie,{})}),_&&e.jsx(N,{variant:"outline-secondary",className:"rounded-0",onClick:()=>{G(""),O([]),B(!1)},children:e.jsx(xe,{})})]})})]}),Ne&&X.length>0&&e.jsxs(R,{className:"mt-2 rounded-0",children:[e.jsxs(R.Header,{className:"py-2 px-3 bg-light d-flex justify-content-between align-items-center",children:[e.jsxs("small",{className:"text-muted",children:["Found"," ",X.length," ","product(s)"]}),e.jsx(N,{variant:"link",size:"sm",className:"p-0",onClick:()=>B(!1),children:e.jsx(xe,{})})]}),e.jsx(ne,{variant:"flush",className:"max-h-300 overflow-auto",children:X.map(t=>e.jsx(ne.Item,{className:"p-2 border-bottom",action:!0,onClick:()=>Z(t),children:e.jsxs(M,{className:"align-items-center",children:[e.jsx(b,{xs:"auto",children:t.image?e.jsx("img",{src:t.image,alt:t.name,className:"rounded",style:{width:"40px",height:"40px",objectFit:"cover"}}):e.jsx("div",{className:"rounded bg-secondary d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:e.jsx(Fe,{className:"text-white"})})}),e.jsx(b,{children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("div",{children:[e.jsx("strong",{children:t.name}),t.description&&e.jsx("div",{className:"small text-muted",children:t.description.length>50?`${t.description.substring(0,50)}...`:t.description})]}),e.jsxs("div",{className:"text-end",children:[e.jsx("div",{className:"fw-bold",children:F(t.price||t.selling_price||0)}),t.barcode&&e.jsxs("small",{className:"text-muted",children:[e.jsx(se,{className:"me-1"}),t.barcode]}),t.stock_quantity!==void 0&&e.jsxs("div",{className:"small",children:["Stock:"," ",t.stock_quantity]})]})]})})]})},t.id))})]}),Ne&&X.length===0&&e.jsxs(xt,{variant:"info",className:"mt-2 mb-0 rounded-0",children:[e.jsx(rt,{className:"me-2"}),"No products found. Try a different search term."]})]})})})]}),e.jsx(M,{className:"g-2",children:e.jsx(b,{xs:12,children:e.jsx(dt,{paymentData:q,setPaymentData:J,cartTotal:r})})})]}),e.jsxs(b,{md:4,children:[e.jsx(wt,{paymentData:q,setPaymentData:J}),e.jsxs(ft,{className:"d-flex gap-2 mt-3",children:[e.jsxs(N,{type:"button",variant:"success",className:"rounded-0 shadow-sm flex-fill",onClick:t=>ke(t,!0),disabled:j||r===0,children:[e.jsx(at,{className:"me-2"}),j?"Processing...":s?"Update & Print":"Save & Print"]}),e.jsxs(N,{type:"button",variant:"warning",className:"rounded-0 shadow-sm flex-fill",onClick:Ye,disabled:j,children:[e.jsx(be,{className:"me-2"}),s?"Reset":"Cancel"]}),e.jsxs(N,{type:"submit",variant:"primary",className:"rounded-0 shadow-sm flex-fill",disabled:j||r===0,children:[e.jsx(ye,{className:"me-2"}),j?"Processing...":s?"Update Sale":"Save Sale"]})]})]})]})})]})};export{Qt as default};
