import{v as R,r as o,m as O,j as e,$ as _}from"./app-B6bJk2Gh.js";import{g as K,h as V,i as W}from"./index-DYXuxtTQ.js";import{E as H}from"./ErpLayout-S_Bw1Fr5.js";import{R as J,y as B}from"./Footer-BPljjA9E.js";import{x as z}from"./axios-Bz5UAVk7.js";import{c as Q,a as F,b as u,d as S,e as Z}from"./index.esm-Bxz4JLJR.js";import{u as X}from"./useData-BUBjg0GA.js";import{F as a,C as n}from"./Form-Clbnm1Ud.js";import{C as T}from"./Card-BMU9SnLN.js";import{B as Y}from"./ButtonGroup-DpsXod-K.js";import{B as A}from"./Image-CDh2egit.js";import{T as ee}from"./Table-Dd8Z3mE4.js";import{T as ae}from"./Tabs-DjiBJFs2.js";import{T as P}from"./Tab-DcG2uuE2.js";import"./iconBase-Gnfgm25M.js";/* empty css                      */import"./CloseButton-BElCAkq0.js";const se=Q().shape({name:u().required("Name is required").min(2,"Name must be at least 2 characters"),email:u().email("Invalid email format").nullable(),phone:u().required("Phone number is required").matches(/^[0-9+\-\s()]{10,}$/,"Invalid phone number format"),username:u().min(3,"Username must be at least 3 characters").nullable(),password:u().min(6,"Password must be at least 6 characters").when("username",(s,d)=>s?d.required("Password is required when username is provided"):d),confirmPassword:u().oneOf([Z("password"),null],"Passwords must match"),gender:u().oneOf(["Male","Female"],"Invalid gender selection"),age:S().min(18,"Employee must be at least 18 years old").max(70,"Employee cannot be older than 70 years").nullable(),qualification:u().nullable(),designation:u().nullable(),salaryType:u().oneOf(["","Monthly","Weekly","Daily"],"Invalid salary type"),salary:S().min(0,"Salary cannot be negative").nullable().transform(s=>isNaN(s)?void 0:s),bloodGroup:u().oneOf(["","A+","A-","B+","B-","AB+","AB-","O+","O-"],"Invalid blood group"),role:u().required("Role is required"),endingDate:u().required("Ending date is required"),openingBalance:S().min(0,"Opening balance cannot be negative").nullable().transform(s=>isNaN(s)?void 0:s),address:u().nullable(),description:u().nullable(),status:u().oneOf(["Enable","Disable"],"Invalid status"),profileImage:F().test("fileSize","File too large",s=>!s||s&&s.size<=5*1024*1024).test("fileType","Unsupported file format",s=>!s||s&&["image/jpeg","image/png","image/gif"].includes(s.type)),idCard:F().test("fileSize","File too large",s=>!s||s&&s.size<=10*1024*1024),document:F().test("fileSize","File too large",s=>!s||s&&s.size<=10*1024*1024)});function q({employee:s=null,onSuccess:d}){const{roles:g}=X(),{data:l,setData:v,errors:w}=R({name:(s==null?void 0:s.name)||"",email:(s==null?void 0:s.email)||"",phone:(s==null?void 0:s.phone)||"",username:(s==null?void 0:s.username)||"",password:"",confirmPassword:"",gender:(s==null?void 0:s.gender)||"Male",age:(s==null?void 0:s.age)||"",qualification:(s==null?void 0:s.qualification)||"",designation:(s==null?void 0:s.designation)||"",salaryType:(s==null?void 0:s.salaryType)||"",salary:(s==null?void 0:s.salary)||"",bloodGroup:(s==null?void 0:s.bloodGroup)||"",role:(s==null?void 0:s.role)||"",endingDate:(s==null?void 0:s.endingDate)||"16/08/2026",openingBalance:(s==null?void 0:s.openingBalance)||"0",address:(s==null?void 0:s.address)||"",description:(s==null?void 0:s.description)||"",status:(s==null?void 0:s.status)||"Enable",profileImage:null,idCard:null,document:null,_method:s?"PUT":"POST"}),[x,b]=o.useState(!1),[C,N]=o.useState({}),[G,L]=o.useState({}),r=o.useCallback(m=>{const{name:p}=m.target;L(j=>({...j,[p]:!0}))},[]),t=o.useCallback(m=>{const{name:p,value:j,type:y,files:f}=m.target;let I=j;["age","salary","openingBalance"].includes(p)&&(I=j===""?"":Number(j)),v(p,y==="file"?f[0]:I),C[p]&&N(E=>({...E,[p]:""}))},[v,C]),k=o.useCallback(async()=>{try{return await se.validate(l,{abortEarly:!1}),N({}),!0}catch(m){const p={};return m.inner.forEach(j=>{p[j.path]=j.message}),N(p),!1}},[l]);o.useEffect(()=>{Object.keys(G).length>0&&k()},[l,G,k]);const M=async m=>{var j,y;if(m.preventDefault(),L(Object.keys(l).reduce((f,I)=>({...f,[I]:!0}),{})),!await k()){B.error("Please fix the validation errors");return}b(!0);try{const f=new FormData;Object.keys(l).forEach(D=>{l[D]!==null&&l[D]!==void 0&&f.append(D,l[D])});const I=s?route("employee.update",s.id):route("employee.store"),E=await z.post(I,f,{headers:{"Content-Type":"multipart/form-data"}});E.data.success&&(B.success(E.data.message),reset(),d&&d())}catch(f){B.error(((y=(j=f.response)==null?void 0:j.data)==null?void 0:y.message)||"An error occurred while creating the employee"),console.error("Employee creation error:",f)}finally{b(!1)}},U=o.useCallback(()=>{d?d():O.visit(route("employee.index"))},[d]),i={size:"sm",className:"rounded-0 border-secondary"},h=m=>C[m]||w[m],c=m=>G[m]&&!!h(m);return e.jsx(a,{id:"userForm",onSubmit:M,encType:"multipart/form-data",children:e.jsxs(T,{className:"border-0 rounded-0 shadow-sm",children:[e.jsxs(T.Header,{className:"d-flex justify-content-between align-items-center bg-transparent",children:[e.jsx("h6",{className:"mb-0 fw-semibold",children:s?"Update Employee":"New Employee"}),e.jsxs(Y,{className:"gap-2",children:[e.jsx(A,{variant:"outline-secondary",size:"sm",className:"rounded-0",onClick:U,disabled:x,children:"Cancel"}),e.jsx(A,{variant:"primary",size:"sm",className:"rounded-0",type:"submit",disabled:x,children:x?"Processing...":"Save"})]})]}),e.jsx(T.Body,{children:e.jsxs(J,{children:[e.jsx(n,{md:12,children:e.jsx("h6",{className:"mb-2 fw-semibold bg-light p-1 text-muted",children:"Personal Information"})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"name",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Name*"}),e.jsx(a.Control,{...i,type:"text",name:"name",value:l.name,onChange:t,onBlur:r,placeholder:"John Doe",required:!0,isInvalid:c("name")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:h("name")})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"email",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Email"}),e.jsx(a.Control,{...i,type:"email",name:"email",value:l.email,onChange:t,onBlur:r,placeholder:"john.doe@example.com",isInvalid:c("email")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:h("email")})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"phone",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Phone*"}),e.jsx(a.Control,{...i,type:"tel",name:"phone",value:l.phone,onChange:t,onBlur:r,placeholder:"+1-555-0123",required:!0,isInvalid:c("phone")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:h("phone")})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"username",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Username"}),e.jsx(a.Control,{...i,type:"text",name:"username",value:l.username,onChange:t,onBlur:r,placeholder:"johndoe123",isInvalid:c("username")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:h("username")})]})}),l.username&&e.jsxs(e.Fragment,{children:[e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"password",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Password"}),e.jsx(a.Control,{...i,type:"password",name:"password",value:l.password,onChange:t,onBlur:r,placeholder:"••••••",isInvalid:c("password")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:h("password")})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"confirmPassword",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Confirm Password"}),e.jsx(a.Control,{...i,type:"password",name:"confirmPassword",value:l.confirmPassword,onChange:t,onBlur:r,placeholder:"••••••",isInvalid:c("confirmPassword")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:h("confirmPassword")})]})})]}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"gender",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Gender"}),e.jsxs(a.Select,{...i,name:"gender",value:l.gender,onChange:t,onBlur:r,isInvalid:c("gender"),children:[e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"})]})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"age",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Age"}),e.jsx(a.Control,{...i,type:"number",name:"age",value:l.age,onChange:t,onBlur:r,placeholder:"30",min:"18",max:"70",isInvalid:c("age")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:h("age")})]})}),e.jsx(n,{md:12,className:"mt-3",children:e.jsx("h6",{className:"mb-2 fw-semibold bg-light p-1 text-muted",children:"Professional Information"})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"qualification",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Qualification"}),e.jsx(a.Control,{...i,type:"text",name:"qualification",value:l.qualification,onChange:t,onBlur:r,placeholder:"Bachelor's Degree"})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"designation",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Designation"}),e.jsx(a.Control,{...i,type:"text",name:"designation",value:l.designation,onChange:t,onBlur:r,placeholder:"Software Engineer"})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"salaryType",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Salary Type"}),e.jsxs(a.Select,{...i,name:"salaryType",value:l.salaryType,onChange:t,onBlur:r,isInvalid:c("salaryType"),children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"Monthly",children:"Monthly"}),e.jsx("option",{value:"Weekly",children:"Weekly"}),e.jsx("option",{value:"Daily",children:"Daily"})]})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"salary",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Salary"}),e.jsx(a.Control,{...i,type:"number",name:"salary",value:l.salary,onChange:t,onBlur:r,placeholder:"50000",step:"0.01",min:"0",isInvalid:c("salary")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:h("salary")})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"bloodGroup",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Blood Group"}),e.jsxs(a.Select,{...i,name:"bloodGroup",value:l.bloodGroup,onChange:t,onBlur:r,isInvalid:c("bloodGroup"),children:[e.jsx("option",{value:"",children:"Select Blood Group"}),e.jsx("option",{value:"A+",children:"A+"}),e.jsx("option",{value:"A-",children:"A-"}),e.jsx("option",{value:"B+",children:"B+"}),e.jsx("option",{value:"B-",children:"B-"}),e.jsx("option",{value:"AB+",children:"AB+"}),e.jsx("option",{value:"AB-",children:"AB-"}),e.jsx("option",{value:"O+",children:"O+"}),e.jsx("option",{value:"O-",children:"O-"})]})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"role",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Role*"}),e.jsxs(a.Select,{...i,name:"role",value:l.role,onChange:t,onBlur:r,required:!0,isInvalid:c("role"),children:[e.jsx("option",{value:"",children:"Select Role"}),g==null?void 0:g.map(m=>e.jsx("option",{value:m.name,className:"text-capitalize",children:m.name},m.name))]}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:h("role")})]})}),e.jsx(n,{md:12,className:"mt-3",children:e.jsx("h6",{className:"mb-2 fw-semibold bg-light p-1 text-muted",children:"Additional Information"})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"endingDate",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Ending Date"}),e.jsx(a.Control,{...i,type:"date",name:"endingDate",value:l.endingDate,onChange:t,onBlur:r,isInvalid:c("endingDate")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:h("endingDate")})]})}),e.jsx(n,{md:2,className:"mb-2",children:e.jsxs(a.Group,{controlId:"openingBalance",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Opening Balance"}),e.jsx(a.Control,{...i,type:"number",name:"openingBalance",value:l.openingBalance,onChange:t,onBlur:r,placeholder:"0.00",step:"0.01",min:"0",isInvalid:c("openingBalance")}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:h("openingBalance")})]})}),e.jsx(n,{md:4,className:"mb-2",children:e.jsxs(a.Group,{controlId:"address",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Address"}),e.jsx(a.Control,{...i,as:"textarea",rows:1,name:"address",value:l.address,onChange:t,onBlur:r,placeholder:"123 Main St, City, State, ZIP Code"})]})}),e.jsx(n,{md:4,className:"mb-2",children:e.jsxs(a.Group,{controlId:"description",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Description"}),e.jsx(a.Control,{...i,as:"textarea",rows:1,name:"description",value:l.description,onChange:t,onBlur:r,placeholder:"Additional information about the employee"})]})}),e.jsx(n,{md:12,className:"mt-3",children:e.jsx("h6",{className:"mb-2 fw-semibold bg-light p-1 text-muted",children:"Status & Documents"})}),e.jsx(n,{md:3,className:"mb-2",children:e.jsxs(a.Group,{controlId:"profileImage",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Profile Image"}),e.jsx(a.Control,{...i,type:"file",name:"profileImage",onChange:t,onBlur:r,accept:"image/jpeg,image/png,image/gif",isInvalid:c("profileImage")}),e.jsx(a.Text,{className:"text-muted small",children:"Max 5MB (JPEG, PNG, GIF)"}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:h("profileImage")})]})}),e.jsx(n,{md:3,className:"mb-2",children:e.jsxs(a.Group,{controlId:"idCard",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"ID Card"}),e.jsx(a.Control,{...i,type:"file",name:"idCard",onChange:t,onBlur:r,isInvalid:c("idCard")}),e.jsx(a.Text,{className:"text-muted small",children:"Max 10MB"}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:h("idCard")})]})}),e.jsx(n,{md:3,className:"mb-2",children:e.jsxs(a.Group,{controlId:"document",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Document"}),e.jsx(a.Control,{...i,type:"file",name:"document",onChange:t,onBlur:r,isInvalid:c("document")}),e.jsx(a.Text,{className:"text-muted small",children:"Max 10MB"}),e.jsx(a.Control.Feedback,{type:"invalid",className:"small",children:h("document")})]})}),e.jsxs(n,{md:3,className:"mb-2",children:[e.jsx(a.Label,{className:"small fw-semibold",children:"Status"}),e.jsxs("div",{className:"border border-dark px-2",children:[e.jsx(a.Check,{inline:!0,type:"radio",label:"Enable",name:"status",id:"enable",value:"Enable",checked:l.status==="Enable",onChange:t,onBlur:r,className:"small"}),e.jsx(a.Check,{inline:!0,type:"radio",label:"Disable",name:"status",id:"disable",value:"Disable",checked:l.status==="Disable",onChange:t,onBlur:r,className:"small"})]})]})]})})]})})}function le({onEdit:s}){const d=o.useRef(!1),g=o.useRef(null),l=o.useCallback(()=>{if(d.current)return;$.fn.DataTable.isDataTable("#employeeTable")&&$("#employeeTable").DataTable().destroy();const x=$("#employeeTable").DataTable({processing:!0,serverSide:!0,ajax:{url:route("employee.index"),type:"GET"},columns:[{data:"DT_RowIndex",name:"DT_RowIndex",title:"No",className:"text-center",width:"1%",orderable:!1,searchable:!1},{data:"photo",title:"Photo",className:"text-center",width:"5%"},{data:"name",title:"Name",className:"text-start",width:"15%"},{data:"phone",title:"Phone",className:"text-start",width:"15%"},{data:"role",title:"Role",className:"text-start",width:"15%"},{data:"ending_date",title:"Ending Date",className:"text-start",width:"15%"},{data:"download_assets",title:"Download Assets",className:"text-start",width:"15%"},{data:"status",title:"Status",className:"text-center",width:"10%"},{data:"action",title:"Actions",className:"text-center",width:"10%",orderable:!1,searchable:!1}],drawCallback:function(){$(".edit-btn").off("click").on("click",function(){const b=$(this).data("id");v(b)}),$(".delete-btn").off("click").on("click",function(){$(this).data("id"),w()})},initComplete:function(){d.current=!0}});return g.current=x,x});o.useEffect(()=>(l(),()=>{$.fn.DataTable.isDataTable("#employeeTable")&&($("#employeeTable").DataTable().destroy(),d.current=!1)}),[l]);const v=async x=>{try{const b=await z.get(route("employee.edit",x));b.data.success===!0&&s(b.data.employee)}catch{B.error("An error occurred while fetching the employee data.")}},w=async x=>{try{B.success("Employee deleted successfully")}catch{B.error("An error occurred while fetching the employee data.")}};return e.jsxs(T,{className:"border-0 rounded-0 shadow-sm",children:[e.jsx(T.Header,{className:"d-flex justify-content-between align-items-center bg-transparent",children:e.jsx("h6",{className:"mb-0 fw-semibold",children:"Employee Management"})}),e.jsx(T.Body,{className:"px-0",children:e.jsx(ee,{size:"sm",bordered:!0,hover:!0,striped:!0,responsive:!0,id:"employeeTable"})})]})}function ve(){const[s,d]=o.useState("users"),[g,l]=o.useState(null),[v,w]=o.useState(!1),x=o.useCallback(N=>{d(N),N!=="user-update"&&(w(!1),l(null))},[]),b=o.useCallback(N=>{d("user-update"),w(!0),l(N)},[]),C=o.useCallback(()=>{d("users"),O.reload()},[]);return e.jsxs(H,{children:[e.jsx(_,{title:"User Management"}),e.jsxs(ae,{activeKey:s,onSelect:x,className:"users-tabs mb-3",id:"user-management-tabs",children:[e.jsx(P,{eventKey:"users",title:e.jsxs(e.Fragment,{children:[e.jsx(K,{size:16,className:"me-1"})," Users"]}),children:e.jsx(le,{onEdit:b,onSuccess:C})}),e.jsx(P,{eventKey:"new-user",title:e.jsxs(e.Fragment,{children:[e.jsx(V,{size:16,className:"me-1"})," New User"]}),children:e.jsx(q,{onSuccess:C})}),v&&e.jsx(P,{eventKey:"user-update",title:e.jsxs(e.Fragment,{children:[e.jsx(W,{size:16,className:"me-1"})," User Update"]}),disabled:!v,children:g?e.jsx(q,{employee:g,onSuccess:C,onCancel:()=>d("users")}):e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{children:"Please select a user to edit"})})})]})]})}export{ve as default};
