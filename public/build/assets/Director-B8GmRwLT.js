import{j as e,q as S,r as f,$ as k,Y as N}from"./app-V9r-X-AE.js";import{C as t}from"./Card-DEhYGpAN.js";import{E as T}from"./ErpLayout-nhBgb16w.js";import{R as b}from"./Footer-DzCvt54Q.js";import{C as d}from"./Form-BBQmeiIu.js";import{R,I as _,J as A,X as D,Y as B,K as O,M as L,N as y}from"./BarChart-CJu3mA2p.js";import{P}from"./ProgressBar-DhwL_0f2.js";import{B as H}from"./Badge-B_1fX0CU.js";import"./Image-Dv6K2MWK.js";/* empty css                      */import"./CloseButton-CxHVE5YY.js";const E=({title:c,amount:g,subtitle:o,icon:m,color:n})=>e.jsx(t,{className:`border-0 border-start border-5 border-${n} bg-${n} bg-opacity-10 shadow-sm h-100`,children:e.jsxs(t.Body,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"text-muted mb-2",children:c}),e.jsx("h3",{className:"mb-0",children:g}),e.jsx("small",{className:`text-${n}`,children:o})]}),e.jsx("div",{className:`rounded-circle bg-${n} bg-opacity-10 d-flex align-items-center justify-content-center`,style:{width:45,height:45,fontSize:35},children:m})]})}),Q=({dashboardData:c})=>{const{auth:g}=S().props,o=f.useRef(null),m=f.useRef(null),n=f.useRef(null),i=f.useRef({lowStock:!1,topSelling:!1,recentOrders:!1}),{statCards:w,additionalMetrics:p,recentOrders:j,revenueChart:C,summary:a,lowStockProducts:h=[],topSellingProducts:v=[]}=c;return f.useEffect(()=>(o.current&&!i.current.lowStock&&($(o.current).DataTable({data:h||[],columns:[{data:"name",title:"Product",className:"text-start",render:function(s,r,l){return s?`
                                <div class="d-flex align-items-center">
                                    <div class="avatar-sm bg-light rounded me-2">
                                        <img src="${l.image||"/images/default-product.jpg"}" 
                                             alt="${l.name}" 
                                             class="img-fluid rounded"
                                             style="width: 40px; height: 40px; object-fit: cover;"
                                             onerror="this.src='/images/default-product.jpg'">
                                    </div>
                                    <div>
                                        <h6 class="mb-0">${l.name||"-"}</h6>
                                        <small class="text-muted">${l.category||"Uncategorized"}</small>
                                    </div>
                                </div>
                            `:'<div class="text-center text-muted">-</div>'}},{data:"sku",title:"SKU",className:"text-start",defaultContent:"-"},{data:"total_quantity",title:"Current Stock",className:"text-center",defaultContent:"-",render:function(s,r,l){return s==null?"-":`<span class="${s<=(l.low_stock_alert||0)?"text-danger fw-bold":"text-warning"}">${s}</span>`}},{data:"low_stock_alert",title:"Alert Level",className:"text-center",defaultContent:"-"},{data:"total_quantity",title:"Status",className:"text-center",defaultContent:"-",render:function(s,r,l){if(s==null)return'<span class="badge bg-secondary">N/A</span>';let u="success",x="In Stock";return s<=0?(u="danger",x="Out of Stock"):s<=(l.low_stock_alert||0)&&(u="warning",x="Low Stock"),`<span class="badge bg-${u}">${x}</span>`}}],responsive:!0,searching:!1,paging:!1,info:!1,lengthChange:!1,order:[[2,"asc"]],language:{emptyTable:'<div class="text-center py-5"><i class="bi bi-check-circle display-4 text-success"></i><p class="mt-2">All products are well stocked</p></div>'},dom:'<"row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6"f>>tip',initComplete:function(){$(this).addClass("table-striped table-hover")},drawCallback:function(s){s.fnRecordsTotal()===0&&$(this).find("tbody").html('<tr><td colspan="5" class="text-center py-4"><i class="bi bi-check-circle display-4 text-success"></i><p class="mt-2">All products are well stocked</p></td></tr>')}}),i.current.lowStock=!0),m.current&&!i.current.topSelling&&($(m.current).DataTable({data:v||[],columns:[{data:"name",title:"Product",className:"text-start",render:function(s,r,l){return s?`
                                <div class="d-flex align-items-center">
                                    <div class="avatar-sm bg-light rounded me-2">
                                        <img src="${l.image||"/images/default-product.jpg"}" 
                                             alt="${l.name}" 
                                             class="img-fluid rounded"
                                             style="width: 40px; height: 40px; object-fit: cover;"
                                             onerror="this.src='/images/default-product.jpg'">
                                    </div>
                                    <div>
                                        <h6 class="mb-0">${l.name||"-"}</h6>
                                        <small class="text-muted">${l.category||"Uncategorized"}</small>
                                    </div>
                                </div>
                            `:'<div class="text-center text-muted">-</div>'}},{data:"sales_count",title:"Sales",className:"text-center",defaultContent:"-",render:function(s,r,l){return s==null?"-":`
                                <div>
                                    <span class="fw-bold">${s}</span>
                                    <br>
                                    <small class="text-muted">units sold</small>
                                </div>
                            `}},{data:"revenue",title:"Revenue",className:"text-end",defaultContent:"-",render:function(s){return s==null?"-":`<span class="fw-bold text-success">$${Number(s).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}</span>`}},{data:"total_quantity",title:"Stock",className:"text-center",defaultContent:"-",render:function(s,r,l){return s==null?"-":`<span class="fw-bold ${s<=(l.low_stock_alert||0)?"text-danger":""}">${s}</span>`}},{data:"is_active",title:"Status",className:"text-center",defaultContent:"-",render:function(s){return s==null?'<span class="badge bg-secondary">N/A</span>':`<span class="badge bg-${s?"success":"secondary"}">${s?"Active":"Inactive"}</span>`}}],responsive:!0,searching:!1,paging:!1,info:!1,lengthChange:!1,order:[[2,"asc"]],language:{emptyTable:'<div class="text-center py-5"><i class="bi bi-graph-up display-4 text-muted"></i><p class="mt-2">No sales data available</p></div>'},dom:'<"row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6"f>>tip',initComplete:function(){$(this).addClass("table-striped table-hover")},drawCallback:function(s){s.fnRecordsTotal()===0&&$(this).find("tbody").html('<tr><td colspan="5" class="text-center py-4"><i class="bi bi-graph-up display-4 text-muted"></i><p class="mt-2">No sales data available</p></td></tr>')}}),i.current.topSelling=!0),n.current&&!i.current.recentOrders&&($(n.current).DataTable({data:j||[],columns:[{data:"order_number",title:"Order #",className:"text-start",defaultContent:"-",render:function(s){return s?`<a href="${route("erp.orders.show",s)||"#"}" class="text-decoration-none fw-bold">${s}</a>`:"-"}},{data:"customer_name",title:"Customer",className:"text-start",defaultContent:"-"},{data:"total",title:"Amount",className:"text-end",defaultContent:"-",render:function(s){return s==null?"-":`<span class="fw-bold">$${Number(s).toFixed(2)}</span>`}},{data:"status",title:"Status",className:"text-center",defaultContent:"-",render:function(s){return s?`<span class="badge bg-${{pending:"warning",processing:"info",completed:"success",cancelled:"danger",refunded:"secondary"}[s]||"secondary"}">${s}</span>`:'<span class="badge bg-secondary">-</span>'}},{data:"payment_status",title:"Payment",className:"text-center",defaultContent:"-",render:function(s){return s?`<span class="badge bg-${{pending:"warning",paid:"success",partially_paid:"info",failed:"danger",refunded:"secondary"}[s]||"secondary"}">${s}</span>`:'<span class="badge bg-secondary">-</span>'}},{data:"created_at",title:"Date",className:"text-center",defaultContent:"-"},{data:"order_number",title:"Actions",className:"text-center",orderable:!1,searchable:!1,defaultContent:"-",render:function(s){return s?`
                                <a href="${route("erp.orders.show",s)||"#"}" 
                                   class="btn btn-sm btn-outline-primary">
                                    View
                                </a>
                            `:"-"}}],responsive:!0,searching:!1,paging:!1,info:!1,lengthChange:!1,order:[[5,"asc"]],language:{emptyTable:'<div class="text-center py-5"><i class="bi bi-receipt display-4 text-muted"></i><p class="mt-2">No orders found</p></div>'},dom:'<"row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6"f>>tip',initComplete:function(){$(this).addClass("table-striped table-hover")},drawCallback:function(s){s.fnRecordsTotal()===0&&$(this).find("tbody").html('<tr><td colspan="7" class="text-center py-4"><i class="bi bi-receipt display-4 text-muted"></i><p class="mt-2">No orders found</p></td></tr>')}}),i.current.recentOrders=!0),()=>{[o,m,n].forEach(s=>{s.current&&$.fn.DataTable.isDataTable(s.current)&&$(s.current).DataTable().destroy(!0)}),i.current={lowStock:!1,topSelling:!1,recentOrders:!1}}),[h,v,j]),e.jsxs(T,{children:[e.jsx(k,{title:"Director Dashboard"}),e.jsx(b,{className:"mb-3 g-3",children:w.map((s,r)=>e.jsx(d,{lg:3,md:6,children:e.jsx(E,{...s})},r))}),e.jsx(b,{className:"mb-3 g-3",children:p==null?void 0:p.map((s,r)=>e.jsx(d,{lg:3,md:6,children:e.jsx(t,{className:"h-100 shadow-sm border-0",children:e.jsxs(t.Body,{className:"d-flex align-items-center",children:[e.jsx("div",{className:"flex-shrink-0 me-3 fs-2",children:s.icon}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx(t.Title,{as:"h6",className:"text-muted mb-1",children:s.title}),e.jsx(t.Text,{as:"h4",className:"mb-0",children:s.value})]})]})})},r))}),e.jsxs(b,{className:"mb-3 g-3",children:[e.jsx(d,{lg:8,md:12,children:e.jsxs(t,{className:"shadow-sm border-0 h-100",children:[e.jsx(t.Header,{className:"bg-white border-0",children:e.jsx(t.Title,{as:"h5",className:"mb-0",children:"Revenue Overview (Last 6 Months)"})}),e.jsx(t.Body,{children:e.jsx("div",{style:{width:"100%",height:300},children:e.jsx(R,{children:e.jsxs(_,{data:C,children:[e.jsx(A,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(D,{dataKey:"month"}),e.jsx(B,{}),e.jsx(O,{formatter:s=>[`$${Number(s).toLocaleString()}`,"Amount"],labelFormatter:s=>`Month: ${s}`}),e.jsx(L,{}),e.jsx(y,{dataKey:"sales",name:"Sales Revenue",fill:"#8884d8"}),e.jsx(y,{dataKey:"repairs",name:"Repair Revenue",fill:"#82ca9d"})]})})})})]})}),e.jsx(d,{lg:4,md:12,children:e.jsxs(t,{className:"shadow-sm border-0 h-100",children:[e.jsx(t.Header,{className:"bg-white border-0",children:e.jsx(t.Title,{as:"h5",className:"mb-0",children:"Business Summary"})}),e.jsxs(t.Body,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"text-muted mb-2",children:"Total Revenue"}),e.jsx("h3",{className:"text-success",children:a==null?void 0:a.totalRevenue})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"text-muted mb-2",children:"Average Order Value"}),e.jsxs("h4",{children:["$",a==null?void 0:a.averageOrderValue]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"text-muted mb-2",children:"Active Customers"}),e.jsx("h4",{children:a==null?void 0:a.customerCount})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{className:"text-muted mb-2",children:"Stock Health"}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"flex-grow-1 me-3",children:e.jsx(P,{now:(a==null?void 0:a.stockHealth)||0,label:`${(a==null?void 0:a.stockHealth)||0}%`,variant:K((a==null?void 0:a.stockHealth)||0)})}),e.jsxs("small",{className:"text-muted",children:[(a==null?void 0:a.lowStockCount)||0," low stock"]})]})]})]})]})})]}),e.jsxs(b,{className:"mb-3 g-3",children:[e.jsx(d,{lg:6,md:12,children:e.jsxs(t,{className:"shadow-sm border-0 h-100",children:[e.jsxs(t.Header,{className:"bg-white border-0 d-flex justify-content-between align-items-center",children:[e.jsxs(t.Title,{as:"h5",className:"mb-0",children:["Low Stock Products",e.jsx(H,{bg:"danger",className:"ms-2",children:(h==null?void 0:h.length)||0})]}),e.jsx(N,{href:route("product.index"),className:"btn btn-sm btn-outline-primary",children:"Manage Products"})]}),e.jsx(t.Body,{children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{ref:o,className:"table table-hover mb-0",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{children:"SKU"}),e.jsx("th",{children:"Current Stock"}),e.jsx("th",{children:"Alert Level"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{})]})})})]})}),e.jsx(d,{lg:6,md:12,children:e.jsxs(t,{className:"shadow-sm border-0 h-100",children:[e.jsx(t.Header,{className:"bg-white border-0",children:e.jsx(t.Title,{as:"h5",className:"mb-0",children:"Top Selling Products"})}),e.jsx(t.Body,{children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{ref:m,className:"table table-hover mb-0",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Sales"}),e.jsx("th",{children:"Revenue"}),e.jsx("th",{children:"Stock"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{})]})})})]})})]}),e.jsx(b,{className:"mb-3 g-3",children:e.jsx(d,{lg:12,children:e.jsxs(t,{className:"shadow-sm border-0",children:[e.jsxs(t.Header,{className:"bg-white border-0 d-flex justify-content-between align-items-center",children:[e.jsx(t.Title,{as:"h5",className:"mb-0",children:"Recent Orders"}),e.jsx(N,{href:route("sales.index"),className:"btn btn-sm btn-outline-primary",children:"View All"})]}),e.jsx(t.Body,{children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{ref:n,className:"table table-hover mb-0",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Order #"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Payment"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{})]})})})]})})})]})},K=c=>c>=80?"success":c>=60?"info":c>=40?"warning":"danger";export{Q as default};
