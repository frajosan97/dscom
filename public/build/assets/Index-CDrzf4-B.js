import{r as o,m as u,j as e,$ as j,Y as m}from"./app-DCWOQcEB.js";import{y as l}from"./Footer-BFclObC5.js";import{a as p}from"./helpers-DfyTVTVS.js";import{t as y,u as N}from"./index-eKalaMO-.js";import{E as v}from"./ErpLayout-BGMVtiLM.js";import{C as i}from"./Card-DPWBKIrz.js";import{B as _}from"./ButtonGroup-54EaPK8M.js";import{B as h}from"./Image-DQmrh284.js";import{T as w}from"./Table-BBH_MeAL.js";import"./CloseButton-1IPjPb9C.js";import"./Form-Dvgdn8VD.js";import"./iconBase-DX_qyhUT.js";/* empty css                      */function L(){const c=o.useRef(null),f=o.useCallback(()=>{c.current&&$.fn.DataTable.isDataTable("#productsTable")&&(c.current.destroy(),c.current=null);const n=$("#productsTable").DataTable({processing:!0,serverSide:!0,ajax:{url:route("product.index"),type:"GET",error:t=>{var r;l.error(((r=t.responseJSON)==null?void 0:r.message)||"Failed to load products")}},columns:[{data:"product_image",name:"product_image",title:"Image",orderable:!1,searchable:!1,width:"80px"},{data:"product_name",name:"product_name",title:"Product",className:"align-middle"},{data:"category.name",name:"category.name",title:"Category",className:"align-middle"},{data:"total_quantity",name:"total_quantity",title:"Stock",className:"text-center align-middle",render:function(t,r,s){if(!s.track_quantity)return'<span class="badge bg-info">N/A</span>';const a=parseInt(t)||0,g=s.low_stock_alert||0;let d="bg-success";return a===0?d="bg-danger":a<=g&&(d="bg-warning"),`
                            <span class="badge ${d}">
                                ${a} ${s.allow_backorders&&a===0?"(Backorder)":""}
                            </span>
                        `}},{data:"cost_per_item",name:"cost_per_item",title:"Cost",className:"text-end align-middle",render:function(t){return p(t||0)}},{data:"base_price",name:"base_price",title:"Price",className:"text-end align-middle",render:function(t,r,s){const a=p(t||0);return s.compare_price&&s.compare_price>t?`
                                <div>
                                    <div class="text-decoration-line-through text-muted small">
                                        ${p(s.compare_price)}
                                    </div>
                                    <div class="fw-semibold text-danger">
                                        ${a}
                                    </div>
                                </div>
                            `:a}},{data:"status_badge",name:"is_active",title:"Status",className:"text-center align-middle",orderable:!1,searchable:!1},{data:"action",name:"action",title:"Actions",className:"text-center align-middle",orderable:!1,searchable:!1,width:"100px"}],order:[[1,"asc"]],pageLength:25,lengthMenu:[[10,25,50,100,-1],[10,25,50,100,"All"]],responsive:!0,drawCallback:function(t){x()},initComplete:function(){this.api().columns(2).every(function(){const t=this,r=$('<select class="form-control form-control-sm"><option value="">All Categories</option></select>').appendTo($(t.header()).empty()).on("change",function(){const a=$.fn.dataTable.util.escapeRegex($(this).val());t.search(a?"^"+a+"$":"",!0,!1).draw()}),s=new Set;t.data().each(function(a){a&&s.add(a)}),Array.from(s).sort().forEach(function(a){r.append('<option value="'+a+'">'+a+"</option>")})})}});return c.current=n,n},[]),x=o.useCallback(()=>{$(".edit-btn").off("click").on("click",function(n){n.preventDefault();const t=$(this).data("id");t&&u.get(route("product.edit",t))}),$(".toggle-status-btn").off("click").on("click",function(n){n.preventDefault();const t=$(this).data("id"),r=$(this).data("status");confirm(`Are you sure you want to ${r?"deactivate":"activate"} this product?`)&&u.patch(route("product.toggle-status",t),{onSuccess:()=>{var a;l.success("Product status updated successfully"),(a=c.current)==null||a.ajax.reload()},onError:a=>{l.error(a.message||"Failed to update status")}})}),$(".delete-btn").off("click").on("click",function(n){n.preventDefault();const t=$(this).data("id");confirm("Are you sure you want to delete this product? This action cannot be undone.")&&u.delete(route("product.destroy",t),{onSuccess:()=>{var s;l.success("Product deleted successfully"),(s=c.current)==null||s.ajax.reload()},onError:s=>{l.error(s.message||"Failed to delete product")}})})},[]),b=o.useCallback(()=>{if(c.current){const n=c.current.ajax.params(),t=new URL(route("product.index"));Object.keys(n).forEach(r=>{r!=="draw"&&r!=="_"&&t.searchParams.append(r,n[r])}),t.searchParams.append("export","excel"),window.open(t.toString(),"_blank")}},[]);return o.useEffect(()=>(f(),()=>{c.current&&$.fn.DataTable.isDataTable("#productsTable")&&c.current.destroy()}),[f]),e.jsxs(v,{children:[e.jsx(j,{title:"Products"}),e.jsxs(i,{className:"border-0 rounded-0 shadow-sm",children:[e.jsxs(i.Header,{className:"d-flex justify-content-between align-items-center bg-transparent py-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-0 fw-semibold",children:"Products Management"}),e.jsx("small",{className:"text-muted",children:"Manage your product inventory and listings"})]}),e.jsxs(_,{className:"gap-2",children:[e.jsxs(h,{variant:"outline-primary",size:"sm",className:"rounded-0 d-flex align-items-center",onClick:b,children:[e.jsx(y,{className:"me-2"}),"Export Excel"]}),e.jsxs(h,{variant:"success",size:"sm",className:"rounded-0 d-flex align-items-center",as:m,href:route("product.create"),children:[e.jsx(N,{className:"me-2"}),"Add New Product"]})]})]}),e.jsx(i.Body,{className:"p-0",children:e.jsx("div",{className:"table-responsive",children:e.jsxs(w,{id:"productsTable",className:"table-striped table-hover mb-0",style:{width:"100%"},children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Stock"}),e.jsx("th",{className:"text-end",children:"Cost"}),e.jsx("th",{className:"text-end",children:"Price"}),e.jsx("th",{className:"text-center",children:"Status"}),e.jsx("th",{className:"text-center",children:"Actions"})]})}),e.jsx("tbody",{})]})})}),e.jsx(i.Footer,{className:"bg-transparent py-3",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("small",{className:"text-muted",children:["Showing page"," ",e.jsx("strong",{className:"text-primary",children:"1"})," of records"]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("small",{className:"text-muted me-2",children:"Quick Actions:"}),e.jsx(m,{className:"btn btn-outline-secondary btn-sm rounded-0",children:"Bulk Import"}),e.jsx(m,{className:"btn btn-outline-secondary btn-sm rounded-0",children:"Reorder Products"})]})]})})]})]})}export{L as default};
