import{q as T,r as h,j as e,$ as k,Y as N}from"./app-Bt_zyVoS.js";import{D as R}from"./DashboardStatsCard-DnLkpCnY.js";import{E as A}from"./ErpLayout-B7lFZRNn.js";import{R as u}from"./Footer-BE8-uFgA.js";import{C as c}from"./Form-DzhKJdGd.js";import{C as t}from"./Card-BHcq6w0A.js";import{g as _,B as g,f as D,R as B,T as O,L}from"./generateCategoricalChart-B070h40I.js";import{X as C,Y as y,C as P}from"./YAxis-D9Y3AyqP.js";import{P as H}from"./ProgressBar-DiunDLrb.js";import{B as E}from"./Badge-CwAdwHWS.js";/* empty css                      */import"./Image-DTP6OkpU.js";import"./CloseButton-hrm_xX80.js";var K=_({chartName:"BarChart",GraphicalChild:g,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:C},{axisType:"yAxis",AxisComp:y}],formatAxisMap:D});const se=({dashboardData:i})=>{const{auth:q}=T().props,x=h.useRef(null),f=h.useRef(null),p=h.useRef(null),n=h.useRef({lowStock:!1,topSelling:!1,recentOrders:!1}),{statCards:w,additionalMetrics:b,recentOrders:j,revenueChart:S,summary:a,lowStockProducts:d=[],topSellingProducts:v=[]}=i;return h.useEffect(()=>(x.current&&!n.current.lowStock&&($(x.current).DataTable({data:d||[],columns:[{data:"name",title:"Product",className:"text-start",render:function(s,r,l){return s?`
                                <div class="d-flex align-items-center">
                                    <div class="avatar-sm bg-light rounded me-2">
                                        <img src="${l.image||"/images/default-product.jpg"}" 
                                             alt="${l.name}" 
                                             class="img-fluid rounded"
                                             style="width: 40px; height: 40px; object-fit: cover;"
                                             onerror="this.src='/images/default-product.jpg'">
                                    </div>
                                    <div>
                                        <h6 class="mb-0">${l.name||"-"}</h6>
                                        <small class="text-muted">${l.category||"Uncategorized"}</small>
                                    </div>
                                </div>
                            `:'<div class="text-center text-muted">-</div>'}},{data:"sku",title:"SKU",className:"text-start",defaultContent:"-"},{data:"total_quantity",title:"Current Stock",className:"text-center",defaultContent:"-",render:function(s,r,l){return s==null?"-":`<span class="${s<=(l.low_stock_alert||0)?"text-danger fw-bold":"text-warning"}">${s}</span>`}},{data:"low_stock_alert",title:"Alert Level",className:"text-center",defaultContent:"-"},{data:"total_quantity",title:"Status",className:"text-center",defaultContent:"-",render:function(s,r,l){if(s==null)return'<span class="badge bg-secondary">N/A</span>';let o="success",m="In Stock";return s<=0?(o="danger",m="Out of Stock"):s<=(l.low_stock_alert||0)&&(o="warning",m="Low Stock"),`<span class="badge bg-${o}">${m}</span>`}}],responsive:!0,searching:!1,paging:!1,info:!1,lengthChange:!1,order:[[2,"asc"]],language:{emptyTable:'<div class="text-center py-5"><i class="bi bi-check-circle display-4 text-success"></i><p class="mt-2">All products are well stocked</p></div>'},dom:'<"row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6"f>>tip',initComplete:function(){$(this).addClass("table-striped table-hover")},drawCallback:function(s){s.fnRecordsTotal()===0&&$(this).find("tbody").html('<tr><td colspan="5" class="text-center py-4"><i class="bi bi-check-circle display-4 text-success"></i><p class="mt-2">All products are well stocked</p></td></tr>')}}),n.current.lowStock=!0),f.current&&!n.current.topSelling&&($(f.current).DataTable({data:v||[],columns:[{data:"name",title:"Product",className:"text-start",render:function(s,r,l){return s?`
                                <div class="d-flex align-items-center">
                                    <div class="avatar-sm bg-light rounded me-2">
                                        <img src="${l.image||"/images/default-product.jpg"}" 
                                             alt="${l.name}" 
                                             class="img-fluid rounded"
                                             style="width: 40px; height: 40px; object-fit: cover;"
                                             onerror="this.src='/images/default-product.jpg'">
                                    </div>
                                    <div>
                                        <h6 class="mb-0">${l.name||"-"}</h6>
                                        <small class="text-muted">${l.category||"Uncategorized"}</small>
                                    </div>
                                </div>
                            `:'<div class="text-center text-muted">-</div>'}},{data:"sales_count",title:"Sales",className:"text-center",defaultContent:"-",render:function(s,r,l){return s==null?"-":`
                                <div>
                                    <span class="fw-bold">${s}</span>
                                    <br>
                                    <small class="text-muted">units sold</small>
                                </div>
                            `}},{data:"revenue",title:"Revenue",className:"text-end",defaultContent:"-",render:function(s){return s==null?"-":`<span class="fw-bold text-success">$${Number(s).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}</span>`}},{data:"total_quantity",title:"Stock",className:"text-center",defaultContent:"-",render:function(s,r,l){return s==null?"-":`<span class="fw-bold ${s<=(l.low_stock_alert||0)?"text-danger":""}">${s}</span>`}},{data:"is_active",title:"Status",className:"text-center",defaultContent:"-",render:function(s){return s==null?'<span class="badge bg-secondary">N/A</span>':`<span class="badge bg-${s?"success":"secondary"}">${s?"Active":"Inactive"}</span>`}}],responsive:!0,searching:!1,paging:!1,info:!1,lengthChange:!1,order:[[2,"asc"]],language:{emptyTable:'<div class="text-center py-5"><i class="bi bi-graph-up display-4 text-muted"></i><p class="mt-2">No sales data available</p></div>'},dom:'<"row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6"f>>tip',initComplete:function(){$(this).addClass("table-striped table-hover")},drawCallback:function(s){s.fnRecordsTotal()===0&&$(this).find("tbody").html('<tr><td colspan="5" class="text-center py-4"><i class="bi bi-graph-up display-4 text-muted"></i><p class="mt-2">No sales data available</p></td></tr>')}}),n.current.topSelling=!0),p.current&&!n.current.recentOrders&&($(p.current).DataTable({data:j||[],columns:[{data:"order_number",title:"Order #",className:"text-start",defaultContent:"-",render:function(s){return s?`<a href="${route("erp.orders.show",s)||"#"}" class="text-decoration-none fw-bold">${s}</a>`:"-"}},{data:"customer_name",title:"Customer",className:"text-start",defaultContent:"-"},{data:"total",title:"Amount",className:"text-end",defaultContent:"-",render:function(s){return s==null?"-":`<span class="fw-bold">$${Number(s).toFixed(2)}</span>`}},{data:"status",title:"Status",className:"text-center",defaultContent:"-",render:function(s){return s?`<span class="badge bg-${{pending:"warning",processing:"info",completed:"success",cancelled:"danger",refunded:"secondary"}[s]||"secondary"}">${s}</span>`:'<span class="badge bg-secondary">-</span>'}},{data:"payment_status",title:"Payment",className:"text-center",defaultContent:"-",render:function(s){return s?`<span class="badge bg-${{pending:"warning",paid:"success",partially_paid:"info",failed:"danger",refunded:"secondary"}[s]||"secondary"}">${s}</span>`:'<span class="badge bg-secondary">-</span>'}},{data:"created_at",title:"Date",className:"text-center",defaultContent:"-"},{data:"order_number",title:"Actions",className:"text-center",orderable:!1,searchable:!1,defaultContent:"-",render:function(s){return s?`
                                <a href="${route("erp.orders.show",s)||"#"}" 
                                   class="btn btn-sm btn-outline-primary">
                                    View
                                </a>
                            `:"-"}}],responsive:!0,searching:!1,paging:!1,info:!1,lengthChange:!1,order:[[5,"asc"]],language:{emptyTable:'<div class="text-center py-5"><i class="bi bi-receipt display-4 text-muted"></i><p class="mt-2">No orders found</p></div>'},dom:'<"row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6"f>>tip',initComplete:function(){$(this).addClass("table-striped table-hover")},drawCallback:function(s){s.fnRecordsTotal()===0&&$(this).find("tbody").html('<tr><td colspan="7" class="text-center py-4"><i class="bi bi-receipt display-4 text-muted"></i><p class="mt-2">No orders found</p></td></tr>')}}),n.current.recentOrders=!0),()=>{[x,f,p].forEach(s=>{s.current&&$.fn.DataTable.isDataTable(s.current)&&$(s.current).DataTable().destroy(!0)}),n.current={lowStock:!1,topSelling:!1,recentOrders:!1}}),[d,v,j]),e.jsxs(A,{children:[e.jsx(k,{title:"Director Dashboard"}),e.jsx(u,{className:"mb-3 g-3",children:w.map((s,r)=>e.jsx(c,{lg:3,md:6,children:e.jsx(R,{...s})},r))}),e.jsx(u,{className:"mb-3 g-3",children:b==null?void 0:b.map((s,r)=>e.jsx(c,{lg:3,md:6,children:e.jsx(t,{className:"h-100 shadow-sm border-0",children:e.jsxs(t.Body,{className:"d-flex align-items-center",children:[e.jsx("div",{className:"flex-shrink-0 me-3 fs-2",children:s.icon}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx(t.Title,{as:"h6",className:"text-muted mb-1",children:s.title}),e.jsx(t.Text,{as:"h4",className:"mb-0",children:s.value})]})]})})},r))}),e.jsxs(u,{className:"mb-3 g-3",children:[e.jsx(c,{lg:8,md:12,children:e.jsxs(t,{className:"shadow-sm border-0 h-100",children:[e.jsx(t.Header,{className:"bg-white border-0",children:e.jsx(t.Title,{as:"h5",className:"mb-0",children:"Revenue Overview (Last 6 Months)"})}),e.jsx(t.Body,{children:e.jsx("div",{style:{width:"100%",height:300},children:e.jsx(B,{children:e.jsxs(K,{data:S,children:[e.jsx(P,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(C,{dataKey:"month"}),e.jsx(y,{}),e.jsx(O,{formatter:s=>[`$${Number(s).toLocaleString()}`,"Amount"],labelFormatter:s=>`Month: ${s}`}),e.jsx(L,{}),e.jsx(g,{dataKey:"sales",name:"Sales Revenue",fill:"#8884d8"}),e.jsx(g,{dataKey:"repairs",name:"Repair Revenue",fill:"#82ca9d"})]})})})})]})}),e.jsx(c,{lg:4,md:12,children:e.jsxs(t,{className:"shadow-sm border-0 h-100",children:[e.jsx(t.Header,{className:"bg-white border-0",children:e.jsx(t.Title,{as:"h5",className:"mb-0",children:"Business Summary"})}),e.jsxs(t.Body,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"text-muted mb-2",children:"Total Revenue"}),e.jsx("h3",{className:"text-success",children:a==null?void 0:a.totalRevenue})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"text-muted mb-2",children:"Average Order Value"}),e.jsxs("h4",{children:["$",a==null?void 0:a.averageOrderValue]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"text-muted mb-2",children:"Active Customers"}),e.jsx("h4",{children:a==null?void 0:a.customerCount})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{className:"text-muted mb-2",children:"Stock Health"}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"flex-grow-1 me-3",children:e.jsx(H,{now:(a==null?void 0:a.stockHealth)||0,label:`${(a==null?void 0:a.stockHealth)||0}%`,variant:U((a==null?void 0:a.stockHealth)||0)})}),e.jsxs("small",{className:"text-muted",children:[(a==null?void 0:a.lowStockCount)||0," low stock"]})]})]})]})]})})]}),e.jsxs(u,{className:"mb-3 g-3",children:[e.jsx(c,{lg:6,md:12,children:e.jsxs(t,{className:"shadow-sm border-0 h-100",children:[e.jsxs(t.Header,{className:"bg-white border-0 d-flex justify-content-between align-items-center",children:[e.jsxs(t.Title,{as:"h5",className:"mb-0",children:["Low Stock Products",e.jsx(E,{bg:"danger",className:"ms-2",children:(d==null?void 0:d.length)||0})]}),e.jsx(N,{href:route("product.index"),className:"btn btn-sm btn-outline-primary",children:"Manage Products"})]}),e.jsx(t.Body,{children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{ref:x,className:"table table-hover mb-0",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{children:"SKU"}),e.jsx("th",{children:"Current Stock"}),e.jsx("th",{children:"Alert Level"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{})]})})})]})}),e.jsx(c,{lg:6,md:12,children:e.jsxs(t,{className:"shadow-sm border-0 h-100",children:[e.jsx(t.Header,{className:"bg-white border-0",children:e.jsx(t.Title,{as:"h5",className:"mb-0",children:"Top Selling Products"})}),e.jsx(t.Body,{children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{ref:f,className:"table table-hover mb-0",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Sales"}),e.jsx("th",{children:"Revenue"}),e.jsx("th",{children:"Stock"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{})]})})})]})})]}),e.jsx(u,{className:"mb-3 g-3",children:e.jsx(c,{lg:12,children:e.jsxs(t,{className:"shadow-sm border-0",children:[e.jsxs(t.Header,{className:"bg-white border-0 d-flex justify-content-between align-items-center",children:[e.jsx(t.Title,{as:"h5",className:"mb-0",children:"Recent Orders"}),e.jsx(N,{href:route("sales.index"),className:"btn btn-sm btn-outline-primary",children:"View All"})]}),e.jsx(t.Body,{children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{ref:p,className:"table table-hover mb-0",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Order #"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Payment"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{})]})})})]})})})]})},U=i=>i>=80?"success":i>=60?"info":i>=40?"warning":"danger";export{se as default};
