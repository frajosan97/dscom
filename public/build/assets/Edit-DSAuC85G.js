import{v as R,r as u,j as e,$ as q,m as z}from"./app-DDPmmEsP.js";import{B as m,R as B,N as c,y as v}from"./Footer-DHiARg5T.js";import{x as M}from"./axios-CX_3tIE5.js";import{B as U,P as V,I as Y,M as H,a as J,b as G,S as Q,c as W,F as E}from"./Media-9fTtkugT.js";import{E as X}from"./ErpLayout-BTroGK5i.js";import{u as Z}from"./useData-DDLfDtqJ.js";import{S as ee}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{C as se,B as ae}from"./Image-CfrpkxQr.js";import{F as I,C as j}from"./Form-Cqgl9C35.js";import{C as g}from"./Card-BnTkWAgR.js";import{T as d}from"./Tab-Df_OXg6b.js";import{I as te,C as ie,B as re,a as T}from"./info-circle-B2-LWsPU.js";import{T as ne}from"./trash-DDTWIvwR.js";import"./CloseButton-bKfF9Hr0.js";import"./index-CjSf-fsN.js";import"./iconBase-CZOCq8hy.js";import"./Alert-CYz88nDT.js";import"./Spinner-BxtKqZKn.js";import"./react-select.esm-BXcQi4PR.js";import"./hoist-non-react-statics.cjs-C-Qo8PK8.js";import"./floating-ui.dom-DvtPwI1-.js";/* empty css                      */function ke({product:s,attributes:le=[]}){const{categories:P,brands:$,taxes:K}=Z(),{data:t,setData:l,errors:_}=R({branch_id:s.branch_id||"",name:s.name||"",slug:s.slug||"",short_description:s.short_description||"",description:s.description||"",meta_title:s.meta_title||"",meta_description:s.meta_description||"",category_id:s.category_id||"",brand_id:s.brand_id||"",price:s.price||0,agent_price:s.agent_price||0,wholesaler_price:s.wholesaler_price||0,compare_price:s.compare_price||0,cost_per_item:s.cost_per_item||0,tax_id:s.tax_id||"",tax_amount:s.tax_amount||0,sku:s.sku||"",barcode:s.barcode||"",quantity:s.quantity||0,low_stock_threshold:s.low_stock_threshold||0,stock_status:s.stock_status||"in_stock",track_inventory:s.track_inventory||!1,allow_backorders:s.allow_backorders||!1,is_digital:s.is_digital||!1,requires_shipping:s.requires_shipping||!0,weight:s.weight||0,weight_unit:s.weight_unit||"kg",length:s.length||0,width:s.width||0,height:s.height||0,dimension_unit:s.dimension_unit||"cm",is_featured:s.is_featured||!1,is_active:s.is_active||!0,is_bestseller:s.is_bestseller||!1,is_new:s.is_new||!1,new_until:s.new_until||"",has_variants:s.has_variants||!1,tags:s.tags||[],specifications:s.specifications||{},custom_fields:s.custom_fields||{},related_products:s.related_products||[],images:s.images||[],variants:s.variants||[],selected_attributes:s.attributes||[],selected_attribute_values:s.attribute_values||[]}),[k,F]=u.useState(s.tags?s.tags.map(i=>({value:i,label:i})):[]),[ce,oe]=u.useState(""),[me,de]=u.useState(""),[y,p]=u.useState(!1),[w,D]=u.useState("basic"),L=async i=>{var o,f,h,C;i.preventDefault(),p(!0);try{if(!(await ee.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, create it!"})).isConfirmed){p(!1);return}const r=new FormData;Object.keys(t).forEach(a=>{a==="images"||a==="variants"||a==="selected_attributes"||a==="selected_attribute_values"||a==="related_products"||(a==="specifications"?r.append(a,JSON.stringify(t[a])):r.append(a,t[a]===null?"":t[a]))}),t.images.forEach((a,n)=>{a instanceof File?r.append(`images[${n}]`,a):typeof a=="object"&&(r.append(`existing_images[${n}][id]`,a.id),r.append(`existing_images[${n}][is_default]`,a.is_default))}),t.variants.forEach((a,n)=>{Object.keys(a).forEach(b=>{r.append(`variants[${n}][${b}]`,a[b]===null?"":a[b])})}),t.selected_attributes.forEach((a,n)=>{r.append(`attributes[${n}][id]`,a.value),r.append(`attributes[${n}][name]`,a.label)}),t.selected_attribute_values.forEach((a,n)=>{r.append(`attribute_values[${n}][id]`,a.value),r.append(`attribute_values[${n}][value]`,a.label)}),t.related_products.forEach((a,n)=>{r.append(`related_products[${n}]`,a.id||a)}),r.append("_method","put"),(await M.post(route("product.update",{product:s==null?void 0:s.id}),r,{headers:{"Content-Type":"multipart/form-data"}})).status===200&&(v.success("Product updated successfully"),p(!1),z.reload())}catch(x){if(p(!1),(f=(o=x.response)==null?void 0:o.data)!=null&&f.errors){const r=x.response.data.errors;Object.values(r).forEach(S=>{S.forEach(a=>{v.error(a)})})}else v.error(((C=(h=x.response)==null?void 0:h.data)==null?void 0:C.error)||"An error occurred while updating the product")}},A=i=>{F(i),l("tags",i.map(o=>o.value))},N=()=>{if(!t.is_active)return e.jsx(m,{bg:"secondary",children:"Inactive"});const i=[];return t.is_featured&&i.push(e.jsx(m,{bg:"info",className:"me-1",children:"Featured"},"featured")),t.is_bestseller&&i.push(e.jsx(m,{bg:"warning",className:"me-1",children:"Bestseller"},"bestseller")),t.is_new&&i.push(e.jsx(m,{bg:"success",className:"me-1",children:"New"},"new")),t.compare_price>t.price&&i.push(e.jsx(m,{bg:"danger",className:"me-1",children:"Sale"},"sale")),i.length?i:e.jsx(m,{bg:"primary",children:"Active"})},O=()=>!t.images||t.images.length===0?e.jsxs("div",{className:"border rounded p-4 text-center",children:[e.jsx(T,{size:48,className:"text-muted mb-2"}),e.jsx("p",{className:"text-muted",children:"No images uploaded"}),e.jsx(E,{onChange:i=>l("images",[...t.images,...i]),accept:"image/*",multiple:!0})]}):e.jsxs(B,{className:"g-2",children:[t.images.map((i,o)=>e.jsx(j,{xs:6,md:3,children:e.jsxs(g,{className:"h-100",children:[e.jsx(g.Img,{variant:"top",src:typeof i=="string"?i:i.image_path?`/storage/${i.image_path}`:URL.createObjectURL(i),style:{height:"120px",objectFit:"cover"}}),e.jsx(g.Body,{className:"p-2",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx(I.Check,{type:"radio",name:"defaultImage",label:"Default",checked:i.is_default,onChange:()=>l("images",t.images.map((f,h)=>({...f,is_default:h===o})))}),e.jsx(ae,{variant:"outline-danger",size:"sm",onClick:()=>l("images",t.images.filter((f,h)=>h!==o)),children:e.jsx(ne,{size:14})})]})})]})},o)),e.jsx(j,{md:12,children:e.jsx("div",{className:"border p-2",children:e.jsx(E,{onChange:i=>l("images",[...t.images,...i]),accept:"image/*",multiple:!0,buttonText:"Add Images",buttonVariant:"outline-primary",buttonSize:"sm"})})})]});return e.jsxs(X,{children:[e.jsx(q,{title:`Edit ${s.name}`}),e.jsxs(se,{fluid:!0,className:"py-4",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h2",{className:"mb-0 d-inline-block",children:"Edit Product"}),e.jsxs("div",{children:[N(),e.jsx(m,{bg:t.is_digital?"info":"primary",className:"ms-2",children:t.is_digital?"Digital":"Physical"})]})]}),e.jsx("hr",{className:"dashed-hr mb-3"}),e.jsx(I,{onSubmit:L,children:e.jsxs(B,{className:"g-4",children:[e.jsx(j,{lg:8,children:e.jsxs(g,{className:"mb-4",children:[e.jsx(g.Header,{className:"bg-white",children:e.jsx(d.Container,{activeKey:w,onSelect:D,children:e.jsxs(c,{variant:"tabs",className:"mb-0",children:[e.jsx(c.Item,{children:e.jsxs(c.Link,{eventKey:"basic",children:[e.jsx(te,{className:"me-1"})," Basic Info"]})}),e.jsx(c.Item,{children:e.jsxs(c.Link,{eventKey:"pricing",children:[e.jsx(ie,{className:"me-1"})," Pricing"]})}),e.jsx(c.Item,{children:e.jsxs(c.Link,{eventKey:"inventory",children:[e.jsx(re,{className:"me-1"})," Inventory"]})}),e.jsx(c.Item,{children:e.jsxs(c.Link,{eventKey:"media",children:[e.jsx(T,{className:"me-1"})," Media"]})})]})})}),e.jsx(g.Body,{children:e.jsx(d.Container,{activeKey:w,children:e.jsxs(d.Content,{children:[e.jsx(d.Pane,{eventKey:"basic",children:e.jsx(U,{data:t,setData:l,errors:_,categories:P,brands:$})}),e.jsx(d.Pane,{eventKey:"pricing",children:e.jsx(V,{data:t,setData:l,errors:_,taxes:K})}),e.jsx(d.Pane,{eventKey:"inventory",children:e.jsx(Y,{data:t,setData:l,errors:_})}),e.jsx(d.Pane,{eventKey:"media",children:e.jsx(H,{renderImages:O})})]})})})]})}),e.jsxs(j,{lg:4,children:[e.jsx(J,{data:t,setData:l,processing:y,renderStatusBadge:N}),e.jsx(G,{data:t,setData:l}),e.jsx(Q,{data:t,setData:l,errors:_}),e.jsx(W,{data:t,setData:l,errors:_,selectedTags:k,handleTagChange:A,processing:y})]})]})})]})]})}export{ke as default};
