import{r as d,j as e,a as w,$ as V}from"./app-BiuRToP-.js";import{S as z}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{R as N,I as u}from"./Footer-BFQJwEZ5.js";import{E as Y}from"./ErpLayout-D0g2LxLo.js";import{w as P}from"./sweetalert2-react-content.es-DkzQCFd6.js";import{u as D,c as H,a as S,d as U}from"./index.esm-C-wRHYDi.js";import{M as g}from"./Modal-D2A1iNes.js";import{F as a,C as n}from"./Form-BA0l1WBA.js";import{C as m}from"./Card-CQupX1hM.js";import{B,C as X}from"./Image---NnaHc0.js";import{S as W}from"./Spinner-DbU-VvBa.js";import{B as K}from"./ButtonGroup-mV9uetrb.js";import{T as Q}from"./Table-BQgD3-2Y.js";import"./CloseButton-B--YT67x.js";/* empty css                      */import"./hoist-non-react-statics.cjs-C-Qo8PK8.js";const Z=H().shape({name:U().required("Slider name is required").max(255,"Slider name must not exceed 255 characters"),autoplay_speed:S().integer("Must be an integer").min(500,"Minimum autoplay speed is 500ms"),slides_to_show:S().integer("Must be an integer").min(1,"Minimum slides to show is 1"),slides_to_scroll:S().integer("Must be an integer").min(1,"Minimum slides to scroll is 1")});function ee({showModal:v,setShowModal:p,formData:t,handleInputChange:f,handleSubmit:k,isSubmitting:i,sliderTypes:F}){const s=D({initialValues:{id:"",name:"",type:"default",is_active:!0,autoplay:!0,arrows:!0,dots:!1,infinite:!0,autoplay_speed:3e3,slides_to_show:1,slides_to_scroll:1,breakpoints:null,custom_settings:null},validationSchema:Z,enableReinitialize:!0,onSubmit:c=>{const C={...c,breakpoints:c.breakpoints?JSON.parse(c.breakpoints):null,custom_settings:c.custom_settings?JSON.parse(c.custom_settings):null};k(C)}});return d.useEffect(()=>{t&&s.setValues({...t,breakpoints:t.breakpoints?JSON.stringify(t.breakpoints,null,2):"",custom_settings:t.custom_settings?JSON.stringify(t.custom_settings,null,2):"",is_active:t.is_active!==void 0?t.is_active:!0,autoplay:t.autoplay!==void 0?t.autoplay:!0,arrows:t.arrows!==void 0?t.arrows:!0,dots:t.dots!==void 0?t.dots:!1,infinite:t.infinite!==void 0?t.infinite:!0})},[t]),e.jsx(g,{centered:!0,show:v,onHide:()=>{i||(p(!1),s.resetForm())},backdrop:i?"static":!0,keyboard:!i,size:"lg",children:e.jsxs(a,{onSubmit:s.handleSubmit,noValidate:!0,children:[e.jsx(g.Header,{closeButton:!i,children:e.jsx(g.Title,{children:t.id?"Edit Slider":"Create Slider"})}),e.jsx(g.Body,{children:e.jsxs(N,{className:"g-3 mb-3",children:[e.jsx(n,{md:12,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsxs(a.Label,{children:["Slider Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(u,{children:[e.jsx(u.Text,{children:e.jsx("i",{className:"bi bi-sliders"})}),e.jsx(a.Control,{type:"text",name:"name",value:s.values.name,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.name&&!!s.errors.name,disabled:i,required:!0}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.name})]})]})}),e.jsx(n,{md:4,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Autoplay Speed (ms)"}),e.jsxs(u,{children:[e.jsx(u.Text,{children:e.jsx("i",{className:"bi bi-speedometer2"})}),e.jsx(a.Control,{type:"number",name:"autoplay_speed",min:"500",step:"500",value:s.values.autoplay_speed,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.autoplay_speed&&!!s.errors.autoplay_speed,disabled:i}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.autoplay_speed})]})]})}),e.jsx(n,{md:4,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Slides To Show"}),e.jsxs(u,{children:[e.jsx(u.Text,{children:e.jsx("i",{className:"bi bi-collection"})}),e.jsx(a.Control,{type:"number",name:"slides_to_show",min:"1",value:s.values.slides_to_show,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.slides_to_show&&!!s.errors.slides_to_show,disabled:i}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.slides_to_show})]})]})}),e.jsx(n,{md:4,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Slides To Scroll"}),e.jsxs(u,{children:[e.jsx(u.Text,{children:e.jsx("i",{className:"bi bi-arrow-left-right"})}),e.jsx(a.Control,{type:"number",name:"slides_to_scroll",min:"1",value:s.values.slides_to_scroll,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.slides_to_scroll&&!!s.errors.slides_to_scroll,disabled:i}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.slides_to_scroll})]})]})}),e.jsx(n,{md:12,children:e.jsx(m,{className:"border-0 shadow-sm",children:e.jsxs(m.Body,{children:[e.jsx(m.Title,{children:"Slider Controls"}),e.jsxs(N,{children:[e.jsx(n,{md:6,lg:3,children:e.jsx(a.Check,{type:"switch",id:"autoplay",name:"autoplay",label:"Autoplay",checked:s.values.autoplay,onChange:s.handleChange,disabled:i})}),e.jsx(n,{md:6,lg:3,children:e.jsx(a.Check,{type:"switch",id:"arrows",name:"arrows",label:"Navigation Arrows",checked:s.values.arrows,onChange:s.handleChange,disabled:i})}),e.jsx(n,{md:6,lg:3,children:e.jsx(a.Check,{type:"switch",id:"dots",name:"dots",label:"Pagination Dots",checked:s.values.dots,onChange:s.handleChange,disabled:i})}),e.jsx(n,{md:6,lg:3,children:e.jsx(a.Check,{type:"switch",id:"infinite",name:"infinite",label:"Infinite Loop",checked:s.values.infinite,onChange:s.handleChange,disabled:i})}),e.jsx(n,{md:6,lg:3,children:e.jsx(a.Check,{type:"switch",id:"is_active",name:"is_active",label:"Active",checked:s.values.is_active,onChange:s.handleChange,disabled:i})})]})]})})}),e.jsx(n,{md:12,children:e.jsx(m,{className:"border-0 shadow-sm",children:e.jsxs(m.Body,{children:[e.jsx(m.Title,{children:"Advanced Settings"}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Breakpoints (JSON)"}),e.jsx(a.Control,{as:"textarea",rows:3,name:"breakpoints",value:s.values.breakpoints||"",onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.breakpoints&&!!s.errors.breakpoints,disabled:i,placeholder:'Example: {"768": {"slidesToShow": 2}, "1024": {"slidesToShow": 3}}'}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.breakpoints})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Custom Settings (JSON)"}),e.jsx(a.Control,{as:"textarea",rows:3,name:"custom_settings",value:s.values.custom_settings||"",onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.custom_settings&&!!s.errors.custom_settings,disabled:i,placeholder:"Any additional settings in JSON format"}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.custom_settings})]})]})})})]})}),e.jsxs(g.Footer,{children:[e.jsx(B,{variant:"outline-danger",onClick:()=>{p(!1),s.resetForm()},disabled:i,children:"Cancel"}),e.jsx(B,{variant:"outline-light",type:"submit",disabled:i||!s.isValid,children:i?e.jsxs(e.Fragment,{children:[e.jsx(W,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),e.jsx("span",{className:"ms-2",children:t.id?"Updating...":"Creating..."})]}):t.id?"Update":"Create"})]})]})})}const o=P(z),M=()=>({id:"",name:"",type:"",description:"",is_active:!1,start_date:"",end_date:"",order:0});function je(){const[v,p]=d.useState(!1),[t,f]=d.useState(M()),[k,i]=d.useState(!1),[F,s]=d.useState([]),c=d.useCallback(()=>{$.fn.DataTable.isDataTable("#slidesTable")&&$("#slidesTable").DataTable().ajax.reload(null,!1)},[]),C=d.useCallback(async()=>{try{const l=await w.get(route("slider.index"));s(l.data)}catch{o.fire("Error","Failed to load sliders.","error")}},[]),E=d.useCallback(()=>{$.fn.DataTable.isDataTable("#slidesTable")&&$("#slidesTable").DataTable().destroy(),$("#slidesTable").DataTable({processing:!0,serverSide:!0,ajax:{url:route("slider.index"),type:"GET",headers:{"X-Requested-With":"XMLHttpRequest"}},columns:[{data:"DT_RowIndex",name:"DT_RowIndex",title:"#",orderable:!1,searchable:!1,width:"5%"},{data:"name",name:"name",title:"Slider",className:"text-capitalize"},{data:"type",name:"type",title:"Type"},{data:"items_count",name:"items_count",title:"Item Count"},{data:"status_badge",name:"status_badge",title:"Status"},{data:"action",name:"action",title:"Actions",orderable:!1,searchable:!1,width:"15%"}],drawCallback:()=>{$(".edit-btn").off("click").on("click",function(){const l=$(this).data("id");G(l)}),$(".delete-btn").off("click").on("click",function(){const l=$(this).data("id");R(l)})}})},[]),L=l=>{const{name:r,value:y,type:b,checked:x}=l.target;f(_=>({..._,[r]:b==="checkbox"?x:y}))},A=l=>{f(r=>({...r,image:l.target.files[0]}))},O=()=>{f(M()),p(!0)},G=async l=>{try{const r=await w.get(route("slider.edit",l));f({...r.data,is_active:!!r.data.is_active}),p(!0)}catch{o.fire("Error","Failed to load slide data.","error")}},R=async l=>{var y;if((await o.fire({title:"Delete Slide?",text:"This cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await w.delete(route("slider.destroy",l)),c(),o.fire("Deleted!","Slide has been deleted.","success")}catch(b){let x="Delete failed.";((y=b.response)==null?void 0:y.status)===403&&(x="You don't have permission to delete this slide."),o.fire("Error!",x,"error")}},J=async l=>{var b,x,_,I;const r=!!l.id;if((await o.fire({title:r?"Update slide?":"Create slide?",text:r?"Are you sure you want to update this slide?":"Are you sure you want to create a new slide?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:r?"Yes, update it!":"Yes, create it!"})).isConfirmed){i(!0),o.fire({icon:"info",title:"Processing...",text:"Please wait...",allowOutsideClick:!1,showConfirmButton:!1,didOpen:()=>o.showLoading()});try{const h=new FormData;Object.entries(l).forEach(([q,T])=>{T!=null&&h.append(q,T)}),r&&h.append("_method","put");const j=r?route("slider.update",l.id):route("slider.store");await w.post(j,h,{headers:{"Content-Type":"multipart/form-data"}}),p(!1),c(),C(),o.fire("Success",`Slide ${r?"updated":"created"} successfully.`,"success")}catch(h){let j="Failed to save slide.";(x=(b=h.response)==null?void 0:b.data)!=null&&x.message?j=h.response.data.message:((_=h.response)==null?void 0:_.status)===422?j="Validation error. Please check your input.":((I=h.response)==null?void 0:I.status)===403&&(j="You don't have permission to perform this action."),o.fire("Error",j,"error")}finally{i(!1)}}};return d.useEffect(()=>(E(),C(),()=>{$.fn.DataTable.isDataTable("#slidesTable")&&$("#slidesTable").DataTable().destroy()}),[E,C]),e.jsxs(Y,{children:[e.jsx(V,{title:"Slides"}),e.jsxs(X,{children:[e.jsxs(N,{className:"g-3",children:[e.jsxs(n,{md:12,className:"d-flex justify-content-between align-items-center",children:[e.jsx("h2",{className:"mb-0",children:"Slides"}),e.jsx(K,{className:"gap-2",children:e.jsxs(B,{variant:"outline-primary",className:"rounded",onClick:O,children:[e.jsx("i",{className:"bi bi-plus-circle"})," ","Create Slide"]})})]}),e.jsx(n,{md:12,children:e.jsx("hr",{className:"dashed-hr"})}),e.jsx(n,{md:12,children:e.jsx(m,{children:e.jsx(m.Body,{children:e.jsx(Q,{bordered:!0,striped:!0,hover:!0,responsive:!0,id:"slidesTable",className:"w-100"})})})})]}),e.jsx(ee,{showModal:v,setShowModal:p,formData:t,handleInputChange:L,handleFileChange:A,handleSubmit:J,isSubmitting:k,sliders:F})]})]})}export{je as default};
