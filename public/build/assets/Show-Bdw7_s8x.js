import{j as e,r as p,$ as T,Y as b,m as B}from"./app-B06hfKGj.js";import{B as a,R as j,N as d,y as O}from"./Footer-DDeWqo-b.js";import{E as I}from"./ErpLayout-B3oWaJaT.js";import{L as S}from"./ListGroup-B1anJv2_.js";import{f as C}from"./format-CAPgRCzf.js";import{T as u}from"./Table-BvYtOJoC.js";import{C as M,B as l}from"./Image-CGBT7qjj.js";import{C as x,F as g}from"./Form-BAgPDe-D.js";import{B as D}from"./ButtonGroup-Ii35VLGf.js";import{C as c}from"./Card-DRqWWn-y.js";import{T as h}from"./Tab-BEO_8HHj.js";import{S as N}from"./Spinner-VPhUufQ8.js";import"./CloseButton-rn___kEl.js";/* empty css                      */function K({status:s}){switch(s){case"pending":return e.jsxs(a,{bg:"danger",children:[e.jsx("i",{className:"bi bi-hourglass-split me-1"})," Pending"]});case"confirmed":return e.jsxs(a,{bg:"primary",children:[e.jsx("i",{className:"bi bi-check-circle me-1"})," Confirmed"]});case"processing":return e.jsxs(a,{bg:"info",children:[e.jsx("i",{className:"bi bi-gear-wide-connected me-1"})," Processing"]});case"shipped":return e.jsxs(a,{bg:"warning",text:"dark",children:[e.jsx("i",{className:"bi bi-truck me-1"})," Shipped"]});case"delivered":return e.jsxs(a,{bg:"success",children:[e.jsx("i",{className:"bi bi-check2-all me-1"})," Delivered"]});case"cancelled":return e.jsxs(a,{bg:"danger",children:[e.jsx("i",{className:"bi bi-x-circle me-1"})," Cancelled"]});case"refunded":return e.jsxs(a,{bg:"info",children:[e.jsx("i",{className:"bi bi-arrow-counterclockwise me-1"})," Refunded"]});case"partially_refunded":return e.jsxs(a,{bg:"info",children:[e.jsx("i",{className:"bi bi-arrow-counterclockwise me-1"})," Partially Refunded"]});case"on_hold":return e.jsxs(a,{bg:"warning",text:"dark",children:[e.jsx("i",{className:"bi bi-pause-circle me-1"})," On Hold"]});case"failed":return e.jsxs(a,{bg:"danger",children:[e.jsx("i",{className:"bi bi-exclamation-octagon me-1"})," Failed"]});case"completed":return e.jsxs(a,{bg:"success",children:[e.jsx("i",{className:"bi bi-check2-circle me-1"})," Completed"]});default:return e.jsxs(a,{bg:"primary",children:[e.jsx("i",{className:"bi bi-question-circle me-1"})," Unknown"]})}}function R({status:s}){switch(s){case"pending":return e.jsxs(a,{bg:"danger",children:[e.jsx("i",{className:"bi bi-hourglass-split me-1"})," Pending"]});case"paid":return e.jsxs(a,{bg:"success",children:[e.jsx("i",{className:"bi bi-currency-dollar me-1"})," Paid"]});case"failed":return e.jsxs(a,{bg:"danger",children:[e.jsx("i",{className:"bi bi-exclamation-octagon me-1"})," Failed"]});case"partially_paid":return e.jsxs(a,{bg:"warning",text:"dark",children:[e.jsx("i",{className:"bi bi-currency-exchange me-1"})," Partially Paid"]});case"refunded":return e.jsxs(a,{bg:"info",children:[e.jsx("i",{className:"bi bi-arrow-counterclockwise me-1"})," Refunded"]});default:return e.jsxs(a,{bg:"primary",children:[e.jsx("i",{className:"bi bi-question-circle me-1"})," Unknown"]})}}function L({history:s}){return!s||s.length===0?e.jsxs("div",{className:"text-center text-muted py-4",children:[e.jsx("i",{className:"bi bi-clock-history fs-1"}),e.jsx("p",{className:"mt-2",children:"No status history available"})]}):e.jsx(S,{variant:"flush",children:s.map((r,i)=>e.jsxs(S.Item,{className:"border-start-0 border-end-0",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("div",{children:[e.jsx("strong",{children:r.status}),r.note&&e.jsx("div",{className:"text-muted small mt-1",children:r.note})]}),e.jsx("div",{className:"text-muted small",children:C(new Date(r.created_at),"MMM dd, yyyy HH:mm")})]}),i<s.length-1&&e.jsx("div",{className:"vr position-absolute h-100 ms-3"})]},i))})}function F({items:s,currency:r}){return!s||s.length===0?e.jsxs("div",{className:"text-center text-muted py-4",children:[e.jsx("i",{className:"bi bi-box-seam fs-1"}),e.jsx("p",{className:"mt-2",children:"No items in this order"})]}):e.jsxs(u,{striped:!0,bordered:!0,hover:!0,className:"mt-3",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{className:"text-end",children:"Price"}),e.jsx("th",{className:"text-end",children:"Qty"}),e.jsx("th",{className:"text-end",children:"Total"})]})}),e.jsx("tbody",{children:s.map((i,t)=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{className:"fw-semibold",children:i.product.name}),i.product.sku&&e.jsxs("div",{className:"text-muted small",children:["SKU: ",i.product.sku]})]}),e.jsxs("td",{className:"text-end",children:[r," ",i.price]}),e.jsx("td",{className:"text-end",children:i.quantity}),e.jsxs("td",{className:"text-end fw-semibold",children:[r," ",i.price*i.quantity]})]},t))}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"text-end fw-semibold",children:"Subtotal"}),e.jsxs("td",{className:"text-end fw-semibold",children:[r," ",s.reduce((i,t)=>i+t.price*t.quantity,0)]})]})})]})}function z({payments:s,currency:r}){if(!s||s.length===0)return e.jsxs("div",{className:"text-center text-muted py-4",children:[e.jsx("i",{className:"bi bi-credit-card fs-1"}),e.jsx("p",{className:"mt-2",children:"No payments recorded"})]});const i=t=>{switch(t){case"completed":return e.jsx(a,{bg:"success",children:"Completed"});case"pending":return e.jsx(a,{bg:"warning",text:"dark",children:"Pending"});case"failed":return e.jsx(a,{bg:"danger",children:"Failed"});case"refunded":return e.jsx(a,{bg:"info",children:"Refunded"});default:return e.jsx(a,{bg:"secondary",children:t})}};return e.jsxs(u,{striped:!0,bordered:!0,hover:!0,className:"mt-3",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Method"}),e.jsx("th",{children:"Reference"}),e.jsx("th",{className:"text-end",children:"Amount"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:s.map((t,m)=>e.jsxs("tr",{children:[e.jsx("td",{children:C(new Date(t.created_at),"MMM dd, yyyy")}),e.jsx("td",{children:t.payment_method.name}),e.jsx("td",{children:t.transaction_id||"-"}),e.jsxs("td",{className:"text-end",children:[r," ",t.amount]}),e.jsx("td",{children:i(t.status)})]},m))}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"text-end fw-semibold",children:"Total Paid"}),e.jsxs("td",{className:"text-end fw-semibold",children:[r," ",s.reduce((t,m)=>t+m.amount,0)]}),e.jsx("td",{})]})})]})}function ee({order:s}){var _,w,k;const[r,i]=p.useState("details"),[t,m]=p.useState(!1),[f,y]=p.useState(""),o=n=>{m(!0),B.patch(route("sales.update-status",s.id),{status:n,note:f},{preserveScroll:!0,onSuccess:()=>{O.success("Order status updated successfully"),y("")},onFinish:()=>m(!1)})},P=n=>n?new Date(n).toLocaleString():"-",v=n=>n?e.jsxs(e.Fragment,{children:[n.street&&e.jsx("div",{children:n.street}),n.city&&e.jsxs("div",{children:[n.city,", ",n.state," ",n.postal_code]}),n.country&&e.jsx("div",{children:n.country})]}):"-";return e.jsxs(I,{children:[e.jsx(T,{title:`Order #${s.order_number}`}),e.jsxs(M,{fluid:!0,className:"mt-4",children:[e.jsx(j,{className:"mb-4",children:e.jsxs(x,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h2",{className:"mb-0",children:["Order #",e.jsx("span",{className:"text-primary",children:s.order_number})]}),e.jsx("div",{children:e.jsxs(D,{className:"gap-2",children:[e.jsxs(l,{variant:"outline-primary",className:"rounded",as:b,href:route("sales.edit",s.id),children:[e.jsx("i",{className:"bi bi-pencil me-2"}),"Edit"]}),e.jsxs(l,{variant:"outline-primary",className:"rounded",as:b,href:route("sales.index"),children:[e.jsx("i",{className:"bi bi-arrow-left me-2"}),"Back to Orders"]})]})})]}),e.jsx("hr",{className:"dashed-hr mt-3"})]})}),e.jsxs(j,{className:"mb-4",children:[e.jsx(x,{md:8,children:e.jsx(c,{children:e.jsx(c.Body,{children:e.jsxs(h.Container,{activeKey:r,onSelect:i,children:[e.jsxs(d,{variant:"tabs",className:"mb-4",children:[e.jsx(d.Item,{children:e.jsxs(d.Link,{eventKey:"details",children:[e.jsx("i",{className:"bi bi-list-ul me-2"}),"Order Details"]})}),e.jsx(d.Item,{children:e.jsxs(d.Link,{eventKey:"items",children:[e.jsx("i",{className:"bi bi-box-seam me-2"}),"Items (",((_=s.items)==null?void 0:_.length)||0,")"]})}),e.jsx(d.Item,{children:e.jsxs(d.Link,{eventKey:"payments",children:[e.jsx("i",{className:"bi bi-credit-card me-2"}),"Payments (",((w=s.payments)==null?void 0:w.length)||0,")"]})}),e.jsx(d.Item,{children:e.jsxs(d.Link,{eventKey:"history",children:[e.jsx("i",{className:"bi bi-clock-history me-2"}),"Status History"]})})]}),e.jsxs(h.Content,{children:[e.jsxs(h.Pane,{eventKey:"details",children:[e.jsxs(j,{children:[e.jsxs(x,{md:6,children:[e.jsx("h5",{className:"mb-3",children:"Order Information"}),e.jsx(u,{borderless:!0,size:"sm",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"Order Date"}),e.jsx("td",{children:P(s.created_at)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"Order Status"}),e.jsx("td",{children:e.jsx(K,{status:s.status})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"Payment Status"}),e.jsx("td",{children:e.jsx(R,{status:s.payment_status})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"Fulfillment Status"}),e.jsx("td",{children:e.jsx(a,{bg:"secondary",children:s.fulfillment_status||"Not fulfilled"})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"Payment Method"}),e.jsx("td",{children:s.payment_method_name||"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"Shipping Method"}),e.jsx("td",{children:((k=s.shipping_method)==null?void 0:k.name)||"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"Tracking Number"}),e.jsx("td",{children:s.tracking_number?e.jsx("a",{href:s.tracking_url,target:"_blank",rel:"noopener noreferrer",children:s.tracking_number}):"-"})]})]})})]}),e.jsxs(x,{md:6,children:[e.jsx("h5",{className:"mb-3",children:"Customer Information"}),e.jsx(u,{borderless:!0,size:"sm",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"Customer"}),e.jsx("td",{children:s.customer?e.jsx(b,{href:route("customers.show",s.customer.id),children:s.customer_full_name}):`${s.customer_first_name} ${s.customer_last_name}`})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"Email"}),e.jsx("td",{children:s.customer_email||"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"Phone"}),e.jsx("td",{children:s.customer_phone||"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"Company"}),e.jsx("td",{children:s.customer_company||"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"Tax Number"}),e.jsx("td",{children:s.customer_tax_number||"-"})]})]})})]})]}),e.jsxs(j,{className:"mt-4",children:[e.jsxs(x,{md:6,children:[e.jsx("h5",{className:"mb-3",children:"Billing Address"}),e.jsx("div",{className:"p-3 bg-light rounded",children:v(s.billing_address)})]}),e.jsxs(x,{md:6,children:[e.jsx("h5",{className:"mb-3",children:"Shipping Address"}),e.jsx("div",{className:"p-3 bg-light rounded",children:s.shipping_same_as_billing?e.jsx("span",{className:"text-muted",children:"Same as billing address"}):v(s.shipping_address)})]})]}),e.jsx(j,{className:"mt-4",children:e.jsxs(x,{children:[e.jsx("h5",{className:"mb-3",children:"Customer Note"}),e.jsx("div",{className:"p-3 bg-light rounded",children:s.customer_note||e.jsx("span",{className:"text-muted",children:"No customer note"})})]})})]}),e.jsx(h.Pane,{eventKey:"items",children:e.jsx(F,{items:s.items,currency:s.currency})}),e.jsx(h.Pane,{eventKey:"payments",children:e.jsx(z,{payments:s.payments,currency:s.currency})}),e.jsx(h.Pane,{eventKey:"history",children:e.jsx(L,{history:s.order_status_history})})]})]})})})}),e.jsxs(x,{md:4,children:[e.jsxs(c,{className:"mb-4",children:[e.jsx(c.Header,{children:e.jsx("h5",{className:"mb-0",children:"Order Summary"})}),e.jsx(c.Body,{children:e.jsx(u,{borderless:!0,size:"sm",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"Subtotal"}),e.jsxs("td",{className:"text-end",children:[s.currency," ",s.subtotal]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"Shipping"}),e.jsxs("td",{className:"text-end",children:[s.currency," ",s.shipping_cost]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"Tax"}),e.jsxs("td",{className:"text-end",children:[s.currency," ",s.tax]})]}),s.discount>0&&e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"Discount"}),e.jsxs("td",{className:"text-end text-danger",children:["-",s.currency," ",s.discount]})]}),e.jsxs("tr",{className:"border-top",children:[e.jsx("td",{className:"fw-bold",children:"Total"}),e.jsxs("td",{className:"text-end fw-bold",children:[s.currency," ",s.total]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"Total Paid"}),e.jsxs("td",{className:"text-end",children:[s.currency," ",s.total_paid]})]}),s.total_refunded>0&&e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted",children:"Total Refunded"}),e.jsxs("td",{className:"text-end",children:[s.currency," ",s.total_refunded]})]})]})})})]}),e.jsxs(c,{className:"mb-4",children:[e.jsx(c.Header,{children:e.jsx("h5",{className:"mb-0",children:"Update Status"})}),e.jsxs(c.Body,{children:[e.jsxs(g.Group,{className:"mb-3",children:[e.jsx(g.Label,{children:"Status Note"}),e.jsx(g.Control,{as:"textarea",rows:3,value:f,onChange:n=>y(n.target.value),placeholder:"Add a note about this status change"})]}),e.jsxs("div",{className:"d-flex flex-wrap gap-2",children:[e.jsx(l,{variant:"outline-primary",onClick:()=>o("processing"),disabled:t,children:t?e.jsx(N,{size:"sm"}):"Mark as Processing"}),e.jsx(l,{variant:"outline-warning",onClick:()=>o("shipped"),disabled:t,children:t?e.jsx(N,{size:"sm"}):"Mark as Shipped"}),e.jsx(l,{variant:"outline-success",onClick:()=>o("delivered"),disabled:t,children:t?e.jsx(N,{size:"sm"}):"Mark as Delivered"}),e.jsx(l,{variant:"outline-danger",onClick:()=>o("cancelled"),disabled:t,children:t?e.jsx(N,{size:"sm"}):"Cancel Order"})]})]})]}),e.jsxs(c,{children:[e.jsx(c.Header,{children:e.jsx("h5",{className:"mb-0",children:"Actions"})}),e.jsx(c.Body,{children:e.jsxs("div",{className:"d-grid gap-2",children:[e.jsxs(l,{variant:"outline-secondary",as:b,href:"",children:[e.jsx("i",{className:"bi bi-file-earmark-text me-2"}),"View Invoice"]}),e.jsxs(l,{variant:"outline-secondary",children:[e.jsx("i",{className:"bi bi-envelope me-2"}),"Send Invoice"]}),e.jsxs(l,{variant:"outline-secondary",children:[e.jsx("i",{className:"bi bi-truck me-2"}),"Create Shipment"]}),s.payment_status!=="refunded"&&s.total_paid>0&&e.jsxs(l,{variant:"outline-secondary",children:[e.jsx("i",{className:"bi bi-arrow-counterclockwise me-2"}),"Issue Refund"]})]})})]})]})]})]})]})}export{ee as default};
