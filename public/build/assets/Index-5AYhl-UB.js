import{r as b,j as e,b as o,a as p,$ as X}from"./app-DDPmmEsP.js";import{E as O}from"./ErpLayout-BTroGK5i.js";import{S as V}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{w as A}from"./sweetalert2-react-content.es-BxcVws2k.js";import{u as H,c as Y,a as z,b as F,d as L}from"./index.esm-CdR14npU.js";import{M as v}from"./Modal-CuFKoZEN.js";import{F as a,C as i}from"./Form-Cqgl9C35.js";import{R as E,I as d}from"./Footer-DHiARg5T.js";import{B as T,C as P}from"./Image-CfrpkxQr.js";import{S as W}from"./Spinner-BxtKqZKn.js";import{B as K}from"./ButtonGroup-BveU2NPQ.js";import{C as G}from"./Card-BnTkWAgR.js";import{T as J}from"./Table-DWCTgkd7.js";/* empty css                      */import"./hoist-non-react-statics.cjs-C-Qo8PK8.js";import"./CloseButton-bKfF9Hr0.js";const Q=Y().shape({name:L().required("Brand name is required").max(255,"Brand name must not exceed 255 characters"),slug:L().max(255,"Slug must not exceed 255 characters"),is_active:F(),is_featured:F(),order:z().integer("Must be an integer")});function Z({showModal:y,setShowModal:h,formData:r,handleInputChange:C,handleFileChange:k,handleSubmit:B,isSubmitting:t}){const s=H({initialValues:{id:(r==null?void 0:r.id)||"",name:(r==null?void 0:r.name)||"",slug:(r==null?void 0:r.slug)||"",description:(r==null?void 0:r.description)||"",meta_title:(r==null?void 0:r.meta_title)||"",meta_description:(r==null?void 0:r.meta_description)||"",logo:(r==null?void 0:r.logo)||null,website_url:(r==null?void 0:r.website_url)||"",facebook_url:(r==null?void 0:r.facebook_url)||"",instagram_url:(r==null?void 0:r.instagram_url)||"",twitter_url:(r==null?void 0:r.twitter_url)||"",is_active:(r==null?void 0:r.is_active)!==void 0?r.is_active:!0,is_featured:(r==null?void 0:r.is_featured)!==void 0?r.is_featured:!1,order:(r==null?void 0:r.order)||0},validationSchema:Q,enableReinitialize:!0,onSubmit:j=>{B(j)}});return b.useEffect(()=>{r&&s.setValues({...s.values,...r,is_active:r.is_active!==void 0?r.is_active:!0,is_featured:r.is_featured!==void 0?r.is_featured:!1})},[r]),e.jsx(v,{centered:!0,show:y,onHide:()=>{t||(h(!1),s.resetForm())},backdrop:t?"static":!0,keyboard:!t,size:"lg",children:e.jsxs(a,{onSubmit:s.handleSubmit,noValidate:!0,children:[e.jsx(v.Header,{closeButton:!t,children:e.jsx(v.Title,{children:r.id?"Edit Brand":"Create Brand"})}),e.jsx(v.Body,{children:e.jsxs(E,{children:[e.jsx(i,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsxs(a.Label,{children:["Brand Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(d,{children:[e.jsx(d.Text,{children:e.jsx("i",{className:"bi bi-tag"})}),e.jsx(a.Control,{type:"text",name:"name",value:s.values.name,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.name&&!!s.errors.name,disabled:t,required:!0}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.name})]})]})}),e.jsx(i,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Slug"}),e.jsxs(d,{children:[e.jsx(d.Text,{children:e.jsx("i",{className:"bi bi-link-45deg"})}),e.jsx(a.Control,{type:"text",name:"slug",value:s.values.slug,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.slug&&!!s.errors.slug,disabled:t}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.slug})]})]})}),e.jsx(i,{md:12,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Description"}),e.jsx(a.Control,{as:"textarea",rows:3,name:"description",value:s.values.description,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.description&&!!s.errors.description,disabled:t}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.description})]})}),e.jsx(i,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Logo"}),e.jsx(a.Control,{type:"file",accept:"image/*",onChange:j=>{s.setFieldValue("logo",j.target.files[0]),k(j)},disabled:t}),s.values.logo&&typeof s.values.logo=="string"&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:s.values.logo,alt:"Current logo",className:"img-thumbnail",width:100})})]})}),e.jsx(i,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Order"}),e.jsx(a.Control,{type:"number",name:"order",value:s.values.order,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.order&&!!s.errors.order,disabled:t}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.order})]})}),e.jsx(i,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Website URL"}),e.jsxs(d,{children:[e.jsx(d.Text,{children:e.jsx("i",{className:"bi bi-globe"})}),e.jsx(a.Control,{type:"text",name:"website_url",value:s.values.website_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.website_url&&!!s.errors.website_url}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.website_url})]})]})}),e.jsx(i,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Facebook URL"}),e.jsxs(d,{children:[e.jsx(d.Text,{children:e.jsx("i",{className:"bi bi-facebook"})}),e.jsx(a.Control,{type:"text",name:"facebook_url",value:s.values.facebook_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.facebook_url&&!!s.errors.facebook_url}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.facebook_url})]})]})}),e.jsx(i,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Instagram URL"}),e.jsxs(d,{children:[e.jsx(d.Text,{children:e.jsx("i",{className:"bi bi-instagram"})}),e.jsx(a.Control,{type:"text",name:"instagram_url",value:s.values.instagram_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.instagram_url&&!!s.errors.instagram_url}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.instagram_url})]})]})}),e.jsx(i,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Twitter URL"}),e.jsxs(d,{children:[e.jsx(d.Text,{children:e.jsx("i",{className:"bi bi-twitter"})}),e.jsx(a.Control,{type:"text",name:"twitter_url",value:s.values.twitter_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.twitter_url&&!!s.errors.twitter_url}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.twitter_url})]})]})}),e.jsx(i,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Meta Title"}),e.jsx(a.Control,{type:"text",name:"meta_title",value:s.values.meta_title,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.meta_title&&!!s.errors.meta_title}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.meta_title})]})}),e.jsx(i,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Meta Description"}),e.jsx(a.Control,{as:"textarea",rows:2,name:"meta_description",value:s.values.meta_description,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.meta_description&&!!s.errors.meta_description}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.meta_description})]})}),e.jsx(i,{md:6,children:e.jsx(a.Group,{className:"mb-3",children:e.jsx(a.Check,{type:"switch",id:"is_active",name:"is_active",label:"Active",checked:s.values.is_active,onChange:s.handleChange,disabled:t})})}),e.jsx(i,{md:6,children:e.jsx(a.Group,{className:"mb-3",children:e.jsx(a.Check,{type:"switch",id:"is_featured",name:"is_featured",label:"Featured",checked:s.values.is_featured,onChange:s.handleChange,disabled:t})})})]})}),e.jsxs(v.Footer,{children:[e.jsx(T,{variant:"outline-danger",onClick:()=>{h(!1),s.resetForm()},disabled:t,children:"Cancel"}),e.jsx(T,{variant:"outline-light",type:"submit",disabled:t||!s.isValid,children:t?e.jsxs(e.Fragment,{children:[e.jsx(W,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),e.jsx("span",{className:"ms-2",children:r.id?"Updating...":"Creating..."})]}):r.id?"Update":"Create"})]})]})})}p.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";p.defaults.withCredentials=!0;p.defaults.xsrfCookieName="XSRF-TOKEN";p.defaults.xsrfHeaderName="X-XSRF-TOKEN";const c=A(V),I=()=>({id:"",name:"",slug:"",description:"",meta_title:"",meta_description:"",logo:null,website_url:"",facebook_url:"",instagram_url:"",twitter_url:"",is_active:!1,is_featured:!1,order:0});function pe(){const[y,h]=b.useState(!1),[r,C]=b.useState(I()),[k,B]=b.useState(!1),t=b.useCallback(()=>{o.fn.DataTable.isDataTable("#brandsTable")&&o("#brandsTable").DataTable().ajax.reload(null,!1)},[]),s=b.useCallback(()=>{o.fn.DataTable.isDataTable("#brandsTable")&&o("#brandsTable").DataTable().destroy(),o("#brandsTable").DataTable({processing:!0,serverSide:!0,ajax:{url:route("brand.index"),type:"GET",headers:{"X-Requested-With":"XMLHttpRequest"}},columns:[{data:"name",title:"Brand Name"},{data:"slug",title:"Slug"},{data:"logo",title:"Logo"},{data:"status_badge",title:"Status"},{data:"featured_badge",title:"Featured"},{data:"action",title:"Actions",orderable:!1}],drawCallback:()=>{o(".edit-btn").off("click").on("click",function(){const n=o(this).data("id");S(n)}),o(".delete-btn").off("click").on("click",function(){const n=o(this).data("id");q(n)})}})},[]),j=n=>{const{name:l,value:_,type:m,checked:x}=n.target;C(w=>({...w,[l]:m==="checkbox"?x:_}))},R=n=>{C(l=>({...l,logo:n.target.files[0]}))},M=()=>{C(I()),h(!0)},S=async n=>{try{const l=await p.get(route("brand.edit",n));C({...l.data,is_active:!!l.data.is_active,is_featured:!!l.data.is_featured}),h(!0)}catch{c.fire("Error","Failed to load brand data.","error")}},q=async n=>{var _;if((await c.fire({title:"Delete Brand?",text:"This cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await p.delete(route("brand.destroy",n)),t(),c.fire("Deleted!","Brand has been deleted.","success")}catch(m){let x="Delete failed.";((_=m.response)==null?void 0:_.status)===403&&(x="You don't have permission to delete this brand."),c.fire("Error!",x,"error")}},$=async n=>{var m,x,w,N;const l=!!n.id;if((await c.fire({title:l?"Update brand?":"Create brand?",text:l?"Are you sure you want to update this brand?":"Are you sure you want to create a new brand?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:l?"Yes, update it!":"Yes, create it!"})).isConfirmed){B(!0),c.fire({icon:"info",title:"Processing...",text:"Please wait...",allowOutsideClick:!1,showConfirmButton:!1,didOpen:()=>c.showLoading()});try{const u=new FormData;Object.entries(n).forEach(([U,f])=>{f!=null&&u.append(U,f)}),l&&u.append("_method","put");const g=l?route("brand.update",n.id):route("brand.store");await p.post(g,u,{headers:{"Content-Type":"multipart/form-data"}}),h(!1),t(),c.fire("Success",`Brand ${l?"updated":"created"} successfully.`,"success")}catch(u){let g="Failed to save brand.";(x=(m=u.response)==null?void 0:m.data)!=null&&x.message?g=u.response.data.message:((w=u.response)==null?void 0:w.status)===422?g="Validation error. Please check your input.":((N=u.response)==null?void 0:N.status)===403&&(g="You don't have permission to perform this action."),c.fire("Error",g,"error")}finally{B(!1)}}};return b.useEffect(()=>(s(),()=>{o.fn.DataTable.isDataTable("#brandsTable")&&o("#brandsTable").DataTable().destroy()}),[s]),e.jsxs(O,{children:[e.jsx(X,{title:"Brands"}),e.jsxs(P,{children:[e.jsxs(E,{className:"g-3",children:[e.jsxs(i,{md:12,className:"d-flex justify-content-between align-items-center",children:[e.jsx("h2",{className:"mb-0",children:"Brands"}),e.jsx(K,{className:"gap-2",children:e.jsxs(T,{variant:"outline-primary",className:"rounded",onClick:M,children:[e.jsx("i",{className:"bi bi-plus-circle"})," ","Create Brand"]})})]}),e.jsx(i,{md:12,children:e.jsx("hr",{className:"dashed-hr"})}),e.jsx(i,{md:12,children:e.jsx(G,{children:e.jsx(G.Body,{children:e.jsx(J,{bordered:!0,striped:!0,hover:!0,responsive:!0,id:"brandsTable",className:"w-100"})})})})]}),e.jsx(Z,{showModal:y,setShowModal:h,formData:r,handleInputChange:j,handleFileChange:R,handleSubmit:$,isSubmitting:k})]})]})}export{pe as default};
