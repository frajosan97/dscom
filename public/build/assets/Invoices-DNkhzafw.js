import{q as ae,r as m,j as e,$ as re}from"./app-CbWl7MT0.js";import{E as le}from"./ErpLayout-GFAmBSDI.js";import{A as ne}from"./Alert-gSkzhbKj.js";import{R as x,I as _,D as u}from"./Footer-C5hRgCho.js";import{C as n,F as r}from"./Form-2Aau3ajq.js";import{F as q}from"./file-earmark-text-DUqSbBFR.js";import{B as p}from"./Image-Bf_8E7qc.js";import{P as B}from"./plus-circle-LD_sCBJH.js";import{C as c}from"./Card-TijHqVGL.js";import{C as G,X as M}from"./x-circle-0naEQ1WM.js";import{C as A}from"./clock-BaEbjVwM.js";import{R as ie}from"./receipt-BqdvUQBu.js";import{S as ce}from"./search-Kil9bUTt.js";import{T as de}from"./Tabs-DWBliNtW.js";import{T as N}from"./Tab-CBaH97_b.js";import{T as oe}from"./Table-vcTjNUYW.js";import{P as me}from"./person-CgDRJkhN.js";import{C as xe}from"./calendar-xWGJ81TT.js";import{E as he}from"./eye-BsediGKK.js";import{P as ue}from"./pencil-KnHTXlcs.js";import{D as pe}from"./download-D4Z9E9zc.js";import{T as je}from"./trash-DAt8b_YP.js";import{M as o}from"./Modal-Be2cIDOT.js";import{B as j}from"./Badge-DRJ_gg0m.js";/* empty css                      */import"./CloseButton-GaR-_GdD.js";function Ke(){const{flash:T}=ae().props,[F,g]=m.useState(!1),[$,b]=m.useState(!1),[v,R]=m.useState(""),[y,K]=m.useState("all"),[C,L]=m.useState(null),[f,w]=m.useState(null),k=[{id:1,name:"Acme Corporation",type:"customer",email:"acme@example.com"},{id:2,name:"Global Tech Solutions",type:"customer",email:"tech@example.com"},{id:3,name:"Paper Supplies Ltd",type:"supplier",email:"paper@example.com"},{id:4,name:"Office Equipment Co",type:"supplier",email:"office@example.com"},{id:5,name:"Digital Marketing Pro",type:"supplier",email:"marketing@example.com"}],[h,I]=m.useState([{id:"INV-2025-001",type:"sales",party:"Acme Corporation",partyEmail:"acme@example.com",date:"2025-10-01",due_date:"2025-10-15",amount:1200,tax:120,total:1320,status:"paid",reference:"SO-001",items:[{description:"Website Development",quantity:1,price:1e3,amount:1e3},{description:"Domain Registration",quantity:1,price:200,amount:200}],notes:"Thank you for your business!"},{id:"INV-2025-002",type:"purchase",party:"Paper Supplies Ltd",partyEmail:"paper@example.com",date:"2025-10-05",due_date:"2025-10-20",amount:450,tax:45,total:495,status:"pending",reference:"PO-001",items:[{description:"Office Paper",quantity:10,price:45,amount:450}],notes:"Monthly office supplies"},{id:"INV-2025-003",type:"sales",party:"Global Tech Solutions",partyEmail:"tech@example.com",date:"2025-10-10",due_date:"2025-10-25",amount:2750,tax:275,total:3025,status:"overdue",reference:"SO-002",items:[{description:"E-commerce Platform",quantity:1,price:2e3,amount:2e3},{description:"SSL Certificate",quantity:1,price:750,amount:750}],notes:"Project completion invoice"},{id:"INV-2025-004",type:"purchase",party:"Digital Marketing Pro",partyEmail:"marketing@example.com",date:"2025-10-12",due_date:"2025-10-27",amount:1500,tax:150,total:1650,status:"draft",reference:"PO-002",items:[{description:"Google Ads Management",quantity:1,price:1500,amount:1500}],notes:"Q4 Marketing campaign"}]),[a,d]=m.useState({type:"sales",party:"",partyEmail:"",date:new Date().toISOString().split("T")[0],due_date:new Date(Date.now()+15*24*60*60*1e3).toISOString().split("T")[0],reference:"",items:[{description:"",quantity:1,price:0,amount:0}],tax_rate:10,notes:"",status:"draft"}),z=m.useMemo(()=>h.filter(s=>{const t=s.id.toLowerCase().includes(v.toLowerCase())||s.party.toLowerCase().includes(v.toLowerCase())||s.reference.toLowerCase().includes(v.toLowerCase()),l=y==="all"||y==="sales"&&s.type==="sales"||y==="purchase"&&s.type==="purchase"||y===s.status;return t&&l}),[h,v,y]),E=s=>{const t=s.items.reduce((se,te)=>se+(te.amount||0),0),l=t*(s.tax_rate/100),i=t+l;return{amount:t,tax:l,total:i}},V=()=>{const s=E(a),t=`INV-${new Date().getFullYear()}-${String(h.length+1).padStart(3,"0")}`,l={...a,id:t,...s,items:a.items.map(i=>({...i,amount:(i.quantity||0)*(i.price||0)}))};I([l,...h]),g(!1),S()},H=()=>{const s=E(a),t={...f,...a,...s,items:a.items.map(l=>({...l,amount:(l.quantity||0)*(l.price||0)}))};I(h.map(l=>l.id===f.id?t:l)),g(!1),w(null),S()},Q=s=>{w(s),d({...s,items:s.items.map(t=>({...t}))}),g(!0)},X=s=>{L(s),b(!0)},Y=()=>{I(h.filter(s=>s.id!==C.id)),b(!1),L(null)},S=()=>{d({type:"sales",party:"",partyEmail:"",date:new Date().toISOString().split("T")[0],due_date:new Date(Date.now()+15*24*60*60*1e3).toISOString().split("T")[0],reference:"",items:[{description:"",quantity:1,price:0,amount:0}],tax_rate:10,notes:"",status:"draft"})},D=(s,t,l)=>{const i=[...a.items];i[s]={...i[s],[t]:l},(t==="quantity"||t==="price")&&(i[s].amount=(i[s].quantity||0)*(i[s].price||0)),d({...a,items:i})},U=()=>{d({...a,items:[...a.items,{description:"",quantity:1,price:0,amount:0}]})},W=s=>{if(a.items.length<=1)return;const t=a.items.filter((l,i)=>i!==s);d({...a,items:t})},J=s=>{switch(s){case"paid":return e.jsxs(j,{bg:"success",children:[e.jsx(G,{className:"me-1",size:12})," Paid"]});case"pending":return e.jsxs(j,{bg:"warning",text:"dark",children:[e.jsx(A,{className:"me-1",size:12})," Pending"]});case"overdue":return e.jsxs(j,{bg:"danger",children:[e.jsx(M,{className:"me-1",size:12})," Overdue"]});case"draft":return e.jsx(j,{bg:"secondary",children:"Draft"});default:return e.jsx(j,{bg:"secondary",children:s})}},Z=s=>s==="sales"?e.jsx(j,{bg:"primary",children:"Sales"}):e.jsx(j,{bg:"info",children:"Purchase"}),ee=s=>{const t=k.find(l=>l.name===s);d({...a,party:s,partyEmail:(t==null?void 0:t.email)||""})},P=h.reduce((s,t)=>(t.status==="paid"?s.totalPaid+=t.total:t.status==="pending"?s.totalPending+=t.total:t.status==="overdue"&&(s.totalOverdue+=t.total),s),{totalPaid:0,totalPending:0,totalOverdue:0}),O=s=>new Date(s)<new Date;return e.jsxs(le,{children:[e.jsx(re,{title:"Invoices Management"}),T.success&&e.jsx(ne,{variant:"success",className:"mb-3",children:T.success}),e.jsxs(x,{className:"mb-4",children:[e.jsx(n,{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(q,{className:"me-3 text-primary",size:32}),e.jsxs("div",{children:[e.jsx("h4",{className:"fw-semibold mb-1",children:"Invoices Management"}),e.jsx("p",{className:"text-muted mb-0",children:"Manage sales and purchase invoices with automated tracking"})]})]})}),e.jsx(n,{className:"text-end",children:e.jsxs(p,{variant:"primary",className:"px-4",onClick:()=>{w(null),S(),g(!0)},children:[e.jsx(B,{className:"me-2"})," New Invoice"]})})]}),e.jsxs(x,{className:"mb-4",children:[e.jsx(n,{md:3,children:e.jsx(c,{className:"border-0 bg-success bg-opacity-10",children:e.jsx(c.Body,{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(G,{className:"text-success me-3",size:24}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted small",children:"Total Paid"}),e.jsxs("div",{className:"h5 fw-bold text-success mb-0",children:["$",P.totalPaid.toLocaleString()]})]})]})})})}),e.jsx(n,{md:3,children:e.jsx(c,{className:"border-0 bg-warning bg-opacity-10",children:e.jsx(c.Body,{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(A,{className:"text-warning me-3",size:24}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted small",children:"Pending"}),e.jsxs("div",{className:"h5 fw-bold text-warning mb-0",children:["$",P.totalPending.toLocaleString()]})]})]})})})}),e.jsx(n,{md:3,children:e.jsx(c,{className:"border-0 bg-danger bg-opacity-10",children:e.jsx(c.Body,{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(M,{className:"text-danger me-3",size:24}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted small",children:"Overdue"}),e.jsxs("div",{className:"h5 fw-bold text-danger mb-0",children:["$",P.totalOverdue.toLocaleString()]})]})]})})})}),e.jsx(n,{md:3,children:e.jsx(c,{className:"border-0 bg-primary bg-opacity-10",children:e.jsx(c.Body,{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(ie,{className:"text-primary me-3",size:24}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted small",children:"Total Invoices"}),e.jsx("div",{className:"h5 fw-bold text-primary mb-0",children:h.length})]})]})})})})]}),e.jsx(c,{className:"shadow-sm border-0 mb-4",children:e.jsx(c.Body,{children:e.jsxs(x,{children:[e.jsx(n,{md:6,children:e.jsxs(_,{children:[e.jsx(_.Text,{children:e.jsx(ce,{})}),e.jsx(r.Control,{placeholder:"Search by invoice ID, party, reference...",value:v,onChange:s=>R(s.target.value)})]})}),e.jsx(n,{md:6,children:e.jsxs(de,{activeKey:y,onSelect:s=>K(s),className:"mb-0",children:[e.jsx(N,{eventKey:"all",title:"All Invoices"}),e.jsx(N,{eventKey:"sales",title:"Sales"}),e.jsx(N,{eventKey:"purchase",title:"Purchases"}),e.jsx(N,{eventKey:"pending",title:"Pending"}),e.jsx(N,{eventKey:"overdue",title:"Overdue"})]})})]})})}),e.jsx(c,{className:"shadow-sm border-0",children:e.jsx(c.Body,{children:e.jsx("div",{className:"table-responsive",children:e.jsxs(oe,{hover:!0,className:"align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Invoice ID"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Party"}),e.jsx("th",{children:"Date / Due"}),e.jsx("th",{className:"text-end",children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-center",children:"Actions"})]})}),e.jsx("tbody",{children:z.length>0?z.map(s=>e.jsxs("tr",{className:O(s.due_date)&&s.status!=="paid"?"table-warning":"",children:[e.jsxs("td",{children:[e.jsx("div",{className:"fw-semibold",children:s.id}),e.jsx("small",{className:"text-muted",children:s.reference})]}),e.jsx("td",{children:Z(s.type)}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(me,{className:"me-2 text-muted",size:14}),e.jsxs("div",{children:[e.jsx("div",{children:s.party}),e.jsx("small",{className:"text-muted",children:s.partyEmail})]})]})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(xe,{className:"me-2 text-muted",size:14}),e.jsxs("div",{children:[e.jsx("div",{children:s.date}),e.jsxs("small",{className:O(s.due_date)&&s.status!=="paid"?"text-danger":"text-muted",children:["Due:"," ",s.due_date]})]})]})}),e.jsxs("td",{className:"text-end",children:[e.jsxs("div",{className:"fw-semibold",children:["$",s.total.toLocaleString()]}),e.jsxs("small",{className:"text-muted",children:["$",s.amount.toLocaleString()," ","+ $",s.tax.toLocaleString()," ","tax"]})]}),e.jsx("td",{children:J(s.status)}),e.jsx("td",{className:"text-center",children:e.jsxs(u,{children:[e.jsx(u.Toggle,{variant:"outline-primary",size:"sm",id:"dropdown-basic",children:"Actions"}),e.jsxs(u.Menu,{children:[e.jsxs(u.Item,{children:[e.jsx(he,{className:"me-2",size:14}),"View"]}),e.jsxs(u.Item,{onClick:()=>Q(s),children:[e.jsx(ue,{className:"me-2",size:14}),"Edit"]}),e.jsxs(u.Item,{children:[e.jsx(pe,{className:"me-2",size:14}),"Download PDF"]}),e.jsx(u.Divider,{}),e.jsxs(u.Item,{className:"text-danger",onClick:()=>X(s),children:[e.jsx(je,{className:"me-2",size:14}),"Delete"]})]})]})})]},s.id)):e.jsx("tr",{children:e.jsxs("td",{colSpan:"7",className:"text-center text-muted py-4",children:[e.jsx(q,{size:48,className:"mb-2"}),e.jsx("div",{children:"No invoices found"}),e.jsx("small",{children:"Try adjusting your search or create a new invoice"})]})})})]})})})}),e.jsxs(o,{show:F,onHide:()=>g(!1),centered:!0,size:"xl",children:[e.jsx(o.Header,{closeButton:!0,children:e.jsx(o.Title,{children:f?"Edit Invoice":"Create New Invoice"})}),e.jsx(o.Body,{style:{maxHeight:"70vh",overflowY:"auto"},children:e.jsxs(r,{children:[e.jsxs(x,{children:[e.jsx(n,{md:6,children:e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Invoice Type *"}),e.jsxs(r.Select,{value:a.type,onChange:s=>d({...a,type:s.target.value}),children:[e.jsx("option",{value:"sales",children:"Sales Invoice"}),e.jsx("option",{value:"purchase",children:"Purchase Invoice"})]})]})}),e.jsx(n,{md:6,children:e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Status"}),e.jsxs(r.Select,{value:a.status,onChange:s=>d({...a,status:s.target.value}),children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"paid",children:"Paid"})]})]})})]}),e.jsxs(x,{children:[e.jsx(n,{md:6,children:e.jsxs(r.Group,{className:"mb-3",children:[e.jsxs(r.Label,{children:[a.type==="sales"?"Customer":"Supplier"," ","*"]}),e.jsxs(r.Select,{value:a.party,onChange:s=>ee(s.target.value),children:[e.jsxs("option",{value:"",children:["Select"," ",a.type==="sales"?"Customer":"Supplier"]}),k.filter(s=>s.type===(a.type==="sales"?"customer":"supplier")).map(s=>e.jsx("option",{value:s.name,children:s.name},s.id))]})]})}),e.jsx(n,{md:6,children:e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Reference"}),e.jsx(r.Control,{value:a.reference,onChange:s=>d({...a,reference:s.target.value}),placeholder:"e.g., PO-001, SO-001"})]})})]}),e.jsxs(x,{children:[e.jsx(n,{md:6,children:e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Invoice Date *"}),e.jsx(r.Control,{type:"date",value:a.date,onChange:s=>d({...a,date:s.target.value})})]})}),e.jsx(n,{md:6,children:e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Due Date *"}),e.jsx(r.Control,{type:"date",value:a.due_date,onChange:s=>d({...a,due_date:s.target.value})})]})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsx(r.Label,{className:"fw-semibold",children:"Items"}),e.jsxs(p,{variant:"outline-primary",size:"sm",onClick:U,children:[e.jsx(B,{size:12,className:"me-1"}),"Add Item"]})]}),a.items.map((s,t)=>e.jsxs("div",{className:"border rounded p-3 mb-2",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsxs("small",{className:"text-muted",children:["Item #",t+1]}),a.items.length>1&&e.jsx(p,{variant:"outline-danger",size:"sm",onClick:()=>W(t),children:"Remove"})]}),e.jsxs(x,{children:[e.jsx(n,{md:6,children:e.jsxs(r.Group,{className:"mb-2",children:[e.jsx(r.Label,{children:"Description *"}),e.jsx(r.Control,{value:s.description,onChange:l=>D(t,"description",l.target.value),placeholder:"Item description"})]})}),e.jsx(n,{md:2,children:e.jsxs(r.Group,{className:"mb-2",children:[e.jsx(r.Label,{children:"Qty"}),e.jsx(r.Control,{type:"number",value:s.quantity,onChange:l=>D(t,"quantity",parseFloat(l.target.value)||0),min:"1"})]})}),e.jsx(n,{md:2,children:e.jsxs(r.Group,{className:"mb-2",children:[e.jsx(r.Label,{children:"Price"}),e.jsx(r.Control,{type:"number",step:"0.01",value:s.price,onChange:l=>D(t,"price",parseFloat(l.target.value)||0),placeholder:"0.00"})]})}),e.jsx(n,{md:2,children:e.jsxs(r.Group,{className:"mb-2",children:[e.jsx(r.Label,{children:"Amount"}),e.jsx(r.Control,{type:"number",step:"0.01",value:s.amount,readOnly:!0,className:"bg-light"})]})})]})]},t))]}),e.jsxs(x,{children:[e.jsx(n,{md:6,children:e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Tax Rate (%)"}),e.jsx(r.Control,{type:"number",step:"0.1",value:a.tax_rate,onChange:s=>d({...a,tax_rate:parseFloat(s.target.value)||0})})]})}),e.jsx(n,{md:6,children:e.jsx(c,{className:"bg-light",children:e.jsx(c.Body,{children:e.jsxs(x,{children:[e.jsxs(n,{children:[e.jsx("div",{className:"text-muted",children:"Subtotal:"}),e.jsxs("div",{className:"fw-semibold",children:["$",a.items.reduce((s,t)=>s+(t.amount||0),0).toFixed(2)]})]}),e.jsxs(n,{children:[e.jsx("div",{className:"text-muted",children:"Tax:"}),e.jsxs("div",{className:"fw-semibold",children:["$",(a.items.reduce((s,t)=>s+(t.amount||0),0)*(a.tax_rate/100)).toFixed(2)]})]}),e.jsxs(n,{children:[e.jsx("div",{className:"text-muted",children:"Total:"}),e.jsxs("div",{className:"h6 fw-bold text-primary",children:["$",(a.items.reduce((s,t)=>s+(t.amount||0),0)*(1+a.tax_rate/100)).toFixed(2)]})]})]})})})})]}),e.jsxs(r.Group,{children:[e.jsx(r.Label,{children:"Notes"}),e.jsx(r.Control,{as:"textarea",rows:3,value:a.notes,onChange:s=>d({...a,notes:s.target.value}),placeholder:"Additional notes or terms..."})]})]})}),e.jsxs(o.Footer,{children:[e.jsx(p,{variant:"secondary",onClick:()=>g(!1),children:"Cancel"}),e.jsx(p,{variant:"primary",onClick:f?H:V,children:f?"Update Invoice":"Create Invoice"})]})]}),e.jsxs(o,{show:$,onHide:()=>b(!1),centered:!0,children:[e.jsx(o.Header,{closeButton:!0,children:e.jsx(o.Title,{children:"Confirm Delete"})}),e.jsxs(o.Body,{children:["Are you sure you want to delete invoice"," ",e.jsx("strong",{children:C==null?void 0:C.id}),"?",e.jsx("br",{}),e.jsx("small",{className:"text-muted",children:"This action cannot be undone."})]}),e.jsxs(o.Footer,{children:[e.jsx(p,{variant:"secondary",onClick:()=>b(!1),children:"Cancel"}),e.jsx(p,{variant:"danger",onClick:Y,children:"Delete Invoice"})]})]})]})}export{Ke as default};
