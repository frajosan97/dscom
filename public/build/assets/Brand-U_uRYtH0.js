import{j as e,r as m,$ as R}from"./app-CcdzEu0R.js";import{R as w,I as r,y}from"./Footer-4Livvlxt.js";import{d as M}from"./index-BVGhLAUt.js";import{E as G}from"./ErpLayout-u_y7Ersr.js";import{S as k}from"./sweetalert2.esm.all-DpIEGYsy.js";import{x as N}from"./axios-COTtbvZI.js";import{u as D}from"./formik.esm-pgZf8OxT.js";import{c as U,d as E,b as I,a as n}from"./index.esm-lEXyK6iT.js";import{M as j}from"./Modal-BeCmzXVe.js";import{F as t,C as h}from"./Form-CLPTCCgE.js";import{I as z,B as b}from"./Image-D_GvnDn_.js";import{S as q}from"./Spinner-CGeZwkQ1.js";import{C as S}from"./Card-CSAU_t4j.js";import{B as O}from"./ButtonGroup-CEgI5t_N.js";import{T as P}from"./Table-D-OHgQ10.js";import"./CloseButton-Bv_xupVB.js";import"./iconBase-CciruWzR.js";/* empty css                      */function A({show:f,onHide:d,brand:a,onSuccess:x}){const c=!!a,_=U().shape({name:n().required("Brand name is required").max(255,"Brand name must not exceed 255 characters"),slug:n().max(255,"Slug must not exceed 255 characters"),description:n().nullable(),meta_title:n().nullable(),meta_description:n().nullable(),website_url:n().url("Must be a valid URL").nullable(),facebook_url:n().url("Must be a valid URL").nullable(),instagram_url:n().url("Must be a valid URL").nullable(),twitter_url:n().url("Must be a valid URL").nullable(),is_active:I(),is_featured:I(),order:E().integer("Must be an integer")}),s=D({enableReinitialize:!0,initialValues:{name:(a==null?void 0:a.name)||"",slug:(a==null?void 0:a.slug)||"",description:(a==null?void 0:a.description)||"",meta_title:(a==null?void 0:a.meta_title)||"",meta_description:(a==null?void 0:a.meta_description)||"",logo:null,website_url:(a==null?void 0:a.website_url)||"",facebook_url:(a==null?void 0:a.facebook_url)||"",instagram_url:(a==null?void 0:a.instagram_url)||"",twitter_url:(a==null?void 0:a.twitter_url)||"",is_active:(a==null?void 0:a.is_active)??!0,is_featured:(a==null?void 0:a.is_featured)??!1,order:(a==null?void 0:a.order)||0,_method:c?"PUT":"POST"},validationSchema:_,onSubmit:async(g,{setSubmitting:l,setErrors:p})=>{var u,i;try{const o=new FormData;Object.entries(g).forEach(([F,B])=>{B!=null&&o.append(F,B)});const L=c?route("brand.update",a.id):route("brand.store"),T=await N.post(L,o,{headers:{"Content-Type":"multipart/form-data"}});T.data.success===!0&&(x(T.data.message),d())}catch(o){(i=(u=o.response)==null?void 0:u.data)!=null&&i.errors?p(o.response.data.errors):console.error("Error submitting form:",o)}finally{l(!1)}}}),C=g=>{s.setFieldValue("logo",g.target.files[0])},v=()=>{s.setFieldValue("logo",null)};return e.jsxs(j,{show:f,onHide:d,size:"lg",centered:!0,backdrop:"static",children:[e.jsx(j.Header,{closeButton:!0,children:e.jsx(j.Title,{children:c?"Edit Brand":"Create New Brand"})}),e.jsxs(t,{onSubmit:s.handleSubmit,children:[e.jsx(j.Body,{children:e.jsxs(w,{children:[e.jsxs(h,{md:8,children:[e.jsxs(t.Group,{className:"mb-3",controlId:"name",children:[e.jsxs(t.Label,{children:["Brand Name"," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(r,{children:[e.jsx(r.Text,{children:e.jsx("i",{className:"bi bi-tag"})}),e.jsx(t.Control,{type:"text",name:"name",value:s.values.name,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.name&&!!s.errors.name,disabled:s.isSubmitting}),e.jsx(t.Control.Feedback,{type:"invalid",children:s.errors.name})]})]}),e.jsxs(t.Group,{className:"mb-3",controlId:"slug",children:[e.jsx(t.Label,{children:"Slug"}),e.jsxs(r,{children:[e.jsx(r.Text,{children:e.jsx("i",{className:"bi bi-link-45deg"})}),e.jsx(t.Control,{type:"text",name:"slug",value:s.values.slug,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.slug&&!!s.errors.slug,disabled:s.isSubmitting}),e.jsx(t.Control.Feedback,{type:"invalid",children:s.errors.slug})]})]}),e.jsxs(t.Group,{className:"mb-3",controlId:"description",children:[e.jsx(t.Label,{children:"Description"}),e.jsx(t.Control,{as:"textarea",rows:3,name:"description",value:s.values.description,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.description&&!!s.errors.description,disabled:s.isSubmitting}),e.jsx(t.Control.Feedback,{type:"invalid",children:s.errors.description})]}),e.jsxs(w,{children:[e.jsx(h,{md:6,children:e.jsxs(t.Group,{className:"mb-3",controlId:"website_url",children:[e.jsx(t.Label,{children:"Website URL"}),e.jsxs(r,{children:[e.jsx(r.Text,{children:e.jsx("i",{className:"bi bi-globe"})}),e.jsx(t.Control,{type:"url",name:"website_url",value:s.values.website_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.website_url&&!!s.errors.website_url,disabled:s.isSubmitting}),e.jsx(t.Control.Feedback,{type:"invalid",children:s.errors.website_url})]})]})}),e.jsx(h,{md:6,children:e.jsxs(t.Group,{className:"mb-3",controlId:"order",children:[e.jsx(t.Label,{children:"Order"}),e.jsx(t.Control,{type:"number",name:"order",value:s.values.order,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.order&&!!s.errors.order,disabled:s.isSubmitting}),e.jsx(t.Control.Feedback,{type:"invalid",children:s.errors.order})]})})]}),e.jsxs(w,{children:[e.jsx(h,{md:6,children:e.jsxs(t.Group,{className:"mb-3",controlId:"facebook_url",children:[e.jsx(t.Label,{children:"Facebook URL"}),e.jsxs(r,{children:[e.jsx(r.Text,{children:e.jsx("i",{className:"bi bi-facebook"})}),e.jsx(t.Control,{type:"url",name:"facebook_url",value:s.values.facebook_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.facebook_url&&!!s.errors.facebook_url,disabled:s.isSubmitting}),e.jsx(t.Control.Feedback,{type:"invalid",children:s.errors.facebook_url})]})]})}),e.jsx(h,{md:6,children:e.jsxs(t.Group,{className:"mb-3",controlId:"instagram_url",children:[e.jsx(t.Label,{children:"Instagram URL"}),e.jsxs(r,{children:[e.jsx(r.Text,{children:e.jsx("i",{className:"bi bi-instagram"})}),e.jsx(t.Control,{type:"url",name:"instagram_url",value:s.values.instagram_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.instagram_url&&!!s.errors.instagram_url,disabled:s.isSubmitting}),e.jsx(t.Control.Feedback,{type:"invalid",children:s.errors.instagram_url})]})]})})]}),e.jsxs(t.Group,{className:"mb-3",controlId:"twitter_url",children:[e.jsx(t.Label,{children:"Twitter URL"}),e.jsxs(r,{children:[e.jsx(r.Text,{children:e.jsx("i",{className:"bi bi-twitter"})}),e.jsx(t.Control,{type:"url",name:"twitter_url",value:s.values.twitter_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.twitter_url&&!!s.errors.twitter_url,disabled:s.isSubmitting}),e.jsx(t.Control.Feedback,{type:"invalid",children:s.errors.twitter_url})]})]})]}),e.jsxs(h,{md:4,children:[e.jsxs(t.Group,{className:"mb-3",controlId:"logo",children:[e.jsx(t.Label,{children:"Brand Logo"}),e.jsx(t.Control,{type:"file",accept:"image/*",onChange:C,disabled:s.isSubmitting}),(s.values.logo||(a==null?void 0:a.logo_url))&&e.jsxs("div",{className:"mt-3 text-center",children:[e.jsx(z,{src:typeof s.values.logo=="string"?s.values.logo:s.values.logo?URL.createObjectURL(s.values.logo):a==null?void 0:a.logo_url,alt:"Logo Preview",fluid:!0,thumbnail:!0,style:{maxHeight:"150px"}}),e.jsx(b,{variant:"link",size:"sm",className:"text-danger mt-2",onClick:v,disabled:s.isSubmitting,children:"Remove Logo"})]})]}),e.jsx(t.Group,{className:"mb-3",controlId:"is_active",children:e.jsx(t.Check,{type:"switch",id:"is_active",name:"is_active",label:"Active",checked:s.values.is_active,onChange:s.handleChange,disabled:s.isSubmitting})}),e.jsx(t.Group,{className:"mb-3",controlId:"is_featured",children:e.jsx(t.Check,{type:"switch",id:"is_featured",name:"is_featured",label:"Featured",checked:s.values.is_featured,onChange:s.handleChange,disabled:s.isSubmitting})}),e.jsxs(t.Group,{className:"mb-3",controlId:"meta_title",children:[e.jsx(t.Label,{children:"Meta Title"}),e.jsx(t.Control,{type:"text",name:"meta_title",value:s.values.meta_title,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.meta_title&&!!s.errors.meta_title,disabled:s.isSubmitting}),e.jsx(t.Control.Feedback,{type:"invalid",children:s.errors.meta_title})]}),e.jsxs(t.Group,{className:"mb-3",controlId:"meta_description",children:[e.jsx(t.Label,{children:"Meta Description"}),e.jsx(t.Control,{as:"textarea",rows:3,name:"meta_description",value:s.values.meta_description,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.meta_description&&!!s.errors.meta_description,disabled:s.isSubmitting}),e.jsx(t.Control.Feedback,{type:"invalid",children:s.errors.meta_description})]})]})]})}),e.jsxs(j.Footer,{children:[e.jsx(b,{variant:"secondary",onClick:d,disabled:s.isSubmitting,children:"Cancel"}),e.jsx(b,{variant:"primary",type:"submit",disabled:s.isSubmitting,children:s.isSubmitting?e.jsxs(e.Fragment,{children:[e.jsx(q,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),c?"Updating...":"Creating..."]}):`${c?"Update":"Create"} Brand`})]})]})]})}function de(){const[f,d]=m.useState(!1),[a,x]=m.useState(null),c=m.useCallback(()=>{$.fn.DataTable.isDataTable("#brandsTable")&&$("#brandsTable").DataTable().destroy(),$("#brandsTable").DataTable({processing:!0,serverSide:!0,ajax:{url:route("brand.index"),type:"GET",headers:{"X-Requested-With":"XMLHttpRequest"}},columns:[{data:"logo",name:"logo",title:"Logo"},{data:"name",name:"name",title:"Brand Name"},{data:"slug",name:"slug",title:"Slug"},{data:"status_badge",name:"status_badge",title:"Status"},{data:"featured_badge",name:"featured_badge",title:"Featured"},{data:"action",name:"action",title:"Actions",orderable:!1,searchable:!1,width:"10%"}],order:[[0,"desc"]],drawCallback:()=>{$(".edit-btn").off("click").on("click",function(){const l=$(this).data("id");v(l)}),$(".delete-btn").off("click").on("click",function(){const l=$(this).data("id");g(l)})}})},[]);m.useEffect(()=>{c()},[c]);const _=m.useCallback(()=>{x(null),d(!0)},[]),s=m.useCallback(()=>{d(!1),x(null)},[]),C=m.useCallback(l=>{y.success(l),$("#brandsTable").DataTable().ajax.reload(null,!1),d(!1)},[]),v=async l=>{var p,u;try{const i=await N.get(route("brand.edit",l));i.data.success===!0?(x(i.data.brand),d(!0)):y.error(i.data.message)}catch(i){y.error(((u=(p=i.response)==null?void 0:p.data)==null?void 0:u.message)||"An error occurred")}},g=async l=>{var u;if((await k.fire({title:"Delete Brand?",text:"This cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await N.delete(route("brand.destroy",l)),$("#brandsTable").DataTable().ajax.reload(null,!1),k.fire("Deleted!","Brand has been deleted.","success")}catch(i){let o="Delete failed.";((u=i.response)==null?void 0:u.status)===403&&(o="You don't have permission to delete this brand."),k.fire("Error!",o,"error")}};return e.jsxs(G,{children:[e.jsx(R,{title:"Brands"}),e.jsxs(S,{className:"border-0 rounded-0 shadow-sm",children:[e.jsxs(S.Header,{className:"d-flex justify-content-between align-items-center bg-transparent",children:[e.jsx("h6",{className:"mb-0 fw-semibold",children:"Brands Management"}),e.jsx(O,{children:e.jsxs(b,{variant:"outline-secondary",size:"sm",className:"rounded-1 d-flex align-items-center",onClick:_,children:[e.jsx(M,{className:"me-1"}),"New Brand"]})})]}),e.jsx(S.Body,{className:"px-0",children:e.jsx(P,{bordered:!0,striped:!0,hover:!0,responsive:!0,id:"brandsTable",className:"w-100"})})]}),e.jsx(A,{show:f,onHide:s,brand:a,onSuccess:C})]})}export{de as default};
