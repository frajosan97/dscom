import{j as r,r as d}from"./app-Bf6XjMin.js";import{a as g}from"./helpers-BvGx6l4I.js";import{f as v,q as S,r as b,h as D}from"./index-Bpn9xGpQ.js";import{C as j}from"./Card-BnYslkqX.js";import{T as I}from"./Tabs-QYV2KLVt.js";import{T as w}from"./Tab-DJN0NYNc.js";import{T as B}from"./Table-C6uxQ5h8.js";import{B as x}from"./Image-SIlH0Fxf.js";import{b as y}from"./Form-CBfDXdOv.js";const H=({paymentData:N,setPaymentData:u})=>{const o={cash:{icon:r.jsx(b,{className:"me-2"}),label:"Cash",fields:{date:{type:"date",placeholder:"Date"},name:{type:"text",placeholder:"Name"},phone:{type:"text",placeholder:"Phone Number"},amount:{type:"number",placeholder:"Amount"}},required:{name:"Name is required",phone:"Valid phone number is required",amount:"Valid amount is required"}},mpesa:{icon:r.jsx(b,{className:"me-2"}),label:"M-Pesa",fields:{date:{type:"date",placeholder:"Date"},transId:{type:"text",placeholder:"Transaction ID"},name:{type:"text",placeholder:"Name"},phone:{type:"text",placeholder:"Phone Number"},amount:{type:"number",placeholder:"Amount"}},required:{transId:"Transaction ID is required",name:"Name is required",phone:"Valid phone number is required",amount:"Valid amount is required"}},cheque:{icon:r.jsx(S,{className:"me-2"}),label:"Cheque",fields:{date:{type:"date",placeholder:"Date"},bankName:{type:"text",placeholder:"Bank Name"},branch:{type:"text",placeholder:"Branch"},chequeNo:{type:"text",placeholder:"Cheque No"},account:{type:"text",placeholder:"Account"},amount:{type:"number",placeholder:"Amount"}},required:{chequeNo:"Cheque number is required",bankName:"Bank name is required",account:"Account is required",branch:"Branch is required",amount:"Valid amount is required"}}},m=Object.fromEntries(Object.entries(o).map(([e,t])=>[e,Object.fromEntries(Object.keys(t.fields).map(s=>[s,s==="date"?new Date().toISOString().split("T")[0]:""]))])),[l,p]=d.useState(m),[c,h]=d.useState({}),f=Object.keys(o)[0]||null,[q,F]=d.useState(f),T=(e,t,s)=>{p(a=>({...a,[e]:{...a[e],[t]:s}})),c[`${e}_${t}`]&&h(a=>({...a,[`${e}_${t}`]:""}))},$=e=>{const t=l[e],s=o[e].required,a={};for(const[n,i]of Object.entries(s))(!t[n]||n==="amount"&&parseFloat(t[n])<=0)&&(a[`${e}_${n}`]=i),n==="phone"&&t.phone&&t.phone.length<10&&(a[`${e}_${n}`]=i);return h(a),Object.keys(a).length===0},C=e=>{if(!$(e))return;const t=l[e],s={id:Date.now(),...t,amount:parseFloat(t.amount)};u(a=>({...a,[e]:[...a[e]||[],s],balanceAccount:a.balanceAccount+s.amount})),p(a=>({...a,[e]:{...m[e],date:new Date().toISOString().split("T")[0]}}))},O=(e,t)=>{u(s=>{const a=s[e].find(n=>n.id===t);return{...s,[e]:s[e].filter(n=>n.id!==t),balanceAccount:s.balanceAccount-((a==null?void 0:a.amount)||0)}})},k=e=>{const t=l[e],s=o[e].fields;return Object.entries(s).map(([a,n])=>r.jsxs("td",{className:"p-1",children:[r.jsx(y,{type:n.type,placeholder:n.placeholder,value:t[a],onChange:i=>T(e,a,i.target.value),className:"rounded-0",isInvalid:!!c[`${e}_${a}`]}),c[`${e}_${a}`]&&r.jsx(y.Feedback,{type:"invalid",children:c[`${e}_${a}`]})]},a))},A=e=>{const t=N[e]||[],s=Object.keys(o[e].fields);return t.length>0?t.map(a=>r.jsxs("tr",{children:[s.map(n=>r.jsx("td",{children:n==="amount"?g(a[n]):a[n]},n)),r.jsx("td",{children:r.jsx(x,{variant:"danger",size:"sm",className:"rounded-0",onClick:()=>O(e,a.id),children:r.jsx(D,{})})})]},a.id)):r.jsx("tr",{children:r.jsx("td",{colSpan:s.length+1,className:"text-center",children:"No transactions found"})})};return r.jsx(j,{className:"border-0 rounded-0 shadow-sm mt-2",children:r.jsx(j.Body,{children:r.jsx(I,{activeKey:q,onSelect:F,transition:!1,children:Object.entries(o).map(([e,t])=>r.jsx(w,{eventKey:e,title:r.jsxs(r.Fragment,{children:[t.icon,t.label]}),children:r.jsxs(B,{striped:!0,responsive:!0,bordered:!0,hover:!0,size:"sm",className:"mt-3",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[Object.keys(t.fields).map(s=>r.jsx("th",{children:t.fields[s].placeholder},s)),r.jsx("th",{children:"Action"})]})}),r.jsxs("tbody",{children:[A(e),r.jsxs("tr",{className:"bg-light",children:[k(e),r.jsx("td",{className:"p-1",style:{width:"1px"},children:r.jsx(x,{variant:"success",className:"rounded-0",onClick:()=>C(e),children:r.jsx(v,{})})})]})]})]})},e))})})})};export{H as P};
