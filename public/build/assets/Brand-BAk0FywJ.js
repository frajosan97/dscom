import{r as x,j as e,$ as V}from"./app-BHgsMdMN.js";import{E as Y}from"./ErpLayout-BrY7BVt6.js";import{u as z}from"./formik.esm-DTi6m-CK.js";import{c as A,d as O,f as N,b as F}from"./index.esm-CWCVgkP0.js";import{M as C}from"./Modal-DO71Vgag.js";import{F as a,C as n}from"./Form-C31rj1ON.js";import{R as I,I as d}from"./Footer-D2ooF5pp.js";import{B as T,C as H}from"./Image-DXsOGyib.js";import{S as P}from"./Spinner-C-7Qdq2i.js";import{S as o}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{x as k}from"./axios-C1gTDpqO.js";import{B as W}from"./ButtonGroup-uLXoY3tg.js";import{C as L}from"./Card-DbtgvX4L.js";import{T as X}from"./Table-D7zmiFHo.js";/* empty css                      */import"./hoist-non-react-statics.cjs-C-Qo8PK8.js";import"./CloseButton-qahUCrdS.js";const J=A().shape({name:F().required("Brand name is required").max(255,"Brand name must not exceed 255 characters"),slug:F().max(255,"Slug must not exceed 255 characters"),is_active:N(),is_featured:N(),order:O().integer("Must be an integer")});function K({showModal:B,setShowModal:u,formData:r,handleInputChange:m,handleFileChange:y,handleSubmit:_,isSubmitting:l}){const s=z({initialValues:{id:(r==null?void 0:r.id)||"",name:(r==null?void 0:r.name)||"",slug:(r==null?void 0:r.slug)||"",description:(r==null?void 0:r.description)||"",meta_title:(r==null?void 0:r.meta_title)||"",meta_description:(r==null?void 0:r.meta_description)||"",logo:(r==null?void 0:r.logo)||null,website_url:(r==null?void 0:r.website_url)||"",facebook_url:(r==null?void 0:r.facebook_url)||"",instagram_url:(r==null?void 0:r.instagram_url)||"",twitter_url:(r==null?void 0:r.twitter_url)||"",is_active:(r==null?void 0:r.is_active)!==void 0?r.is_active:!0,is_featured:(r==null?void 0:r.is_featured)!==void 0?r.is_featured:!1,order:(r==null?void 0:r.order)||0},validationSchema:J,enableReinitialize:!0,onSubmit:b=>{_(b)}});return x.useEffect(()=>{r&&s.setValues({...s.values,...r,is_active:r.is_active!==void 0?r.is_active:!0,is_featured:r.is_featured!==void 0?r.is_featured:!1})},[r]),e.jsx(C,{centered:!0,show:B,onHide:()=>{l||(u(!1),s.resetForm())},backdrop:l?"static":!0,keyboard:!l,size:"lg",children:e.jsxs(a,{onSubmit:s.handleSubmit,noValidate:!0,children:[e.jsx(C.Header,{closeButton:!l,children:e.jsx(C.Title,{children:r.id?"Edit Brand":"Create Brand"})}),e.jsx(C.Body,{children:e.jsxs(I,{children:[e.jsx(n,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsxs(a.Label,{children:["Brand Name"," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(d,{children:[e.jsx(d.Text,{children:e.jsx("i",{className:"bi bi-tag"})}),e.jsx(a.Control,{type:"text",name:"name",value:s.values.name,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.name&&!!s.errors.name,disabled:l,required:!0}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.name})]})]})}),e.jsx(n,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Slug"}),e.jsxs(d,{children:[e.jsx(d.Text,{children:e.jsx("i",{className:"bi bi-link-45deg"})}),e.jsx(a.Control,{type:"text",name:"slug",value:s.values.slug,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.slug&&!!s.errors.slug,disabled:l}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.slug})]})]})}),e.jsx(n,{md:12,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Description"}),e.jsx(a.Control,{as:"textarea",rows:3,name:"description",value:s.values.description,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.description&&!!s.errors.description,disabled:l}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.description})]})}),e.jsx(n,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Logo"}),e.jsx(a.Control,{type:"file",accept:"image/*",onChange:b=>{s.setFieldValue("logo",b.target.files[0]),y(b)},disabled:l}),s.values.logo&&typeof s.values.logo=="string"&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:s.values.logo,alt:"Current logo",className:"img-thumbnail",width:100})})]})}),e.jsx(n,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Order"}),e.jsx(a.Control,{type:"number",name:"order",value:s.values.order,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.order&&!!s.errors.order,disabled:l}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.order})]})}),e.jsx(n,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Website URL"}),e.jsxs(d,{children:[e.jsx(d.Text,{children:e.jsx("i",{className:"bi bi-globe"})}),e.jsx(a.Control,{type:"text",name:"website_url",value:s.values.website_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.website_url&&!!s.errors.website_url}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.website_url})]})]})}),e.jsx(n,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Facebook URL"}),e.jsxs(d,{children:[e.jsx(d.Text,{children:e.jsx("i",{className:"bi bi-facebook"})}),e.jsx(a.Control,{type:"text",name:"facebook_url",value:s.values.facebook_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.facebook_url&&!!s.errors.facebook_url}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.facebook_url})]})]})}),e.jsx(n,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Instagram URL"}),e.jsxs(d,{children:[e.jsx(d.Text,{children:e.jsx("i",{className:"bi bi-instagram"})}),e.jsx(a.Control,{type:"text",name:"instagram_url",value:s.values.instagram_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.instagram_url&&!!s.errors.instagram_url}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.instagram_url})]})]})}),e.jsx(n,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Twitter URL"}),e.jsxs(d,{children:[e.jsx(d.Text,{children:e.jsx("i",{className:"bi bi-twitter"})}),e.jsx(a.Control,{type:"text",name:"twitter_url",value:s.values.twitter_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.twitter_url&&!!s.errors.twitter_url}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.twitter_url})]})]})}),e.jsx(n,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Meta Title"}),e.jsx(a.Control,{type:"text",name:"meta_title",value:s.values.meta_title,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.meta_title&&!!s.errors.meta_title}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.meta_title})]})}),e.jsx(n,{md:6,children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Meta Description"}),e.jsx(a.Control,{as:"textarea",rows:2,name:"meta_description",value:s.values.meta_description,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.meta_description&&!!s.errors.meta_description}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.meta_description})]})}),e.jsx(n,{md:6,children:e.jsx(a.Group,{className:"mb-3",children:e.jsx(a.Check,{type:"switch",id:"is_active",name:"is_active",label:"Active",checked:s.values.is_active,onChange:s.handleChange,disabled:l})})}),e.jsx(n,{md:6,children:e.jsx(a.Group,{className:"mb-3",children:e.jsx(a.Check,{type:"switch",id:"is_featured",name:"is_featured",label:"Featured",checked:s.values.is_featured,onChange:s.handleChange,disabled:l})})})]})}),e.jsxs(C.Footer,{children:[e.jsx(T,{variant:"outline-danger",onClick:()=>{u(!1),s.resetForm()},disabled:l,children:"Cancel"}),e.jsx(T,{variant:"outline-light",type:"submit",disabled:l||!s.isValid,children:l?e.jsxs(e.Fragment,{children:[e.jsx(P,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),e.jsx("span",{className:"ms-2",children:r.id?"Updating...":"Creating..."})]}):r.id?"Update":"Create"})]})]})})}const G=()=>({id:"",name:"",slug:"",description:"",meta_title:"",meta_description:"",logo:null,website_url:"",facebook_url:"",instagram_url:"",twitter_url:"",is_active:!1,is_featured:!1,order:0});function be(){const[B,u]=x.useState(!1),[r,m]=x.useState(G()),[y,_]=x.useState(!1),l=x.useCallback(()=>{$.fn.DataTable.isDataTable("#brandsTable")&&$("#brandsTable").DataTable().ajax.reload(null,!1)},[]),s=x.useCallback(()=>{$.fn.DataTable.isDataTable("#brandsTable")&&$("#brandsTable").DataTable().destroy(),$("#brandsTable").DataTable({processing:!0,serverSide:!0,ajax:{url:route("brand.index"),type:"GET",headers:{"X-Requested-With":"XMLHttpRequest"}},columns:[{data:"name",title:"Brand Name"},{data:"slug",title:"Slug"},{data:"logo",title:"Logo"},{data:"status_badge",title:"Status"},{data:"featured_badge",title:"Featured"},{data:"action",title:"Actions",orderable:!1}],drawCallback:()=>{$(".edit-btn").off("click").on("click",function(){const t=$(this).data("id");R(t)}),$(".delete-btn").off("click").on("click",function(){const t=$(this).data("id");S(t)})}})},[]),b=t=>{const{name:i,value:g,type:p,checked:h}=t.target;m(v=>({...v,[i]:p==="checkbox"?h:g}))},E=t=>{m(i=>({...i,logo:t.target.files[0]}))},M=()=>{m(G()),u(!0)},R=async t=>{try{const i=await k.get(route("brand.edit",t));m({...i.data,is_active:!!i.data.is_active,is_featured:!!i.data.is_featured}),u(!0)}catch{o.fire("Error","Failed to load brand data.","error")}},S=async t=>{var g;if((await o.fire({title:"Delete Brand?",text:"This cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await k.delete(route("brand.destroy",t)),l(),o.fire("Deleted!","Brand has been deleted.","success")}catch(p){let h="Delete failed.";((g=p.response)==null?void 0:g.status)===403&&(h="You don't have permission to delete this brand."),o.fire("Error!",h,"error")}},U=async t=>{var p,h,v,f;const i=!!t.id;if((await o.fire({title:i?"Update brand?":"Create brand?",text:i?"Are you sure you want to update this brand?":"Are you sure you want to create a new brand?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:i?"Yes, update it!":"Yes, create it!"})).isConfirmed){_(!0),o.fire({icon:"info",title:"Processing...",text:"Please wait...",allowOutsideClick:!1,showConfirmButton:!1,didOpen:()=>o.showLoading()});try{const c=new FormData;Object.entries(t).forEach(([q,w])=>{w!=null&&c.append(q,w)}),i&&c.append("_method","put");const j=i?route("brand.update",t.id):route("brand.store");await k.post(j,c,{headers:{"Content-Type":"multipart/form-data"}}),u(!1),l(),o.fire("Success",`Brand ${i?"updated":"created"} successfully.`,"success")}catch(c){let j="Failed to save brand.";(h=(p=c.response)==null?void 0:p.data)!=null&&h.message?j=c.response.data.message:((v=c.response)==null?void 0:v.status)===422?j="Validation error. Please check your input.":((f=c.response)==null?void 0:f.status)===403&&(j="You don't have permission to perform this action."),o.fire("Error",j,"error")}finally{_(!1)}}};return x.useEffect(()=>(s(),()=>{$.fn.DataTable.isDataTable("#brandsTable")&&$("#brandsTable").DataTable().destroy()}),[s]),e.jsxs(Y,{children:[e.jsx(V,{title:"Brands"}),e.jsxs(H,{children:[e.jsxs(I,{className:"g-3",children:[e.jsxs(n,{md:12,className:"d-flex justify-content-between align-items-center",children:[e.jsx("h2",{className:"mb-0",children:"Brands"}),e.jsx(W,{className:"gap-2",children:e.jsxs(T,{variant:"outline-primary",className:"rounded",onClick:M,children:[e.jsx("i",{className:"bi bi-plus-circle"})," Create Brand"]})})]}),e.jsx(n,{md:12,children:e.jsx("hr",{className:"dashed-hr"})}),e.jsx(n,{md:12,children:e.jsx(L,{children:e.jsx(L.Body,{children:e.jsx(X,{bordered:!0,striped:!0,hover:!0,responsive:!0,id:"brandsTable",className:"w-100"})})})})]}),e.jsx(K,{showModal:B,setShowModal:u,formData:r,handleInputChange:b,handleFileChange:E,handleSubmit:U,isSubmitting:y})]})]})}export{be as default};
