import{r as m,j as e,$ as F}from"./app-C8okO_FY.js";import{y as c,R as k,I as i}from"./Footer-DnT14h8L.js";import{d as R}from"./index-KQAv9TcM.js";import{E}from"./ErpLayout-enYR1Bf_.js";import{S as y}from"./sweetalert2.esm.all-DpIEGYsy.js";import{x as N}from"./axios-CrvAxd_j.js";import{u as M}from"./formik.esm-BfHSEgFn.js";import{c as G,d as D,b as I,a as d}from"./index.esm-Dfr3_SDK.js";import{M as j}from"./Modal-DFnRobbl.js";import{F as a,C as g}from"./Form-WKlbRvmM.js";import{I as U,B as _}from"./Image-eY5NvQ05.js";import{S as z}from"./Spinner-DGBawsTY.js";import{C as S}from"./Card-CMRoatnC.js";import{B as q}from"./ButtonGroup-D0OsDQls.js";import{T as A}from"./Table-BgGj5UP2.js";import"./CloseButton-B9TEQAOu.js";import"./iconBase-ClMMaQi3.js";/* empty css                      */const O=()=>({showErrorToast:m.useCallback(o=>{var u;if((u=o.response)!=null&&u.data){const{data:t}=o.response;t.errors?Object.values(t.errors).forEach(h=>{h.forEach(n=>{c.error(n)})}):t.message?c.error(t.message):c.error("An unexpected error occurred")}else o.message?c.error(o.message):c.error("An unknown error occurred")},[])});function P({show:b,onSuccess:o,onHide:u,brand:t}){const{showErrorToast:h}=O(),n=!!t,C=G().shape({name:d().required("Brand name is required").max(255,"Brand name must not exceed 255 characters"),slug:d().max(255,"Slug must not exceed 255 characters"),description:d().nullable(),meta_title:d().nullable(),meta_description:d().nullable(),website_url:d().url("Must be a valid URL").nullable(),facebook_url:d().url("Must be a valid URL").nullable(),instagram_url:d().url("Must be a valid URL").nullable(),twitter_url:d().url("Must be a valid URL").nullable(),is_active:I(),is_featured:I(),order:D().integer("Must be an integer")}),s=M({enableReinitialize:!0,initialValues:{name:(t==null?void 0:t.name)||"",slug:(t==null?void 0:t.slug)||"",description:(t==null?void 0:t.description)||"",meta_title:(t==null?void 0:t.meta_title)||"",meta_description:(t==null?void 0:t.meta_description)||"",logo:null,website_url:(t==null?void 0:t.website_url)||"",facebook_url:(t==null?void 0:t.facebook_url)||"",instagram_url:(t==null?void 0:t.instagram_url)||"",twitter_url:(t==null?void 0:t.twitter_url)||"",is_active:(t==null?void 0:t.is_active)??!0,is_featured:(t==null?void 0:t.is_featured)??!1,order:(t==null?void 0:t.order)||0,_method:n?"PUT":"POST"},validationSchema:C,onSubmit:async(r,{setSubmitting:p,setErrors:x})=>{try{const l=new FormData;Object.entries(r).forEach(([L,B])=>{B!=null&&l.append(L,B)});const f=n?route("brand.update",t.id):route("brand.store"),T=await N.post(f,l,{headers:{"Content-Type":"multipart/form-data"}});T.data.success===!0&&(c.success(T.data.message),o(),u())}catch(l){h(l)}finally{p(!1)}}}),v=r=>{s.setFieldValue("logo",r.target.files[0])},w=()=>{s.setFieldValue("logo",null)};return e.jsxs(j,{show:b,onHide:u,size:"lg",centered:!0,backdrop:"static",children:[e.jsx(j.Header,{closeButton:!0,children:e.jsx(j.Title,{children:n?"Edit Brand":"Create New Brand"})}),e.jsxs(a,{onSubmit:s.handleSubmit,children:[e.jsx(j.Body,{children:e.jsxs(k,{children:[e.jsxs(g,{md:8,children:[e.jsxs(a.Group,{className:"mb-3",controlId:"name",children:[e.jsxs(a.Label,{children:["Brand Name"," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx("i",{className:"bi bi-tag"})}),e.jsx(a.Control,{type:"text",name:"name",value:s.values.name,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.name&&!!s.errors.name,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.name})]})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"slug",children:[e.jsx(a.Label,{children:"Slug"}),e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx("i",{className:"bi bi-link-45deg"})}),e.jsx(a.Control,{type:"text",name:"slug",value:s.values.slug,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.slug&&!!s.errors.slug,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.slug})]})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"description",children:[e.jsx(a.Label,{children:"Description"}),e.jsx(a.Control,{as:"textarea",rows:3,name:"description",value:s.values.description,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.description&&!!s.errors.description,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.description})]}),e.jsxs(k,{children:[e.jsx(g,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"website_url",children:[e.jsx(a.Label,{children:"Website URL"}),e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx("i",{className:"bi bi-globe"})}),e.jsx(a.Control,{type:"url",name:"website_url",value:s.values.website_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.website_url&&!!s.errors.website_url,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.website_url})]})]})}),e.jsx(g,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"order",children:[e.jsx(a.Label,{children:"Order"}),e.jsx(a.Control,{type:"number",name:"order",value:s.values.order,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.order&&!!s.errors.order,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.order})]})})]}),e.jsxs(k,{children:[e.jsx(g,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"facebook_url",children:[e.jsx(a.Label,{children:"Facebook URL"}),e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx("i",{className:"bi bi-facebook"})}),e.jsx(a.Control,{type:"url",name:"facebook_url",value:s.values.facebook_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.facebook_url&&!!s.errors.facebook_url,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.facebook_url})]})]})}),e.jsx(g,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"instagram_url",children:[e.jsx(a.Label,{children:"Instagram URL"}),e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx("i",{className:"bi bi-instagram"})}),e.jsx(a.Control,{type:"url",name:"instagram_url",value:s.values.instagram_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.instagram_url&&!!s.errors.instagram_url,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.instagram_url})]})]})})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"twitter_url",children:[e.jsx(a.Label,{children:"Twitter URL"}),e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx("i",{className:"bi bi-twitter"})}),e.jsx(a.Control,{type:"url",name:"twitter_url",value:s.values.twitter_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.twitter_url&&!!s.errors.twitter_url,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.twitter_url})]})]})]}),e.jsxs(g,{md:4,children:[e.jsxs(a.Group,{className:"mb-3",controlId:"logo",children:[e.jsx(a.Label,{children:"Brand Logo"}),e.jsx(a.Control,{type:"file",accept:"image/*",onChange:v,disabled:s.isSubmitting}),(s.values.logo||(t==null?void 0:t.logo_url))&&e.jsxs("div",{className:"mt-3 text-center",children:[e.jsx(U,{src:typeof s.values.logo=="string"?s.values.logo:s.values.logo?URL.createObjectURL(s.values.logo):t==null?void 0:t.logo_url,alt:"Logo Preview",fluid:!0,thumbnail:!0,style:{maxHeight:"150px"}}),e.jsx(_,{variant:"link",size:"sm",className:"text-danger mt-2",onClick:w,disabled:s.isSubmitting,children:"Remove Logo"})]})]}),e.jsx(a.Group,{className:"mb-3",controlId:"is_active",children:e.jsx(a.Check,{type:"switch",id:"is_active",name:"is_active",label:"Active",checked:s.values.is_active,onChange:s.handleChange,disabled:s.isSubmitting})}),e.jsx(a.Group,{className:"mb-3",controlId:"is_featured",children:e.jsx(a.Check,{type:"switch",id:"is_featured",name:"is_featured",label:"Featured",checked:s.values.is_featured,onChange:s.handleChange,disabled:s.isSubmitting})}),e.jsxs(a.Group,{className:"mb-3",controlId:"meta_title",children:[e.jsx(a.Label,{children:"Meta Title"}),e.jsx(a.Control,{type:"text",name:"meta_title",value:s.values.meta_title,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.meta_title&&!!s.errors.meta_title,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.meta_title})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"meta_description",children:[e.jsx(a.Label,{children:"Meta Description"}),e.jsx(a.Control,{as:"textarea",rows:3,name:"meta_description",value:s.values.meta_description,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.meta_description&&!!s.errors.meta_description,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.meta_description})]})]})]})}),e.jsxs(j.Footer,{children:[e.jsx(_,{variant:"secondary",onClick:u,disabled:s.isSubmitting,children:"Cancel"}),e.jsx(_,{variant:"primary",type:"submit",disabled:s.isSubmitting,children:s.isSubmitting?e.jsxs(e.Fragment,{children:[e.jsx(z,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),n?"Updating...":"Creating..."]}):`${n?"Update":"Create"} Brand`})]})]})]})}function de(){const[b,o]=m.useState(!1),[u,t]=m.useState(null),h=m.useCallback(()=>{$.fn.DataTable.isDataTable("#brandsTable")&&$("#brandsTable").DataTable().destroy(),$("#brandsTable").DataTable({processing:!0,serverSide:!0,ajax:{url:route("brand.index"),type:"GET",headers:{"X-Requested-With":"XMLHttpRequest"}},columns:[{data:"logo",name:"logo",title:"Logo"},{data:"name",name:"name",title:"Brand Name"},{data:"slug",name:"slug",title:"Slug"},{data:"status_badge",name:"status_badge",title:"Status"},{data:"featured_badge",name:"featured_badge",title:"Featured"},{data:"action",name:"action",title:"Actions",orderable:!1,searchable:!1,width:"10%"}],order:[[0,"desc"]],drawCallback:()=>{$(".edit-btn").off("click").on("click",function(){const r=$(this).data("id");v(r)}),$(".delete-btn").off("click").on("click",function(){const r=$(this).data("id");w(r)})}})},[]);m.useEffect(()=>{h()},[h]);const n=m.useCallback(()=>{t(null),o(!0)},[]),C=m.useCallback(()=>{o(!1),t(null)},[]),s=m.useCallback(r=>{c.success(r),$("#brandsTable").DataTable().ajax.reload(null,!1),o(!1)},[]),v=async r=>{var p,x;try{const l=await N.get(route("brand.edit",r));l.data.success===!0?(t(l.data.brand),o(!0)):c.error(l.data.message)}catch(l){c.error(((x=(p=l.response)==null?void 0:p.data)==null?void 0:x.message)||"An error occurred")}},w=async r=>{var x;if((await y.fire({title:"Delete Brand?",text:"This cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await N.delete(route("brand.destroy",r)),$("#brandsTable").DataTable().ajax.reload(null,!1),y.fire("Deleted!","Brand has been deleted.","success")}catch(l){let f="Delete failed.";((x=l.response)==null?void 0:x.status)===403&&(f="You don't have permission to delete this brand."),y.fire("Error!",f,"error")}};return e.jsxs(E,{children:[e.jsx(F,{title:"Brands"}),e.jsxs(S,{className:"border-0 rounded-0 shadow-sm",children:[e.jsxs(S.Header,{className:"d-flex justify-content-between align-items-center bg-transparent",children:[e.jsx("h6",{className:"mb-0 fw-semibold",children:"Brands Management"}),e.jsx(q,{children:e.jsxs(_,{variant:"outline-secondary",size:"sm",className:"rounded-1 d-flex align-items-center",onClick:n,children:[e.jsx(R,{className:"me-1"}),"New Brand"]})})]}),e.jsx(S.Body,{className:"px-0",children:e.jsx(A,{bordered:!0,striped:!0,hover:!0,responsive:!0,id:"brandsTable",className:"w-100"})})]}),e.jsx(P,{show:b,onHide:C,brand:u,onSuccess:s})]})}export{de as default};
