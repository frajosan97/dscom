import{r as x,j as e,$ as q}from"./app-rlNx4Iiu.js";import{E as R}from"./ErpLayout-C6UZf7Lx.js";import{B as y,a as B,b,c as X,d as z,e as D,f as K,g as $}from"./index-Cs8bzZAu.js";import{S as M}from"./hoist-non-react-statics.cjs-CiIQoDaf.js";import{R as d,N as C,y as O}from"./Footer-UqFNTOz4.js";import{u as Y}from"./formik.esm-CMUZ3cpK.js";import{c as V,a as J,b as j}from"./index.esm-LX6V2kr2.js";import{x as W}from"./axios-BGSb5e6B.js";import{u as H}from"./useErrorToast-Di2pbtg_.js";import{B as S}from"./Badge-JDmlgAPC.js";import{C as Q,I as Z,B as v}from"./Image-BuCKbu51.js";import{F as s,C as n}from"./Form-lYHRddvs.js";import{T as u}from"./Tab-C6XqvB9Q.js";import{C as r}from"./Card-Xz6cOBHW.js";import{S as ee}from"./Spinner-BbRf1DHU.js";/* empty css                      */import"./iconBase-CNLCoK3g.js";import"./CloseButton-BnZ8vsiJ.js";const o=[{key:"personal",label:"Personal Details",icon:e.jsx(K,{}),color:"#4f46e5"},{key:"address",label:"Address",icon:e.jsx($,{}),color:"#059669"},{key:"financial",label:"Financial",icon:e.jsx(b,{}),color:"#dc2626"},{key:"status",label:"Status & Notes",icon:e.jsx(y,{}),color:"#7c3aed"}],L={first_name:"",last_name:"",email:"",phone:"",alternate_phone:"",date_of_birth:"",profile_image:null,address:"",city:"",state:"",country:"Kenya",postal_code:"",role:"customer",opening_balance:0,balance:0,is_active:!0,description:""},se=V({first_name:j().required("First name is required"),last_name:j().required("Last name is required"),email:j().email("Invalid email"),phone:j().required("Phone number is required"),date_of_birth:J().nullable().required("Date of birth is required")});function Ce({customer:m=null}){const{showErrorToast:F}=H(),c=!!m,[t,f]=x.useState("personal"),[g,w]=x.useState(!1),[N,k]=x.useState((m==null?void 0:m.passport_photo_url)||null),a=Y({initialValues:c?{...L,...m}:L,validationSchema:se,enableReinitialize:!0,onSubmit:async l=>{try{if(!(await M.fire({title:c?"Update Customer?":"Create Customer?",text:c?"This will update the existing customer record.":"You won't be able to revert this action!",icon:"question",showCancelButton:!0,confirmButtonColor:"#4f46e5",cancelButtonColor:"#6b7280",confirmButtonText:c?"Yes, update it!":"Yes, create it!",cancelButtonText:"Cancel",reverseButtons:!0})).isConfirmed)return;w(!0);const p=new FormData;for(const _ in l)p.append(_,l[_]);const h=c?route("customers.update",m.id):route("customers.store"),U="post";c&&p.append("_method","PUT");const ae=await W[U](h,p,{headers:{"Content-Type":"multipart/form-data"}});O.success(c?"Customer updated successfully!":"Customer created successfully!"),window.location.href=route("customers.index")}catch(i){F(i)}finally{w(!1)}}}),P=l=>{const i=l.currentTarget.files[0];i&&(a.setFieldValue("profile_image",i),k(URL.createObjectURL(i)))},T=t===o[0].key,G=t===o[o.length-1].key,I=x.useCallback(()=>{const l=o.findIndex(i=>i.key===t);l<o.length-1&&f(o[l+1].key)},[t]),E=x.useCallback(()=>{const l=o.findIndex(i=>i.key===t);l>0&&f(o[l-1].key)},[t]),A=x.useCallback(()=>a.values.is_active?e.jsxs(S,{bg:"success",className:"fs-6 px-3 py-2",children:[e.jsx(y,{className:"me-1"}),"Active"]}):e.jsx(S,{bg:"secondary",className:"fs-6 px-3 py-2",children:"Inactive"}),[a.values.is_active]);return o.find(l=>l.key===t),e.jsxs(R,{children:[e.jsx(q,{title:c?"Edit Customer":"Create Customer"}),e.jsx(Q,{fluid:!0,className:"py-4",children:e.jsx(s,{onSubmit:a.handleSubmit,encType:"multipart/form-data",children:e.jsx(u.Container,{activeKey:t,onSelect:f,children:e.jsxs(d,{className:"g-4",children:[e.jsx(n,{lg:3,children:e.jsx(r,{className:"shadow-sm border-0 h-100",children:e.jsx(r.Body,{children:e.jsx(C,{variant:"pills",className:"flex-column gap-2",children:o.map(({key:l,label:i,icon:p,color:h})=>e.jsx(C.Item,{children:e.jsxs(C.Link,{eventKey:l,className:"d-flex align-items-center py-3 px-3 rounded-3 border-0",style:{backgroundColor:t===l?`${h}15`:"transparent",color:t===l?h:"#6b7280",fontWeight:t===l?"600":"400",borderLeft:t===l?`4px solid ${h}`:"4px solid transparent"},children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3",style:{width:"40px",height:"40px",backgroundColor:t===l?h:"#f3f4f6",color:t===l?"white":"#9ca3af"},children:p}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold",children:i}),e.jsxs("small",{className:"opacity-75",children:[l==="personal"&&"Basic information",l==="address"&&"Location details",l==="financial"&&"Payment & balance",l==="status"&&"Status & notes"]})]})]})},l))})})})}),e.jsx(n,{lg:9,children:e.jsxs(r,{className:"shadow-sm border-0",children:[e.jsx(r.Body,{children:e.jsxs(u.Content,{children:[e.jsx(u.Pane,{eventKey:"personal",children:e.jsxs(d,{className:"g-4",children:[e.jsx(n,{md:4,lg:3,children:e.jsx(r,{className:"border-0 bg-light",children:e.jsxs(r.Body,{className:"text-center p-4",children:[e.jsx("div",{className:"mb-3",children:N?e.jsx(Z,{src:N,roundedCircle:!0,fluid:!0,className:"border shadow-sm",style:{width:140,height:140,objectFit:"cover"}}):e.jsx("div",{className:"border rounded-circle d-flex justify-content-center align-items-center bg-white mx-auto",style:{width:140,height:140},children:e.jsx(B,{size:50,className:"text-muted"})})}),e.jsxs(s.Group,{children:[e.jsxs(s.Label,{className:"btn btn-outline-primary btn-sm w-100 cursor-pointer mb-0",htmlFor:"profile_image",children:[e.jsx(B,{className:"me-2"}),N?"Change Photo":"Upload Photo"]}),e.jsx(s.Control,{type:"file",id:"profile_image",name:"profile_image",accept:"image/*",onChange:P,className:"d-none"})]}),e.jsx("div",{className:"small text-muted mt-2",children:"JPG, PNG or GIF. Max 2MB."})]})})}),e.jsx(n,{md:8,lg:9,children:e.jsxs(d,{className:"g-3",children:[e.jsx(n,{md:6,children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-semibold",children:"First Name *"}),e.jsx(s.Control,{name:"first_name",value:a.values.first_name,onChange:a.handleChange,isInvalid:a.touched.first_name&&!!a.errors.first_name,placeholder:"Enter first name",className:"py-2"}),e.jsx(s.Control.Feedback,{type:"invalid",children:a.errors.first_name})]})}),e.jsx(n,{md:6,children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-semibold",children:"Last Name *"}),e.jsx(s.Control,{name:"last_name",value:a.values.last_name,onChange:a.handleChange,isInvalid:a.touched.last_name&&!!a.errors.last_name,placeholder:"Enter last name",className:"py-2"}),e.jsx(s.Control.Feedback,{type:"invalid",children:a.errors.last_name})]})}),e.jsx(n,{md:6,children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-semibold",children:"Email Address"}),e.jsx(s.Control,{type:"email",name:"email",value:a.values.email,onChange:a.handleChange,isInvalid:a.touched.email&&!!a.errors.email,placeholder:"customer@example.com",className:"py-2"}),e.jsx(s.Control.Feedback,{type:"invalid",children:a.errors.email})]})}),e.jsx(n,{md:6,children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-semibold",children:"Phone Number *"}),e.jsx(s.Control,{name:"phone",value:a.values.phone,onChange:a.handleChange,isInvalid:a.touched.phone&&!!a.errors.phone,placeholder:"+254 XXX XXX XXX",className:"py-2"}),e.jsx(s.Control.Feedback,{type:"invalid",children:a.errors.phone})]})}),e.jsx(n,{md:6,children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-semibold",children:"Alternate Phone"}),e.jsx(s.Control,{name:"alternate_phone",value:a.values.alternate_phone,onChange:a.handleChange,placeholder:"Optional phone number",className:"py-2"})]})}),e.jsx(n,{md:6,children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-semibold",children:"Date of Birth *"}),e.jsx(s.Control,{type:"date",name:"date_of_birth",value:a.values.date_of_birth,onChange:a.handleChange,isInvalid:a.touched.date_of_birth&&!!a.errors.date_of_birth,className:"py-2"}),e.jsx(s.Control.Feedback,{type:"invalid",children:a.errors.date_of_birth})]})})]})})]})}),e.jsx(u.Pane,{eventKey:"address",children:e.jsxs(d,{className:"g-4",children:[e.jsx(n,{md:12,children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-semibold",children:"Street Address"}),e.jsx(s.Control,{as:"textarea",rows:3,name:"address",value:a.values.address,onChange:a.handleChange,placeholder:"Enter complete street address",className:"py-2"})]})}),e.jsx(n,{md:4,children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-semibold",children:"City"}),e.jsx(s.Control,{name:"city",value:a.values.city,onChange:a.handleChange,placeholder:"Enter city",className:"py-2"})]})}),e.jsx(n,{md:4,children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-semibold",children:"State/Region"}),e.jsx(s.Control,{name:"state",value:a.values.state,onChange:a.handleChange,placeholder:"Enter state or region",className:"py-2"})]})}),e.jsx(n,{md:4,children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-semibold",children:"Postal Code"}),e.jsx(s.Control,{name:"postal_code",value:a.values.postal_code,onChange:a.handleChange,placeholder:"Postal code",className:"py-2"})]})}),e.jsx(n,{md:6,children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-semibold",children:"Country"}),e.jsx(s.Control,{name:"country",value:a.values.country,onChange:a.handleChange,placeholder:"Country",className:"py-2"})]})}),e.jsx(n,{md:6,children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-semibold",children:"Customer Type"}),e.jsxs(s.Select,{name:"role",value:a.values.role,onChange:a.handleChange,className:"py-2",children:[e.jsx("option",{value:"customer",children:"Customer"}),e.jsx("option",{value:"supplier",children:"Supplier"}),e.jsx("option",{value:"agent",children:"Agent"})]})]})})]})}),e.jsx(u.Pane,{eventKey:"financial",children:e.jsxs(d,{className:"g-4",children:[e.jsx(n,{lg:8,children:e.jsxs(d,{className:"g-4",children:[e.jsx(n,{md:6,children:e.jsx(r,{className:"border-0 bg-light h-100",children:e.jsxs(r.Body,{className:"p-4",children:[e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3",style:{width:"48px",height:"48px",backgroundColor:"#dc2626",color:"white"},children:e.jsx(b,{size:20})}),e.jsxs("div",{children:[e.jsx("h6",{className:"fw-bold mb-0",children:"Opening Balance"}),e.jsx("small",{className:"text-muted",children:"Initial account balance"})]})]}),e.jsx(s.Group,{children:e.jsx(s.Control,{type:"number",name:"opening_balance",value:a.values.opening_balance,onChange:a.handleChange,placeholder:"0.00",className:"py-2 border-0 bg-white shadow-sm"})})]})})}),e.jsx(n,{md:6,children:e.jsx(r,{className:"border-0 bg-light h-100",children:e.jsxs(r.Body,{className:"p-4",children:[e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3",style:{width:"48px",height:"48px",backgroundColor:"#059669",color:"white"},children:e.jsx(b,{size:20})}),e.jsxs("div",{children:[e.jsx("h6",{className:"fw-bold mb-0",children:"Current Balance"}),e.jsx("small",{className:"text-muted",children:"Updated balance"})]})]}),e.jsx(s.Group,{children:e.jsx(s.Control,{type:"number",name:"balance",value:a.values.balance,onChange:a.handleChange,placeholder:"0.00",className:"py-2 border-0 bg-white shadow-sm"})})]})})})]})}),e.jsx(n,{lg:4,children:e.jsx(r,{className:"border-0 bg-warning bg-opacity-10 h-100",children:e.jsxs(r.Body,{className:"p-4",children:[e.jsxs("h6",{className:"fw-bold text-warning mb-3",children:[e.jsx(b,{className:"me-2"}),"Financial Information"]}),e.jsx("p",{className:"small text-muted mb-0",children:"Set the initial and current balance for this customer. These values will be used for accounting and reporting purposes."})]})})})]})}),e.jsx(u.Pane,{eventKey:"status",children:e.jsxs(d,{className:"g-4",children:[e.jsxs(n,{lg:8,children:[e.jsx(r,{className:"border-0 bg-light",children:e.jsxs(r.Body,{className:"p-4",children:[e.jsx("h6",{className:"fw-bold mb-3",children:"Customer Status"}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between p-3 bg-white rounded-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold",children:"Account Status"}),e.jsx("small",{className:"text-muted",children:a.values.is_active?"This customer is active and can transact":"This customer is inactive and cannot transact"})]}),e.jsx(s.Check,{type:"switch",id:"is_active",name:"is_active",checked:a.values.is_active,onChange:a.handleChange,style:{transform:"scale(1.2)"}})]})]})}),e.jsx(r,{className:"border-0 bg-light mt-4",children:e.jsxs(r.Body,{className:"p-4",children:[e.jsx("h6",{className:"fw-bold mb-3",children:"Additional Notes"}),e.jsxs(s.Group,{children:[e.jsx(s.Label,{className:"fw-semibold",children:"Description / Notes"}),e.jsx(s.Control,{as:"textarea",rows:4,name:"description",value:a.values.description,onChange:a.handleChange,placeholder:"Enter any additional notes or description about this customer...",className:"py-2"}),e.jsx(s.Text,{className:"text-muted",children:"Add any important information that might be useful for your team."})]})]})})]}),e.jsx(n,{lg:4,children:e.jsx(r,{className:"border-0 bg-primary bg-opacity-10",children:e.jsxs(r.Body,{className:"p-4",children:[e.jsxs("h6",{className:"fw-bold text-primary mb-3",children:[e.jsx(y,{className:"me-2"}),"Status Overview"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"small text-muted mb-1",children:"Current Status"}),A()]}),e.jsx("p",{className:"small text-muted mb-0",children:"Active customers can place orders and transact with your business. Inactive customers will be hidden from most operations but their data is preserved."})]})})})]})})]})}),e.jsx(r.Footer,{className:"bg-light border-0 py-4",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs(v,{variant:"outline-secondary",onClick:E,disabled:T||g,className:"px-4 py-2 d-flex align-items-center",children:[e.jsx(X,{className:"me-2",size:18}),"Previous"]}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsxs("span",{className:"text-muted me-3 small",children:["Step"," ",o.findIndex(l=>l.key===t)+1," ","of ",o.length]}),G?e.jsx(v,{variant:"primary",type:"submit",disabled:g,className:"px-4 py-2 d-flex align-items-center",children:g?e.jsxs(e.Fragment,{children:[e.jsx(ee,{animation:"border",size:"sm",className:"me-2"}),c?"Updating...":"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"me-2",size:18}),c?"Update Customer":"Create Customer"]})}):e.jsxs(v,{variant:"primary",onClick:I,className:"px-4 py-2 d-flex align-items-center",children:["Next",e.jsx(D,{className:"ms-2",size:18})]})]})]})})]})})]})})})})]})}export{Ce as default};
