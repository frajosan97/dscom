import{q as U,u as H,r as o,j as e,$ as Q,Y as x,m as V}from"./app-OHbyyb7G.js";import{A as G}from"./AppLayout-D1ZAe76G.js";import{a0 as z,a1 as M,w as E,a2 as J,u as W,a3 as X,a4 as Z,J as ee,a5 as q,H as se,L as ae}from"./index-_baQgAt6.js";import{x as te}from"./axios-CwqzNN1P.js";import{a as l}from"./helpers-BWvqPppa.js";import{C as re,B as a,I as le}from"./Image-DjGCkx_G.js";import{C as c}from"./Card-CTI6bRV3.js";import{R as ne}from"./Footer-CdCYi3s-.js";import{C as D,F as j}from"./Form-DD85BSXi.js";import{T as ie}from"./Table-BoWuZrVy.js";import{B as N}from"./Badge-k9Tre4-h.js";import{A}from"./Alert-WeqASaYh.js";import{S as ce}from"./Spinner-RIqUqMyg.js";import"./useData-CAhzdaPP.js";import"./ListGroup-DwMo0Ly9.js";import"./CloseButton-DySoQWw3.js";import"./iconBase-Bz_lrQRY.js";function _e(){const{auth:g}=U().props,{cartItems:p=[],addToCart:de=()=>{},removeFromCart:B=()=>{},updateQuantity:f=()=>{},clearCart:b=()=>{},cartTotal:t=0,itemCount:y=0}=H();console.log(p);const[w,v]=o.useState(!1),[S,n]=o.useState(null),[u,k]=o.useState(""),[i,C]=o.useState(0),[I,Y]=o.useState(0),[P,F]=o.useState(5.99),[h]=o.useState(50),r=t>=h?0:P,K=async()=>{v(!0),n(null);try{if(g!=null&&g.user){const s=await te.post(route("cart.checkout"),{cartItems:p,cartTotal:_,itemCount:y,discount:i,shippingCost:r,couponCode:i>0?u:null});s.status===200&&(Y(s.data.order_number||s.data.orderNumber),v(!1),n("success"),b())}else V.get(route("login"))}catch(s){v(!1),n("error"),console.error("Checkout error:",s)}},L=()=>{if(!u.trim())return;const s=u.toUpperCase();s==="SAVE10"?(C(t*.1),n(null)):s==="FREESHIP"&&t<h?(F(0),n(null)):s==="SAVE20"?(C(Math.min(t*.2,50)),n(null)):n("invalid_coupon")},O=()=>{k(""),C(0),F(5.99),n(null)},_=t-i+r,R=()=>{const s=new Date,d=new Date(s);return d.setDate(s.getDate()+5),d.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})},$=s=>{var d,m,T;return s.image?s.image:(d=s.default_image)!=null&&d.image_path?`/storage/${s.default_image.image_path}`:(T=(m=s.images)==null?void 0:m[0])!=null&&T.image_path?`/storage/${s.images[0].image_path}`:"/images/default-product.jpg"};return e.jsxs(G,{children:[e.jsx(Q,{title:"Your Shopping Cart"}),e.jsx(re,{className:"py-4",children:S==="success"?e.jsx(c,{className:"border-0 shadow-sm py-5",children:e.jsxs(c.Body,{className:"text-center py-5",children:[e.jsx(z,{size:48,className:"text-success mb-3"}),e.jsx("h3",{className:"fw-bold mb-3",children:"Order Placed Successfully!"}),e.jsxs("p",{className:"text-muted mb-4",children:["Thank you for your purchase. Your order number is"," ",e.jsxs("strong",{className:"text-primary",children:["#",I]}),"."]}),e.jsxs("div",{className:"d-flex justify-content-center gap-3",children:[e.jsx(a,{as:x,href:"/",variant:"primary",children:"Continue Shopping"}),e.jsx(a,{as:x,href:route("orders.index"),variant:"outline-primary",children:"View Orders"})]})]})}):p.length===0?e.jsx(c,{className:"border-0 shadow-sm py-5",children:e.jsxs(c.Body,{className:"text-center py-5",children:[e.jsx(M,{size:48,className:"text-muted mb-3"}),e.jsx("h4",{className:"fw-bold mb-3",children:"Your cart is empty"}),e.jsx("p",{className:"text-muted mb-4",children:"Looks like you haven't added any items to your cart yet"}),e.jsx(a,{as:x,href:"/",variant:"primary",size:"lg",children:"Start Shopping"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mb-1",children:"Your Shopping Cart"}),e.jsxs("p",{className:"text-muted mb-0",children:[y," ",y===1?"item":"items"]})]}),e.jsxs(a,{variant:"outline-danger",size:"sm",onClick:b,className:"d-flex align-items-center",children:[e.jsx(E,{className:"me-2"})," Clear Cart"]})]}),e.jsxs(ne,{children:[e.jsxs(D,{lg:8,children:[e.jsx(c,{className:"border-0 shadow-sm mb-4",children:e.jsx(c.Body,{className:"p-0",children:e.jsxs(ie,{responsive:!0,hover:!0,className:"mb-0",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{className:"ps-4",children:"Product"}),e.jsx("th",{className:"text-end",children:"Price"}),e.jsx("th",{className:"text-center",children:"Quantity"}),e.jsx("th",{className:"text-end pe-4",children:"Total"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:p.map(s=>e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{className:"ps-4",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsxs("div",{className:"position-relative me-3",children:[e.jsx(le,{src:$(s),alt:s.name,width:80,height:80,className:"rounded-2 border object-fit-cover",style:{minWidth:"80px",backgroundColor:"#f8f9fa"}}),s.compare_price&&s.compare_price>s.price&&e.jsx(N,{bg:"danger",className:"position-absolute top-0 start-0 translate-middle",children:"Sale"})]}),e.jsxs("div",{children:[e.jsx("h6",{className:"mb-1 fw-semibold",children:e.jsx(x,{className:"text-decoration-none text-dark",children:s.name})}),s.sku&&e.jsx("div",{className:"mb-1",children:e.jsxs("small",{className:"text-muted",children:["SKU:"," ",s.sku]})}),(s.color||s.size||s.material)&&e.jsxs("div",{className:"d-flex flex-wrap gap-2",children:[s.color&&e.jsxs(N,{bg:"light",text:"dark",className:"d-flex align-items-center gap-1",children:[e.jsx("span",{className:"rounded-circle",style:{width:"12px",height:"12px",backgroundColor:s.color}}),s.color]}),s.size&&e.jsx(N,{bg:"light",text:"dark",children:s.size}),s.material&&e.jsx(N,{bg:"light",text:"dark",children:s.material})]})]})]})}),e.jsx("td",{className:"text-end align-middle",children:e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold",children:l(s.price)}),s.compare_price&&s.compare_price>s.price&&e.jsx("div",{className:"text-muted small text-decoration-line-through",children:l(s.compare_price)})]})}),e.jsx("td",{className:"text-center align-middle",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx(a,{variant:"outline-secondary",size:"sm",className:"px-3 py-1 rounded-start",onClick:()=>f(s.id,s.quantity-1,s.variantKey),disabled:s.quantity<=1,children:e.jsx(J,{size:12})}),e.jsx(j.Control,{type:"number",min:"1",max:s.max_quantity||99,value:s.quantity,onChange:d=>{const m=parseInt(d.target.value);!isNaN(m)&&m>0&&f(s.id,m,s.variantKey)},className:"rounded-0 text-center border-start-0 border-end-0",style:{width:"70px"}}),e.jsx(a,{variant:"outline-secondary",size:"sm",className:"px-3 py-1 rounded-end",onClick:()=>f(s.id,s.quantity+1,s.variantKey),disabled:s.max_quantity&&s.quantity>=s.max_quantity,children:e.jsx(W,{size:12})})]})}),e.jsx("td",{className:"text-end align-middle fw-bold pe-4",children:l(s.price*s.quantity)}),e.jsx("td",{className:"text-end align-middle",children:e.jsx(a,{variant:"link",className:"text-danger p-0",onClick:()=>B(s.id,s.variantKey),title:"Remove item",children:e.jsx(E,{size:18})})})]},`${s.id}-${s.variantKey||""}`))})]})})}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsxs(a,{as:x,href:"/",variant:"outline-primary",className:"d-flex align-items-center",children:[e.jsx(X,{className:"me-2"}),"Continue Shopping"]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(a,{variant:"outline-secondary",onClick:b,children:"Clear Cart"}),e.jsx(a,{variant:"secondary",onClick:()=>window.location.reload(),children:"Update Cart"})]})]})]}),e.jsx(D,{lg:4,children:e.jsx(c,{className:"border-0 shadow-sm",style:{top:"20px"},children:e.jsxs(c.Body,{children:[e.jsx("h5",{className:"mb-4 fw-bold",children:"Order Summary"}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{className:"text-muted",children:"Subtotal:"}),e.jsx("span",{className:"fw-semibold",children:l(t)})]}),e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{className:"text-muted",children:"Shipping:"}),e.jsx("span",{className:r===0?"text-success fw-semibold":"",children:r===0?"FREE":l(r)})]}),e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{className:"text-muted",children:"Estimated Tax:"}),e.jsx("span",{children:l(t*.08)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs(j.Group,{controlId:"couponCode",children:[e.jsx(j.Label,{className:"small fw-semibold",children:"Have a coupon?"}),e.jsxs("div",{className:"input-group",children:[e.jsx(j.Control,{type:"text",placeholder:"Enter coupon code",value:u,onChange:s=>{k(s.target.value),n(null)},className:"border-end-0"}),e.jsx(a,{variant:i>0||r===0?"success":"outline-secondary",onClick:i>0||r===0?O:L,className:"border-start-0",children:i>0||r===0?"Applied":"Apply"})]})]}),S==="invalid_coupon"&&e.jsxs(A,{variant:"danger",className:"mt-2 py-2 small",children:[e.jsx(Z,{className:"me-2"}),"Invalid coupon code"]}),(i>0||r===0)&&e.jsxs("div",{className:"mt-2",children:[i>0&&e.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[e.jsxs("span",{className:"text-muted",children:[e.jsx(ee,{className:"me-1"})," ","Discount:"]}),e.jsxs("span",{className:"text-success fw-semibold",children:["-",l(i)]})]}),r===0&&t<h&&e.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[e.jsxs("span",{className:"text-muted",children:[e.jsx(q,{className:"me-1"})," ","Shipping Discount:"]}),e.jsxs("span",{className:"text-success fw-semibold",children:["-",l(5.99)]})]})]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between fw-bold fs-5 mb-4",children:[e.jsx("span",{children:"Grand Total:"}),e.jsx("span",{className:"text-primary",children:l(_)})]})]}),e.jsxs(A,{variant:"info",className:"d-flex align-items-start small",children:[e.jsx(q,{className:"me-2 mt-1"}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold",children:"Free Shipping Available!"}),t>=h?e.jsx("div",{className:"text-success",children:"You've qualified for free shipping!"}):e.jsxs("div",{children:["Spend"," ",l(h-t)," ","more for free shipping"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(se,{className:"me-2 text-muted"}),e.jsx("span",{className:"small text-muted",children:"Estimated Delivery:"})]}),e.jsxs("div",{className:"ps-4",children:[e.jsx("div",{className:"fw-semibold",children:R()}),e.jsx("div",{className:"text-muted small",children:"3-5 business days"})]})]}),e.jsx(a,{variant:"primary",size:"lg",className:"w-100 mb-3 py-3 fw-bold",onClick:K,disabled:w,children:w?e.jsxs(e.Fragment,{children:[e.jsx(ce,{as:"span",animation:"border",size:"sm",className:"me-2"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"me-2"}),"Proceed to Checkout"]})}),e.jsx("div",{className:"text-center",children:e.jsxs("small",{className:"text-muted",children:["or"," ",e.jsx(x,{href:"/",className:"text-decoration-none",children:"continue shopping"})]})}),e.jsxs("div",{className:"mt-3 pt-3 border-top text-center",children:[e.jsxs("div",{className:"small text-muted mb-2",children:[e.jsx(z,{className:"me-1 text-success"}),"Secure payment powered by Stripe"]}),e.jsx("div",{className:"text-muted small",children:"Your payment information is encrypted and secure"})]})]})})})]})]})})]})}export{_e as default};
