import{j as e,r as d,$ as F}from"./app-D3iqUWwb.js";import{R as y,I as i,y as b}from"./Footer-DbC6yI14.js";import{d as R}from"./index-a4ECeyyE.js";import{E as M}from"./ErpLayout-BIYCh-Le.js";import{S as k}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{x as N}from"./axios-CEv2nlh7.js";import{u as G}from"./formik.esm-CYfCehtm.js";import{c as D,d as E,b as I,a as o}from"./index.esm-BrprmfEZ.js";import{u as U}from"./useErrorToast-Dmep0Zzn.js";import{M as g}from"./Modal-Cmg1lugE.js";import{F as a,C as m}from"./Form-K45sZDdk.js";import{I as z,B as f}from"./Image-C5Bjh-OB.js";import{S as q}from"./Spinner-DJKqVyYF.js";import{C as S}from"./Card-mvYCwpRd.js";import{B as O}from"./ButtonGroup-CQHr0Zv8.js";import{T as P}from"./Table-CCaiKpxz.js";import"./CloseButton-B58G4BWO.js";import"./iconBase-BGwI_CQ1.js";/* empty css                      */import"./hoist-non-react-statics.cjs-C-Qo8PK8.js";function A({show:_,onSuccess:c,onHide:h,brand:t}){const{showErrorToast:p}=U(),n=!!t,C=D().shape({name:o().required("Brand name is required").max(255,"Brand name must not exceed 255 characters"),slug:o().max(255,"Slug must not exceed 255 characters"),description:o().nullable(),meta_title:o().nullable(),meta_description:o().nullable(),website_url:o().url("Must be a valid URL").nullable(),facebook_url:o().url("Must be a valid URL").nullable(),instagram_url:o().url("Must be a valid URL").nullable(),twitter_url:o().url("Must be a valid URL").nullable(),is_active:I(),is_featured:I(),order:E().integer("Must be an integer")}),s=G({enableReinitialize:!0,initialValues:{name:(t==null?void 0:t.name)||"",slug:(t==null?void 0:t.slug)||"",description:(t==null?void 0:t.description)||"",meta_title:(t==null?void 0:t.meta_title)||"",meta_description:(t==null?void 0:t.meta_description)||"",logo:null,website_url:(t==null?void 0:t.website_url)||"",facebook_url:(t==null?void 0:t.facebook_url)||"",instagram_url:(t==null?void 0:t.instagram_url)||"",twitter_url:(t==null?void 0:t.twitter_url)||"",is_active:(t==null?void 0:t.is_active)??!0,is_featured:(t==null?void 0:t.is_featured)??!1,order:(t==null?void 0:t.order)||0,_method:n?"PUT":"POST"},validationSchema:C,onSubmit:async(r,{setSubmitting:x,setErrors:u})=>{try{const l=new FormData;Object.entries(r).forEach(([L,w])=>{w!=null&&l.append(L,w)});const j=n?route("brand.update",t.id):route("brand.store"),T=await N.post(j,l,{headers:{"Content-Type":"multipart/form-data"}});T.data.success===!0&&(b.success(T.data.message),c(),h())}catch(l){p(l)}finally{x(!1)}}}),v=r=>{s.setFieldValue("logo",r.target.files[0])},B=()=>{s.setFieldValue("logo",null)};return e.jsxs(g,{show:_,onHide:h,size:"lg",centered:!0,backdrop:"static",children:[e.jsx(g.Header,{closeButton:!0,children:e.jsx(g.Title,{children:n?"Edit Brand":"Create New Brand"})}),e.jsxs(a,{onSubmit:s.handleSubmit,children:[e.jsx(g.Body,{children:e.jsxs(y,{children:[e.jsxs(m,{md:8,children:[e.jsxs(a.Group,{className:"mb-3",controlId:"name",children:[e.jsxs(a.Label,{children:["Brand Name"," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx("i",{className:"bi bi-tag"})}),e.jsx(a.Control,{type:"text",name:"name",value:s.values.name,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.name&&!!s.errors.name,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.name})]})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"slug",children:[e.jsx(a.Label,{children:"Slug"}),e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx("i",{className:"bi bi-link-45deg"})}),e.jsx(a.Control,{type:"text",name:"slug",value:s.values.slug,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.slug&&!!s.errors.slug,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.slug})]})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"description",children:[e.jsx(a.Label,{children:"Description"}),e.jsx(a.Control,{as:"textarea",rows:3,name:"description",value:s.values.description,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.description&&!!s.errors.description,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.description})]}),e.jsxs(y,{children:[e.jsx(m,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"website_url",children:[e.jsx(a.Label,{children:"Website URL"}),e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx("i",{className:"bi bi-globe"})}),e.jsx(a.Control,{type:"url",name:"website_url",value:s.values.website_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.website_url&&!!s.errors.website_url,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.website_url})]})]})}),e.jsx(m,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"order",children:[e.jsx(a.Label,{children:"Order"}),e.jsx(a.Control,{type:"number",name:"order",value:s.values.order,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.order&&!!s.errors.order,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.order})]})})]}),e.jsxs(y,{children:[e.jsx(m,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"facebook_url",children:[e.jsx(a.Label,{children:"Facebook URL"}),e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx("i",{className:"bi bi-facebook"})}),e.jsx(a.Control,{type:"url",name:"facebook_url",value:s.values.facebook_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.facebook_url&&!!s.errors.facebook_url,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.facebook_url})]})]})}),e.jsx(m,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"instagram_url",children:[e.jsx(a.Label,{children:"Instagram URL"}),e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx("i",{className:"bi bi-instagram"})}),e.jsx(a.Control,{type:"url",name:"instagram_url",value:s.values.instagram_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.instagram_url&&!!s.errors.instagram_url,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.instagram_url})]})]})})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"twitter_url",children:[e.jsx(a.Label,{children:"Twitter URL"}),e.jsxs(i,{children:[e.jsx(i.Text,{children:e.jsx("i",{className:"bi bi-twitter"})}),e.jsx(a.Control,{type:"url",name:"twitter_url",value:s.values.twitter_url,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.twitter_url&&!!s.errors.twitter_url,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.twitter_url})]})]})]}),e.jsxs(m,{md:4,children:[e.jsxs(a.Group,{className:"mb-3",controlId:"logo",children:[e.jsx(a.Label,{children:"Brand Logo"}),e.jsx(a.Control,{type:"file",accept:"image/*",onChange:v,disabled:s.isSubmitting}),(s.values.logo||(t==null?void 0:t.logo_url))&&e.jsxs("div",{className:"mt-3 text-center",children:[e.jsx(z,{src:typeof s.values.logo=="string"?s.values.logo:s.values.logo?URL.createObjectURL(s.values.logo):t==null?void 0:t.logo_url,alt:"Logo Preview",fluid:!0,thumbnail:!0,style:{maxHeight:"150px"}}),e.jsx(f,{variant:"link",size:"sm",className:"text-danger mt-2",onClick:B,disabled:s.isSubmitting,children:"Remove Logo"})]})]}),e.jsx(a.Group,{className:"mb-3",controlId:"is_active",children:e.jsx(a.Check,{type:"switch",id:"is_active",name:"is_active",label:"Active",checked:s.values.is_active,onChange:s.handleChange,disabled:s.isSubmitting})}),e.jsx(a.Group,{className:"mb-3",controlId:"is_featured",children:e.jsx(a.Check,{type:"switch",id:"is_featured",name:"is_featured",label:"Featured",checked:s.values.is_featured,onChange:s.handleChange,disabled:s.isSubmitting})}),e.jsxs(a.Group,{className:"mb-3",controlId:"meta_title",children:[e.jsx(a.Label,{children:"Meta Title"}),e.jsx(a.Control,{type:"text",name:"meta_title",value:s.values.meta_title,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.meta_title&&!!s.errors.meta_title,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.meta_title})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"meta_description",children:[e.jsx(a.Label,{children:"Meta Description"}),e.jsx(a.Control,{as:"textarea",rows:3,name:"meta_description",value:s.values.meta_description,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.meta_description&&!!s.errors.meta_description,disabled:s.isSubmitting}),e.jsx(a.Control.Feedback,{type:"invalid",children:s.errors.meta_description})]})]})]})}),e.jsxs(g.Footer,{children:[e.jsx(f,{variant:"secondary",onClick:h,disabled:s.isSubmitting,children:"Cancel"}),e.jsx(f,{variant:"primary",type:"submit",disabled:s.isSubmitting,children:s.isSubmitting?e.jsxs(e.Fragment,{children:[e.jsx(q,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),n?"Updating...":"Creating..."]}):`${n?"Update":"Create"} Brand`})]})]})]})}function ue(){const[_,c]=d.useState(!1),[h,t]=d.useState(null),p=d.useCallback(()=>{$.fn.DataTable.isDataTable("#brandsTable")&&$("#brandsTable").DataTable().destroy(),$("#brandsTable").DataTable({processing:!0,serverSide:!0,ajax:{url:route("brand.index"),type:"GET",headers:{"X-Requested-With":"XMLHttpRequest"}},columns:[{data:"logo",name:"logo",title:"Logo"},{data:"name",name:"name",title:"Brand Name"},{data:"slug",name:"slug",title:"Slug"},{data:"status_badge",name:"status_badge",title:"Status"},{data:"featured_badge",name:"featured_badge",title:"Featured"},{data:"action",name:"action",title:"Actions",orderable:!1,searchable:!1,width:"10%"}],order:[[0,"desc"]],drawCallback:()=>{$(".edit-btn").off("click").on("click",function(){const r=$(this).data("id");v(r)}),$(".delete-btn").off("click").on("click",function(){const r=$(this).data("id");B(r)})}})},[]);d.useEffect(()=>{p()},[p]);const n=d.useCallback(()=>{t(null),c(!0)},[]),C=d.useCallback(()=>{c(!1),t(null)},[]),s=d.useCallback(r=>{b.success(r),$("#brandsTable").DataTable().ajax.reload(null,!1),c(!1)},[]),v=async r=>{var x,u;try{const l=await N.get(route("brand.edit",r));l.data.success===!0?(t(l.data.brand),c(!0)):b.error(l.data.message)}catch(l){b.error(((u=(x=l.response)==null?void 0:x.data)==null?void 0:u.message)||"An error occurred")}},B=async r=>{var u;if((await k.fire({title:"Delete Brand?",text:"This cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await N.delete(route("brand.destroy",r)),$("#brandsTable").DataTable().ajax.reload(null,!1),k.fire("Deleted!","Brand has been deleted.","success")}catch(l){let j="Delete failed.";((u=l.response)==null?void 0:u.status)===403&&(j="You don't have permission to delete this brand."),k.fire("Error!",j,"error")}};return e.jsxs(M,{children:[e.jsx(F,{title:"Brands"}),e.jsxs(S,{className:"border-0 rounded-0 shadow-sm",children:[e.jsxs(S.Header,{className:"d-flex justify-content-between align-items-center bg-transparent",children:[e.jsx("h6",{className:"mb-0 fw-semibold",children:"Brands Management"}),e.jsx(O,{children:e.jsxs(f,{variant:"outline-secondary",size:"sm",className:"rounded-1 d-flex align-items-center",onClick:n,children:[e.jsx(R,{className:"me-1"}),"New Brand"]})})]}),e.jsx(S.Body,{className:"px-0",children:e.jsx(P,{bordered:!0,striped:!0,hover:!0,responsive:!0,id:"brandsTable",className:"w-100"})})]}),e.jsx(A,{show:_,onHide:C,brand:h,onSuccess:s})]})}export{ue as default};
