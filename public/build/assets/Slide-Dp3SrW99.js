import{r as d,j as e,$ as G}from"./app-DdIX6d_6.js";import{F as H}from"./index-CMxOM0nE.js";import{R as q,I as O,y as b}from"./Footer-BYsUKS50.js";import{S as U}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{x as I}from"./axios-UiVjVQIz.js";import{u as X,c as Y,e as M,b as W}from"./index.esm-1MHweraO.js";import{M as T}from"./Modal-DvRX44EJ.js";import{F as y,C as R}from"./Form-D_I3dj_K.js";import{C as w}from"./Card-Dcy67VlY.js";import{B as z}from"./Image-C4wVi4fk.js";import{S as K}from"./Spinner-D5iPbKtW.js";import{E as Q}from"./ErpLayout-CCrlVePp.js";import{B as Z}from"./ButtonGroup-CQW-hObI.js";import{A as ee}from"./Alert-cp0THEGg.js";import{T as te}from"./Table-wPH_v57Z.js";import"./iconBase-Bxk0bmeF.js";import"./CloseButton-DjMRf_Ll.js";import"./hoist-non-react-statics.cjs-C-Qo8PK8.js";/* empty css                      */const D={id:"",name:"",type:"default",is_active:!0,autoplay:!0,arrows:!0,dots:!1,infinite:!0,autoplay_speed:3e3,slides_to_show:1,slides_to_scroll:1,breakpoints:null,custom_settings:null},se=Y().shape({name:W().required("Slider name is required").max(255,"Slider name must not exceed 255 characters"),autoplay_speed:M().integer("Must be an integer").min(500,"Minimum autoplay speed is 500ms"),slides_to_show:M().integer("Must be an integer").min(1,"Minimum slides to show is 1"),slides_to_scroll:M().integer("Must be an integer").min(1,"Minimum slides to scroll is 1")}),re=[{name:"name",label:"Slider Name",type:"text",required:!0,icon:"bi-sliders",colProps:{md:12}},{name:"autoplay_speed",label:"Autoplay Speed (ms)",type:"number",icon:"bi-speedometer2",min:500,step:500,colProps:{md:4}},{name:"slides_to_show",label:"Slides To Show",type:"number",icon:"bi-collection",min:1,colProps:{md:4}},{name:"slides_to_scroll",label:"Slides To Scroll",type:"number",icon:"bi-arrow-left-right",min:1,colProps:{md:4}}],ae=[{id:"autoplay",label:"Autoplay",colProps:{md:6,lg:3}},{id:"arrows",label:"Arrows",colProps:{md:6,lg:3}},{id:"dots",label:"Pagination Dots",colProps:{md:6,lg:3}},{id:"infinite",label:"Infinite Loop",colProps:{md:6,lg:3}},{id:"is_active",label:"Active",colProps:{md:6,lg:3}}];function ie({showModal:L,setShowModal:_,formData:i,handleSubmit:S,isSubmitting:n}){const j=d.useCallback(s=>s?{...D,...s,breakpoints:s.breakpoints?JSON.stringify(s.breakpoints,null,2):"",custom_settings:s.custom_settings?JSON.stringify(s.custom_settings,null,2):""}:D,[]),l=X({initialValues:D,validationSchema:se,enableReinitialize:!0,onSubmit:s=>{const r={...s,breakpoints:s.breakpoints?JSON.parse(s.breakpoints):null,custom_settings:s.custom_settings?JSON.parse(s.custom_settings):null};S(r)}}),f=d.useCallback(()=>{n||(_(!1),l.resetForm())},[n,_,l]);d.useEffect(()=>{i&&l.setValues(j(i))},[i,j]);const N=s=>{const{name:r,label:g,type:x,required:C,icon:A,min:F,step:B,colProps:E}=s,o=l.touched[r]&&!!l.errors[r];return e.jsx(R,{...E,children:e.jsxs(y.Group,{className:"mb-3",children:[e.jsxs(y.Label,{children:[g," ",C&&e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(O,{children:[e.jsx(O.Text,{children:e.jsx("i",{className:`bi ${A}`})}),e.jsx(y.Control,{type:x,name:r,min:F,step:B,value:l.values[r],onChange:l.handleChange,onBlur:l.handleBlur,isInvalid:o,disabled:n,required:C}),e.jsx(y.Control.Feedback,{type:"invalid",children:l.errors[r]})]})]})},r)},k=s=>{const{id:r,label:g,colProps:x}=s;return e.jsx(R,{...x,children:e.jsx(y.Check,{type:"switch",id:r,name:r,label:g,checked:l.values[r],onChange:l.handleChange,disabled:n})},r)},m=n?i!=null&&i.id?"Updating...":"Creating...":i!=null&&i.id?"Update":"Create";return e.jsx(T,{centered:!0,show:L,onHide:f,backdrop:n?"static":!0,keyboard:!n,size:"lg",children:e.jsxs(y,{onSubmit:l.handleSubmit,noValidate:!0,children:[e.jsx(T.Header,{closeButton:!n,children:e.jsx(T.Title,{children:i!=null&&i.id?"Edit Slider":"Create Slider"})}),e.jsx(T.Body,{children:e.jsxs(q,{className:"g-3 mb-3",children:[re.map(N),e.jsx(R,{md:12,children:e.jsx(w,{className:"border-0 shadow-sm",children:e.jsxs(w.Body,{children:[e.jsx(w.Title,{children:"Slider Controls"}),e.jsx(q,{children:ae.map(k)})]})})})]})}),e.jsxs(T.Footer,{children:[e.jsx(z,{variant:"outline-danger",onClick:f,disabled:n,children:"Cancel"}),e.jsxs(z,{variant:"outline-light",type:"submit",disabled:n||!l.isValid,children:[n&&e.jsx(K,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),m]})]})]})})}const V={id:"",name:"",type:"default",is_active:!0,autoplay:!0,autoplay_speed:3e3,arrows:!0,dots:!1,infinite:!0,slides_to_show:1,slides_to_scroll:1,breakpoints:null,custom_settings:null};function Se({showSlider:L}){const[_,i]=d.useState(!1),[S,n]=d.useState(V),[j,l]=d.useState(!1),[f,N]=d.useState(null),[k,m]=d.useState(!0),[s,r]=d.useState(null),g=d.useCallback(()=>{f&&$.fn.DataTable.isDataTable("#slidesTable")&&f.ajax.reload(null,!1)},[f]),x=d.useCallback(()=>{try{$.fn.DataTable.isDataTable("#slidesTable")&&$("#slidesTable").DataTable().destroy();const o=$("#slidesTable").DataTable({processing:!0,serverSide:!0,ajax:{url:route("slider.index"),type:"GET",headers:{"X-Requested-With":"XMLHttpRequest"},dataSrc:function(t){return console.log("Slider DataTable Response:",t),m(!1),r(null),t.error?(r(t.error),[]):t.data||[]},error:function(t,a,c){console.error("DataTable AJAX Error:",a,c),m(!1),r("Failed to load sliders data"),b.error("Failed to load sliders data")}},columns:[{data:"DT_RowIndex",name:"DT_RowIndex",title:"#",orderable:!1,searchable:!1,width:"5%"},{data:"name",name:"name",title:"Slider Name",className:"text-capitalize"},{data:"type",name:"type",title:"Type",render:function(t,a,c){return t?t.charAt(0).toUpperCase()+t.slice(1):"-"}},{data:"items_count",name:"items_count",title:"Items",className:"text-center",render:function(t,a,c){return t||0}},{data:"is_active",name:"is_active",title:"Status",className:"text-center",render:function(t,a,c){return t?'<span class="badge bg-success">Active</span>':'<span class="badge bg-secondary">Inactive</span>'}},{data:"id",name:"action",title:"Actions",orderable:!1,searchable:!1,width:"15%",className:"text-center",render:function(t,a,c){return`
                                <div class="btn-group btn-group-sm">
                                    <a href="${route("slider-item.index",{slider:t})}" class="btn btn-outline-primary items-btn" title="View Items">
                                        <i class="bi bi-collection"></i>
                                    </a>
                                    <button type="button" class="btn btn-outline-secondary edit-btn" data-id="${t}" title="Edit">
                                        <i class="bi bi-pencil"></i>
                                    </button>
                                    <button type="button" class="btn btn-outline-danger delete-btn" data-id="${t}" title="Delete">
                                        <i class="bi bi-trash"></i>
                                    </button>
                                </div>
                            `}}],language:{emptyTable:"No sliders found",loadingRecords:"Loading sliders...",processing:"Processing...",zeroRecords:"No matching sliders found"},drawCallback:function(t){m(!1),$("#slidesTable").off("click",".edit-btn").on("click",".edit-btn",function(){const a=$(this).data("id");F(a)}),$("#slidesTable").off("click",".delete-btn").on("click",".delete-btn",function(){const a=$(this).data("id");B(a)})},initComplete:function(){m(!1)}});N(o)}catch(o){console.error("DataTable initialization error:",o),r("Failed to initialize table"),m(!1)}},[]),C=d.useCallback(o=>{const{name:t,value:a,type:c,checked:p}=o.target;n(u=>({...u,[t]:c==="checkbox"?p:a}))},[]),A=d.useCallback(()=>{n(V),i(!0)},[]),F=async o=>{try{m(!0);const t=await I.get(route("slider.edit",o));if(t.data.success===!0){const a=t.data.data||t.data.slider;n({...a,is_active:!!a.is_active}),i(!0)}else b.error(t.data.message||"Failed to load slider data")}catch(t){console.error("Error editing slider:",t),b.error("An error occurred while fetching the slider.")}finally{m(!1)}},B=async o=>{var a,c;if((await U.fire({title:"Delete Slider?",text:"This cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{m(!0);const p=await I.delete(route("slider.destroy",o));p.data.success?(b.success(p.data.message),g()):b.error(p.data.message)}catch(p){console.error("Error deleting slider:",p),b.error(((c=(a=p.response)==null?void 0:a.data)==null?void 0:c.message)||"An error occurred while deleting the slider.")}finally{m(!1)}},E=async o=>{var c,p;const t=!!o.id;if((await U.fire({title:t?"Update slider?":"Create slider?",text:t?"Are you sure you want to update this slider?":"Are you sure you want to create a new slider?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:t?"Yes, update it!":"Yes, create it!"})).isConfirmed){l(!0);try{const u=new FormData;Object.entries(o).forEach(([P,h])=>{h!=null&&(typeof h=="boolean"?u.append(P,h?1:0):typeof h=="object"?u.append(P,JSON.stringify(h)):u.append(P,h))}),t&&u.append("_method","PUT");const J=t?route("slider.update",o.id):route("slider.store"),v=await I.post(J,u,{headers:{"Content-Type":"multipart/form-data"}});v.data.success===!0?(b.success(v.data.message),i(!1),g()):b.error(v.data.message)}catch(u){console.error("Error submitting slider:",u),b.error(((p=(c=u==null?void 0:u.response)==null?void 0:c.data)==null?void 0:p.message)||"An error occurred while saving the slider.")}finally{l(!1)}}};return d.useEffect(()=>(x(),()=>{$.fn.DataTable.isDataTable("#slidesTable")&&$("#slidesTable").DataTable().destroy()}),[x]),e.jsxs(Q,{children:[e.jsx(G,{title:"Slides Management"}),e.jsxs(w,{className:"border-0 rounded-0 shadow-sm",children:[e.jsxs(w.Header,{className:"d-flex justify-content-between align-items-center bg-transparent",children:[e.jsx("h6",{className:"mb-0 fw-semibold",children:"Sliders Management"}),e.jsx(Z,{children:e.jsxs(z,{variant:"outline-secondary",size:"sm",className:"rounded-1 d-flex align-items-center",onClick:A,disabled:k,children:[e.jsx(H,{className:"me-1"}),"New Slider"]})})]}),e.jsxs(w.Body,{className:"px-0",children:[s&&e.jsx(ee,{variant:"danger",className:"mx-3",children:s}),e.jsx(te,{bordered:!0,striped:!0,hover:!0,responsive:!0,id:"slidesTable",className:"w-100"})]})]}),e.jsx(ie,{showModal:_,setShowModal:i,formData:S,handleInputChange:C,handleSubmit:E,isSubmitting:j})]})}export{Se as default};
