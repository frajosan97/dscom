import{r as i,j as e,$ as be,b as Ne}from"./app-V9r-X-AE.js";import{y as $,R as C,I as f,N as K}from"./Footer-DzCvt54Q.js";import{E as ye}from"./ErpLayout-nhBgb16w.js";import{x as _e}from"./axios-ieEUQTu7.js";import{E as Ce,G as we,z as Se,A as ke,B as Fe,C as ge}from"./index-B3mf7D57.js";import{C as Le}from"./CustomerModal-BQH17KEB.js";import{C as p}from"./Card-DEhYGpAN.js";import{F as n,C as r}from"./Form-BBQmeiIu.js";import{L as H}from"./ListGroup-CJGgD2bY.js";import{S as U}from"./react-select.esm-0vL-BJCX.js";import{u as je}from"./useData-ByTVg8J8.js";import{P as Te}from"./PaymentMethods-4FW4hRhn.js";import{a as M}from"./helpers-3eqO9XlR.js";import{A as Ae}from"./Alert-z_uRmixb.js";import{I as Pe,B as J}from"./Image-Dv6K2MWK.js";import{S as O}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{T as R}from"./Tab-DoO3NYS5.js";import"./CloseButton-CxHVE5YY.js";/* empty css                      */import"./iconBase-DG-LLbDw.js";import"./index.esm-DxGMX1Iw.js";import"./hoist-non-react-statics.cjs-C-Qo8PK8.js";import"./useErrorToast-BDwh9umO.js";import"./Modal-qrCrV0uy.js";import"./Spinner-B1mIUH-A.js";import"./Tabs-DyUmX2jV.js";import"./Table-DzA7Bq8n.js";const Ge=({customerData:s,setCustomerData:g})=>{const[c,y]=i.useState("customer"),[h,b]=i.useState(!1),[d,l]=i.useState(s==null?void 0:s.customer_name),[u,_]=i.useState([]),[k,j]=i.useState(!1),[a,N]=i.useState(!1),t=i.useRef(null),x=i.useRef(null),m=i.useMemo(()=>["customer","dealer"].map(o=>({value:o,label:o.charAt(0).toUpperCase()+o.slice(1)})),[]),T=i.useCallback(async o=>{var L,B;if(o.length<2){j(!1),_([]);return}N(!0);try{const{data:G}=await _e.get(route("api.customer.search"),{params:{value:o}});G.success?(_(G.customers||[]),j(!0)):($.error(G.message),j(!1))}catch(G){$.error(((B=(L=G.response)==null?void 0:L.data)==null?void 0:B.message)||"An error occurred"),j(!1)}finally{N(!1)}},[]),F=i.useCallback(o=>{const L=o.target.value;l(L),t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{T(L)},500)},[T]),z=i.useCallback(o=>{g({customer_id:o.id,customer_name:o.full_name,customer_phone:o.phone,customer_email:o.email,customer_address:o.address,customer_city:o.city,customer_country:o.country}),l(o.full_name),j(!1)},[g]),q=i.useCallback(()=>{b(!0),j(!1)},[]);return i.useEffect(()=>{const o=L=>{x.current&&!x.current.contains(L.target)&&j(!1)};return document.addEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)}},[]),i.useEffect(()=>()=>{t.current&&clearTimeout(t.current)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(p,{className:"border-0 rounded-0 shadow-sm mb-3",children:[e.jsxs(p.Header,{className:"bg-transparent d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"mb-0 fw-semibold text-capitalize",children:[c," Information"]}),e.jsx("div",{className:"d-flex gap-3",children:m.map(({value:o,label:L})=>e.jsx(n.Check,{inline:!0,type:"radio",id:`is${o}`,label:L,name:"customerType",value:o,checked:c===o,onChange:B=>y(B.target.value),className:"fw-medium"},o))})]}),e.jsx(p.Body,{className:"p-4",children:e.jsxs(C,{children:[e.jsx(r,{md:12,className:"mb-3",ref:x,children:e.jsxs(f,{children:[e.jsx(f.Text,{className:"rounded-0",children:e.jsx(Ce,{})}),e.jsx(n.Control,{type:"search",placeholder:"Search customer by name, phone, or email...",className:"rounded-0",value:d,onChange:F,onFocus:()=>d.length>1&&j(!0)}),e.jsx(f.Text,{className:"rounded-0 cursor-pointer",onClick:q,children:e.jsx(we,{})}),k&&e.jsx(H,{className:"position-absolute rounded-0 w-100",style:{zIndex:1050,top:"100%"},children:a?e.jsx(H.Item,{className:"rounded-0 text-center",children:"Searching..."}):u.length>0?u.map(o=>e.jsxs(H.Item,{action:!0,onClick:()=>z(o),className:"rounded-0",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("span",{className:"fw-medium",children:o.full_name||o.name}),e.jsx("small",{className:"text-muted",children:o.phone})]}),o.email&&e.jsx("div",{className:"small text-muted text-truncate",children:o.email})]},o.id)):e.jsx(H.Item,{className:"rounded-0 text-center text-muted",children:"No customers found"})})]})}),e.jsx(r,{md:4,className:"mb-3",children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{children:"Customer Name"}),e.jsx(n.Control,{type:"text",value:s.customer_name||"",readOnly:!0,className:"bg-light"})]})}),e.jsx(r,{md:4,className:"mb-3",children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{children:"Phone"}),e.jsx(n.Control,{type:"text",value:s.customer_phone||"",readOnly:!0,className:"bg-light"})]})}),e.jsx(r,{md:4,className:"mb-3",children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{children:"Email"}),e.jsx(n.Control,{type:"email",value:s.customer_email||"",readOnly:!0,className:"bg-light"})]})}),e.jsxs(r,{md:6,className:"mb-3",children:[e.jsx(n.Label,{className:"fw-medium",children:"Address"}),e.jsx(n.Control,{type:"text",value:s.customer_address||"",placeholder:"Auto-filled address",disabled:!0,className:"bg-light"})]}),e.jsxs(r,{md:3,className:"mb-3",children:[e.jsx(n.Label,{className:"fw-medium",children:"City"}),e.jsx(n.Control,{type:"text",value:s.customer_city||"",placeholder:"Auto-filled city",disabled:!0,className:"bg-light"})]}),e.jsxs(r,{md:3,className:"mb-3",children:[e.jsx(n.Label,{className:"fw-medium",children:"Country"}),e.jsx(n.Control,{type:"text",value:s.customer_country||"",placeholder:"Auto-filled country",disabled:!0,className:"bg-light"})]})]})})]}),e.jsx(Le,{show:h,onHide:()=>b(!1),onClose:()=>b(!1)})]})},Be=({initialCheckData:s,setInitialCheckData:g})=>{const c=["Display","Back Panel","Devices Status","Hello"],y=["Sim Tray","Back Panel","Battery","Sim","Headset","Cover","Tes"],h=(d,l)=>{g(u=>({...u,status:{...u.status,[d]:l}}))},b=d=>{g(l=>{var u;return{...l,accessories:{...l.accessories,[d]:!((u=l.accessories)!=null&&u[d])}}})};return e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"mb-4 g-3",children:c.map((d,l)=>{var u,_,k,j;return e.jsx(r,{md:3,children:e.jsx(p,{className:"border-0 shadow-sm h-100",children:e.jsxs(p.Body,{children:[e.jsx(p.Title,{className:"fs-6 mb-3 text-capitalize",children:d}),e.jsxs("div",{className:"d-flex flex-column gap-1",children:[e.jsx(n.Check,{type:"radio",label:"Working",name:`status-${l}`,checked:((u=s==null?void 0:s.status)==null?void 0:u[d])==="Working",onChange:()=>h(d,"Working")}),e.jsx(n.Check,{type:"radio",label:"Not Working",name:`status-${l}`,checked:((_=s==null?void 0:s.status)==null?void 0:_[d])==="Not Working",onChange:()=>h(d,"Not Working")}),e.jsx(n.Check,{type:"radio",label:"Not Checked",name:`status-${l}`,checked:!((k=s==null?void 0:s.status)!=null&&k[d])||((j=s==null?void 0:s.status)==null?void 0:j[d])==="Not Checked",onChange:()=>h(d,"Not Checked")})]})]})})},l)})}),e.jsxs(C,{className:"mb-4 g-3",children:[e.jsx(r,{md:6,children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{children:"Physical Condition"}),e.jsx(U,{placeholder:"Search Physical Conditions",value:s!=null&&s.physicalCondition?{label:s.physicalCondition,value:s.physicalCondition}:null,onChange:d=>g(l=>({...l,physicalCondition:(d==null?void 0:d.value)||""})),options:[{value:"Good",label:"Good"},{value:"Average",label:"Average"},{value:"Poor",label:"Poor"}]})]})}),e.jsx(r,{md:6,children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{children:"Risk Agreed By Customer"}),e.jsx(U,{placeholder:"Search Risk Agreements",value:s!=null&&s.riskAgreement?{label:s.riskAgreement,value:s.riskAgreement}:null,onChange:d=>g(l=>({...l,riskAgreement:(d==null?void 0:d.value)||""})),options:[{value:"Screen Replacement",label:"Screen Replacement"},{value:"Data Loss",label:"Data Loss"},{value:"Other",label:"Other"}]})]})})]}),e.jsxs(p,{className:"border-0 shadow-sm",children:[e.jsxs(p.Header,{className:"bg-white fw-bold",children:["Accessories",e.jsx("div",{className:"fw-normal small",children:"Subtitle"})]}),e.jsx(p.Body,{children:e.jsxs(C,{className:"g-3",children:[e.jsx(r,{md:8,children:e.jsx(n.Group,{className:"d-flex flex-wrap gap-3",children:y.map((d,l)=>{var u;return e.jsx(n.Check,{type:"checkbox",id:`acc-${l}`,label:d,checked:!!((u=s==null?void 0:s.accessories)!=null&&u[d]),onChange:()=>b(d)},l)})})}),e.jsx(r,{md:4,children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{children:"Other Remarks"}),e.jsx(n.Control,{as:"textarea",rows:2,placeholder:"Other Remarks",value:(s==null?void 0:s.remarks)||"",onChange:d=>g(l=>({...l,remarks:d.target.value}))})]})})]})})]})]})},Re=({jobDetailsData:s,setJobDetailsData:g,errors:c={}})=>{const{services:y}=je(),h=(l,u)=>{g(_=>({..._,[l]:u}))},b=y==null?void 0:y.map(l=>({value:l.id,label:l.name})),d=i.useMemo(()=>s!=null&&s.repair_service_id&&b.find(u=>u.value===s.repair_service_id)||null,[s==null?void 0:s.repair_service_id,b]);return e.jsxs(e.Fragment,{children:[e.jsxs(p,{className:"border-0 rounded-0 shadow-sm mb-3",children:[e.jsx(p.Header,{className:"bg-transparent fw-semibold",children:"Job Information"}),e.jsx(p.Body,{children:e.jsxs(C,{className:"g-3",children:[e.jsx(r,{md:4,children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{htmlFor:"orderNumber",children:"Job Number"}),e.jsx(n.Control,{id:"orderNumber",type:"text",value:(s==null?void 0:s.order_number)||"",placeholder:"Auto-generated",disabled:!0,className:"bg-light"})]})}),e.jsx(r,{md:4,children:e.jsxs(n.Group,{children:[e.jsxs(n.Label,{htmlFor:"entryDate",children:["Entry Date"," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(n.Control,{id:"entryDate",type:"date",value:(s==null?void 0:s.entry_date)||"",onChange:l=>h("entry_date",l.target.value),isInvalid:!!c.entry_date,required:!0}),e.jsx(n.Control.Feedback,{type:"invalid",children:c.entry_date})]})}),e.jsx(r,{md:4,children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{children:"Warranty Status"}),e.jsx("div",{children:[{value:"out",label:"Out Warranty"},{value:"on",label:"On Warranty"}].map(l=>e.jsx(n.Check,{inline:!0,type:"radio",id:`warranty-${l.value}`,label:l.label,name:"warranty",value:l.value,checked:(s==null?void 0:s.warranty)===l.value,onChange:u=>h("warranty",u.target.value),className:"fw-medium"},l.value))}),c.warranty&&e.jsx("div",{className:"invalid-feedback d-block",children:c.warranty})]})})]})})]}),e.jsxs(C,{children:[e.jsx(r,{md:6,children:e.jsxs(p,{className:"border-0 rounded-0 shadow-sm mb-3",children:[e.jsx(p.Header,{className:"bg-transparent fw-semibold",children:"Device Information"}),e.jsx(p.Body,{children:e.jsxs(C,{className:"g-3",children:[e.jsx(r,{md:6,children:e.jsxs(n.Group,{children:[e.jsxs(n.Label,{htmlFor:"company",children:["Company"," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(n.Control,{id:"company",value:(s==null?void 0:s.company)||"",onChange:l=>h("company",l.target.value),placeholder:"Search Company",isInvalid:!!c.company,required:!0}),e.jsx(n.Control.Feedback,{type:"invalid",children:c.company})]})}),e.jsx(r,{md:6,children:e.jsxs(n.Group,{children:[e.jsxs(n.Label,{htmlFor:"brand",children:["brand"," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(n.Control,{id:"brand",value:(s==null?void 0:s.brand)||"",onChange:l=>h("brand",l.target.value),placeholder:"Select brand",isInvalid:!!c.brand,required:!0}),e.jsx(n.Control.Feedback,{type:"invalid",children:c.brand})]})}),e.jsx(r,{md:6,children:e.jsxs(n.Group,{children:[e.jsxs(n.Label,{htmlFor:"model",children:["Model"," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(n.Control,{id:"model",value:(s==null?void 0:s.model)||"",onChange:l=>h("model",l.target.value),placeholder:"Select Model",isInvalid:!!c.model,required:!0}),e.jsx(n.Control.Feedback,{type:"invalid",children:c.model})]})}),e.jsx(r,{md:6,children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{htmlFor:"color",children:"Color"}),e.jsx(n.Control,{id:"color",value:(s==null?void 0:s.color)||"",onChange:l=>h("color",l.target.value),placeholder:"Device Color"})]})}),e.jsx(r,{md:6,children:e.jsxs(n.Group,{children:[e.jsxs(n.Label,{htmlFor:"imeiSerial",children:["IMEI/Serial"," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(n.Control,{id:"imeiSerial",value:(s==null?void 0:s.serial)||"",onChange:l=>h("serial",l.target.value),placeholder:"IMEI / Serial",isInvalid:!!c.serial,required:!0}),e.jsx(n.Control.Feedback,{type:"invalid",children:c.serial})]})}),e.jsx(r,{md:6,children:e.jsxs(n.Group,{children:[e.jsxs(n.Label,{htmlFor:"devicePassword",children:["Device Password"," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(n.Control,{id:"devicePassword",type:"text",value:(s==null?void 0:s.password)||"",onChange:l=>h("password",l.target.value),placeholder:"Device Password",isInvalid:!!c.password,required:!0}),e.jsx(n.Control.Feedback,{type:"invalid",children:c.password})]})}),e.jsx(r,{md:6,children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{htmlFor:"providerInfo",children:"Provider Information"}),e.jsx(n.Control,{id:"providerInfo",as:"textarea",rows:1,value:(s==null?void 0:s.provider)||"",onChange:l=>h("provider",l.target.value),placeholder:"Provider Information"})]})}),e.jsx(r,{md:6,children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{htmlFor:"specsInfo",children:"Device Specifications"}),e.jsx(n.Control,{id:"specsInfo",as:"textarea",rows:1,value:(s==null?void 0:s.specs)||"",onChange:l=>h("specs",l.target.value),placeholder:"Device Specifications"})]})}),e.jsx(r,{md:12,children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{htmlFor:"issueDescription",children:"Issue Identified"}),e.jsx(n.Control,{id:"issueDescription",as:"textarea",rows:1,value:(s==null?void 0:s.issue)||"",onChange:l=>h("issue",l.target.value),placeholder:"Issue Identified"})]})})]})})]})}),e.jsx(r,{md:6,children:e.jsxs(p,{className:"border-0 rounded-0 shadow-sm mb-3",children:[e.jsx(p.Header,{className:"bg-transparent fw-semibold",children:"Complaint Details"}),e.jsx(p.Body,{children:e.jsxs(C,{className:"g-3",children:[e.jsx(r,{md:12,className:"mb-3",children:e.jsxs(n.Group,{children:[e.jsxs(n.Label,{htmlFor:"complaint",children:["Service Complaint"," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(U,{inputId:"complaint",options:b,value:d,onChange:l=>h("repair_service_id",(l==null?void 0:l.value)||""),placeholder:"Select complaint",isClearable:!0,styles:{control:l=>({...l,borderColor:c.repair_service_id?"#dc3545":l.borderColor,"&:hover":{borderColor:c.repair_service_id?"#dc3545":l.borderColor}})}}),c.repair_service_id&&e.jsx("div",{className:"invalid-feedback d-block",children:c.repair_service_id})]})}),e.jsx(r,{md:12,children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{htmlFor:"remarks",children:"Other Remarks"}),e.jsx(n.Control,{id:"remarks",as:"textarea",rows:3,value:(s==null?void 0:s.remarks)||"",onChange:l=>h("remarks",l.target.value),placeholder:"Other Remarks"})]})})]})})]})})]})]})},Oe=({paymentData:s,setPaymentData:g,totalPaid:c})=>{const y=()=>{const a=Number(s==null?void 0:s.diagnosis_fee)||0,N=Number(s==null?void 0:s.estimated_cost)||0,t=Number(s==null?void 0:s.final_cost)||0;return a+N+t},h=i.useMemo(y,[s==null?void 0:s.diagnosis_fee,s==null?void 0:s.estimated_cost,s==null?void 0:s.final_cost]),b=a=>Array.isArray(a)?a:a!=null&&a.transactions&&Array.isArray(a.transactions)?a.transactions:[],d=i.useMemo(()=>Object.entries(s).filter(([,a])=>Array.isArray(a)||Array.isArray(a==null?void 0:a.transactions)).map(([a,N])=>{const x=b(N).reduce((m,T)=>m+(Number(T.amount)||0),0);return{method:a,total:x}}),[s]),l=i.useMemo(()=>d.reduce((a,N)=>a+N.total,0),[d]),u=typeof c=="number"?c:l,_=Math.max(h-u,0),k=Math.max(u-h,0),j=(a,N)=>{g(t=>({...t,[a]:N}))};return e.jsxs(e.Fragment,{children:[e.jsxs(p,{className:"border-0 shadow-sm mb-3",children:[e.jsx(p.Header,{className:"bg-white fw-bold",children:"Payment Info"}),e.jsx(p.Body,{children:e.jsxs(C,{className:"g-3",children:[e.jsx(r,{md:4,children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{children:"Diagnosis Fees"}),e.jsxs(f,{children:[e.jsx(f.Text,{children:"$"}),e.jsx(n.Control,{type:"number",placeholder:"Diagnosis Fees",value:(s==null?void 0:s.diagnosis_fee)||"",onChange:a=>j("diagnosis_fee",a.target.value)})]})]})}),e.jsx(r,{md:4,children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{children:"Estimate Fees"}),e.jsxs(f,{children:[e.jsx(f.Text,{children:"$"}),e.jsx(n.Control,{type:"number",placeholder:"Estimate Fees",value:(s==null?void 0:s.estimated_cost)||"",onChange:a=>j("estimated_cost",a.target.value)})]})]})}),e.jsx(r,{md:4,children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{children:"Final Cost"}),e.jsxs(f,{children:[e.jsx(f.Text,{children:"$"}),e.jsx(n.Control,{type:"number",placeholder:"Final Cost",value:(s==null?void 0:s.final_cost)||"",onChange:a=>j("final_cost",a.target.value)})]})]})})]})})]}),e.jsxs(C,{className:"g-3",children:[e.jsx(r,{md:8,children:e.jsx(Te,{paymentData:s,setPaymentData:g})}),e.jsx(r,{md:4,children:e.jsxs(p,{className:"border-0 shadow-sm h-100",children:[e.jsx(p.Header,{className:"bg-white fw-bold",children:"Summary"}),e.jsxs(p.Body,{children:[e.jsx("div",{className:"mb-3",children:e.jsxs(f,{children:[e.jsxs(f.Text,{className:"fw-bold bg-light",style:{width:"160px"},children:[e.jsx(Se,{className:"me-1"}),"Total Billed"]}),e.jsx(n.Control,{value:M(h),className:"text-end fw-bold bg-light",disabled:!0})]})}),e.jsx(C,{className:"g-2 mb-3",children:d.map(({method:a,total:N})=>e.jsx(r,{md:12,children:e.jsxs(f,{children:[e.jsxs(f.Text,{className:"fw-bold bg-light text-capitalize",style:{width:"160px"},children:[e.jsx(ke,{className:"me-1"}),a]}),e.jsx(n.Control,{value:M(N),className:"text-end fw-bold bg-light",disabled:!0})]})},a))}),e.jsx("hr",{}),e.jsx("div",{className:"mb-2",children:e.jsxs(f,{children:[e.jsxs(f.Text,{className:"fw-bold bg-light",style:{width:"160px"},children:[e.jsx(Fe,{className:"me-1"}),"Total Paid"]}),e.jsx(n.Control,{value:M(u),className:"text-end fw-bold bg-light",disabled:!0})]})}),e.jsx("div",{className:"mb-2",children:e.jsxs(f,{children:[e.jsxs(f.Text,{className:`fw-bold ${_>0?"text-warning":"text-success"} bg-light`,style:{width:"160px"},children:[e.jsx(ge,{className:"me-1"}),"Balance Due"]}),e.jsx(n.Control,{value:M(_),className:`text-end fw-bold ${_>0?"text-warning":"text-success"}`,disabled:!0})]})}),k>0&&e.jsx("div",{className:"mb-2",children:e.jsxs(f,{children:[e.jsxs(f.Text,{className:"fw-bold text-info bg-light",style:{width:"160px"},children:[e.jsx(ge,{className:"me-1"}),"Change"]}),e.jsx(n.Control,{value:M(k),className:"text-end fw-bold text-info",disabled:!0})]})})]})]})})]})]})},Ee=({otherInfoData:s,setOtherInfoData:g})=>{var j,a,N;const c=i.useRef(null),[y,h]=i.useState(""),b=["image/jpeg","image/png","image/gif","image/webp","image/svg+xml","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain"],d=10*1024*1024,l=(t,x)=>{g(m=>({...m,[t]:x}))},u=t=>{const x=Array.from(t.target.files);h("");const m=[],T=[];x.forEach(F=>{b.includes(F.type)?F.size>d?T.push(`${F.name} (too large)`):m.push(F):T.push(F.name)}),T.length>0&&h(`The following files were not accepted: ${T.join(", ")}. 
                Please upload only images or documents under 10MB.`),m.length>0&&g(F=>({...F,attachments:[...F.attachments,...m]})),c.current&&(c.current.value="")},_=t=>{g(x=>{const m=[...x.attachments];return m.splice(t,1),{...x,attachments:m}})},k=t=>t.type.startsWith("image/");return e.jsxs(p,{className:"border-0 shadow-sm mb-3",children:[e.jsx(p.Header,{className:"bg-white fw-bold",children:"Other Information"}),e.jsxs(p.Body,{children:[y&&e.jsx(Ae,{variant:"danger",children:y}),e.jsxs(C,{className:"g-3 mb-3",children:[e.jsx(r,{md:6,children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{children:"Completion Date"}),e.jsx(n.Control,{type:"date",value:(s==null?void 0:s.completion_date)||"",onChange:t=>l("completion_date",t.target.value)})]})}),e.jsx(r,{md:6,children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{children:"Attachments (Photos, Documents, etc.)"}),e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(n.Control,{ref:c,type:"file",className:"d-none",id:"attachments",multiple:!0,accept:b.join(","),onChange:u}),e.jsx(n.Label,{htmlFor:"attachments",className:"btn btn-outline-secondary me-2 mb-0",children:"Choose Files"}),e.jsx("span",{className:"text-muted",children:s.attachments.length===0?"No files chosen":`${s.attachments.length} file(s) selected`})]}),s.attachments.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{children:"Selected Files:"}),e.jsx("div",{className:"d-flex flex-wrap gap-3",children:s.attachments.map((t,x)=>e.jsxs("div",{className:"border rounded p-2 position-relative",style:{width:"120px"},children:[k(t)?e.jsx(Pe,{src:URL.createObjectURL(t),alt:t.name,thumbnail:!0,style:{width:"100px",height:"100px",objectFit:"cover"}}):e.jsx("div",{className:"d-flex align-items-center justify-content-center bg-light",style:{width:"100px",height:"100px"},children:e.jsx("i",{className:"fas fa-file text-secondary fs-1"})}),e.jsx("div",{className:"mt-1 text-truncate small",title:t.name,children:t.name}),e.jsx(J,{variant:"danger",size:"sm",className:"position-absolute top-0 end-0 p-0",style:{width:"20px",height:"20px",fontSize:"10px"},onClick:()=>_(x),children:"Ã—"})]},x))})]})]})})]}),e.jsx(C,{className:"g-3 mb-3",children:e.jsx(r,{md:12,children:e.jsxs(n.Group,{children:[e.jsx(n.Label,{children:"Customer Signature"}),e.jsx("div",{style:{height:"100px",border:"1px dashed #ccc",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",color:"#6c757d"},children:(s==null?void 0:s.signature)||"Signature Area"})]})})}),e.jsx(C,{className:"mb-3",children:e.jsx(r,{children:e.jsxs("div",{className:"d-flex flex-wrap gap-3",children:[e.jsx(n.Check,{type:"checkbox",id:"sendSms",label:"Send SMS",checked:((j=s==null?void 0:s.notification_channel)==null?void 0:j.includes("sms"))||!1,onChange:t=>{const x=s.notification_channel||[];t.target.checked?l("notification_channel",[...x,"sms"]):l("notification_channel",x.filter(m=>m!=="sms"))}}),e.jsx(n.Check,{type:"checkbox",id:"sendWhatsApp",label:"Send WhatsApp",checked:((a=s==null?void 0:s.notification_channel)==null?void 0:a.includes("whatsapp"))||!1,onChange:t=>{const x=s.notification_channel||[];t.target.checked?l("notification_channel",[...x,"whatsapp"]):l("notification_channel",x.filter(m=>m!=="whatsapp"))}}),e.jsx(n.Check,{type:"checkbox",id:"sendEmail",label:"Send Email",checked:((N=s==null?void 0:s.notification_channel)==null?void 0:N.includes("email"))||!1,onChange:t=>{const x=s.notification_channel||[];t.target.checked?l("notification_channel",[...x,"email"]):l("notification_channel",x.filter(m=>m!=="email"))}})]})})})]})]})},is=({service:s=null})=>{var L,B,G,V,Y,Q,X,Z,v,D,ee,se,ne,le,de,re,te,ae,oe,ce,ie,me,he,ue;const[g,c]=i.useState("customer");console.log(s);const{paymentMethods:y}=je(),[h,b]=i.useState({}),d=()=>{const A=new Date().toISOString().slice(0,10).replace(/-/g,""),P=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return`JOB-${A}-${P}`},l=()=>new Date().toISOString().split("T")[0],[u,_]=i.useState({customer_id:((L=s==null?void 0:s.customer)==null?void 0:L.id)||"",customer_name:((B=s==null?void 0:s.customer)==null?void 0:B.full_name)||"",customer_phone:((G=s==null?void 0:s.customer)==null?void 0:G.phone)||"",customer_email:((V=s==null?void 0:s.customer)==null?void 0:V.email)||""}),[k,j]=i.useState({order_number:(s==null?void 0:s.order_number)||d(),entry_date:(s==null?void 0:s.entry_date)||l(),company:((Y=s==null?void 0:s.device_metadata)==null?void 0:Y.company)||"",brand:((Q=s==null?void 0:s.device_metadata)==null?void 0:Q.brand)||"",model:((X=s==null?void 0:s.device_metadata)==null?void 0:X.model)||"",serial:((Z=s==null?void 0:s.device_metadata)==null?void 0:Z.serial)||"",specs:((v=s==null?void 0:s.device_metadata)==null?void 0:v.specs)||"",password:((D=s==null?void 0:s.device_metadata)==null?void 0:D.password)||"",color:((ee=s==null?void 0:s.device_metadata)==null?void 0:ee.color)||"",issue:((se=s==null?void 0:s.device_metadata)==null?void 0:se.issue)||"",remarks:((ne=s==null?void 0:s.device_metadata)==null?void 0:ne.remarks)||"",provider:((le=s==null?void 0:s.device_metadata)==null?void 0:le.provider)||"",warranty:((de=s==null?void 0:s.device_metadata)==null?void 0:de.warranty)||"out",priority:(s==null?void 0:s.priority)||"medium",status:(s==null?void 0:s.status)||"pending",expected_completion_date:(s==null?void 0:s.expected_completion_date)||"",repair_service_id:(s==null?void 0:s.repair_service_id)||""}),[a,N]=i.useState({display:((re=s==null?void 0:s.initial_check_metadata)==null?void 0:re.display)||"",back_panel:((te=s==null?void 0:s.initial_check_metadata)==null?void 0:te.back_panel)||"",status:((ae=s==null?void 0:s.initial_check_metadata)==null?void 0:ae.status)||"",physical_condition:((oe=s==null?void 0:s.initial_check_metadata)==null?void 0:oe.physical_condition)||"",risk_agreed:((ce=s==null?void 0:s.initial_check_metadata)==null?void 0:ce.risk_agreed)||"",accessories:((ie=s==null?void 0:s.initial_check_metadata)==null?void 0:ie.accessories)||[],remarks:((me=s==null?void 0:s.initial_check_metadata)==null?void 0:me.remarks)||"",checked_by:((he=s==null?void 0:s.initial_check_metadata)==null?void 0:he.checked_by)||"",check_date:((ue=s==null?void 0:s.initial_check_metadata)==null?void 0:ue.check_date)||""}),[t,x]=i.useState({estimated_cost:(s==null?void 0:s.estimated_cost)||0,diagnosis_fee:(s==null?void 0:s.diagnosis_fee)||0,final_cost:(s==null?void 0:s.final_cost)||0,tax_amount:(s==null?void 0:s.tax_amount)||0,discount_amount:(s==null?void 0:s.discount_amount)||0,total_amount:(s==null?void 0:s.total_amount)||0,completion_date:(s==null?void 0:s.completion_date)||"",signature:(s==null?void 0:s.signature)||"",notification_channel:(s==null?void 0:s.notification_channel)||[],attachments:(s==null?void 0:s.attachments)||[]});i.useEffect(()=>{if(s){const w=y.reduce((A,P)=>{var S;const I=((S=s==null?void 0:s.payments)==null?void 0:S.filter(E=>{var W;return((W=E.payment_method_name)==null?void 0:W.toLowerCase())===P.name.toLowerCase()}))||[];return A[P.name.toLowerCase()]=I.map(E=>E.metadata),A},{});b(w)}},[s,y]);const m=i.useMemo(()=>[{key:"customer",label:"Customer Info",icon:"bi-person"},{key:"details",label:"Job Details",icon:"bi-clipboard"},{key:"initial-check",label:"Initial Check",icon:"bi-check-circle"},{key:"payment-info",label:"Payment Info",icon:"bi-credit-card"},{key:"other-info",label:"Other Info",icon:"bi-info-circle"}],[]),T=i.useCallback(()=>{const w=m.findIndex(A=>A.key===g);w<m.length-1&&c(m[w+1].key)},[g,m]),F=i.useCallback(()=>{const w=m.findIndex(A=>A.key===g);w>0&&c(m[w-1].key)},[g,m]),z=g===m[0].key,q=g===m[m.length-1].key,o=async w=>{var P,I;if(w.preventDefault(),!!(await O.fire({title:"Confirm Submission",text:s?"Update this service entry?":"Create new service entry?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:s?"Yes, update it!":"Yes, create it!"})).isConfirmed){O.fire({title:"Please wait...",allowOutsideClick:!1,showConfirmButton:!1,didOpen:()=>{O.showLoading()}});try{const S=new FormData;S.append("customer",JSON.stringify(u)),S.append("job_details",JSON.stringify(k)),S.append("initial_check",JSON.stringify(a)),S.append("payment_info",JSON.stringify(h)),S.append("other_info",JSON.stringify(t)),t.attachments&&t.attachments.length>0&&t.attachments.forEach((pe,fe)=>{pe instanceof File&&S.append(`attachments[${fe}]`,pe)});const E=s?route("repair-orders.update",s==null?void 0:s.id):route("repair-orders.store"),W=s?"put":"post",{data:xe}=await Ne[W](E,S,{headers:{"Content-Type":"multipart/form-data"}});xe.success?(O.close(),$.success(xe.message)):(O.close(),$.error("Something went wrong!"))}catch(S){O.close(),console.log(S),$.error(((I=(P=S.response)==null?void 0:P.data)==null?void 0:I.message)||"Request failed")}}};return e.jsxs(ye,{children:[e.jsx(be,{title:s?"Edit Service":"Create Service"}),e.jsx(n,{onSubmit:o,children:e.jsx(R.Container,{activeKey:g,onSelect:c,children:e.jsxs(C,{children:[e.jsx(r,{sm:3,md:2,className:"border-end bg-light",children:e.jsx(K,{variant:"pills",className:"flex-column",children:m.map(({key:w,label:A,icon:P})=>e.jsx(K.Item,{children:e.jsxs(K.Link,{eventKey:w,className:"d-flex align-items-center",children:[e.jsx("i",{className:`${P} me-2`}),e.jsx("span",{className:"d-none d-md-inline",children:A})]})},w))})}),e.jsxs(r,{sm:9,md:10,children:[e.jsxs(R.Content,{children:[e.jsx(R.Pane,{eventKey:"customer",children:e.jsx(Ge,{customerData:u,setCustomerData:_})}),e.jsx(R.Pane,{eventKey:"details",children:e.jsx(Re,{jobDetailsData:k,setJobDetailsData:j})}),e.jsx(R.Pane,{eventKey:"initial-check",children:e.jsx(Be,{initialCheckData:a,setInitialCheckData:N})}),e.jsx(R.Pane,{eventKey:"payment-info",children:e.jsx(Oe,{paymentData:h,setPaymentData:b,otherInfoData:t,setOtherInfoData:x})}),e.jsx(R.Pane,{eventKey:"other-info",children:e.jsx(Ee,{otherInfoData:t,setOtherInfoData:x})})]}),e.jsxs("div",{className:"d-flex justify-content-between mt-4 pt-3 border-top",children:[e.jsxs(J,{variant:"outline-secondary",onClick:F,disabled:z,className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-chevron-left me-1"}),"Previous"]}),q?e.jsxs(J,{type:"submit",variant:"primary",className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-check-circle me-1"}),s?"Update":"Submit"]}):e.jsxs(J,{variant:"primary",onClick:T,className:"d-flex align-items-center",children:["Next",e.jsx("i",{className:"bi bi-chevron-right ms-1"})]})]})]})]})})})]})};export{is as default};
